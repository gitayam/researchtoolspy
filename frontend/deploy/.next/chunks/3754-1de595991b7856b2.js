"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3754],{26126:(e,t,a)=>{a.d(t,{E:()=>n});var o=a(95155),r=a(12115),s=a(59434);let n=r.forwardRef((e,t)=>{let{className:a,variant:r="default",...n}=e;return(0,o.jsx)("div",{ref:t,className:(0,s.cn)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{"border-transparent bg-primary text-primary-foreground hover:bg-primary/80":"default"===r,"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80":"secondary"===r,"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80":"destructive"===r,"text-foreground":"outline"===r},a),...n})});n.displayName="Badge"},30285:(e,t,a)=>{a.d(t,{$:()=>d});var o=a(95155),r=a(12115),s=a(99708),n=a(74466),i=a(59434);let l=(0,n.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef((e,t)=>{let{className:a,variant:r,size:n,asChild:d=!1,...c}=e,u=d?s.DX:"button";return(0,o.jsx)(u,{className:(0,i.cn)(l({variant:r,size:n,className:a})),ref:t,...c})});d.displayName="Button"},62523:(e,t,a)=>{a.d(t,{p:()=>n});var o=a(95155),r=a(12115),s=a(59434);let n=r.forwardRef((e,t)=>{let{className:a,type:r,...n}=e;return(0,o.jsx)("input",{type:r,className:(0,s.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",a),ref:t,...n})});n.displayName="Input"},66695:(e,t,a)=>{a.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>l,Zp:()=>n,aR:()=>i});var o=a(95155),r=a(12115),s=a(59434);let n=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,o.jsx)("div",{ref:t,className:(0,s.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...r})});n.displayName="Card";let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,o.jsx)("div",{ref:t,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",a),...r})});i.displayName="CardHeader";let l=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,o.jsx)("h3",{ref:t,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",a),...r})});l.displayName="CardTitle";let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,o.jsx)("p",{ref:t,className:(0,s.cn)("text-sm text-muted-foreground",a),...r})});d.displayName="CardDescription";let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,o.jsx)("div",{ref:t,className:(0,s.cn)("p-6 pt-0",a),...r})});c.displayName="CardContent",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,o.jsx)("div",{ref:t,className:(0,s.cn)("flex items-center p-6 pt-0",a),...r})}).displayName="CardFooter"},95657:(e,t,a)=>{a.d(t,{q:()=>i});var o=a(5174),r=a(25731);a(12115);let s={ANONYMOUS_PREFIX:"omnicore_framework_",MIGRATION_DATA:"omnicore_migration_pending"};class n{debounce(e,t){let a;var o=this;return function(){for(var r=arguments.length,s=Array(r),n=0;n<r;n++)s[n]=arguments[n];clearTimeout(a),a=setTimeout(()=>e.apply(o,s),t)}}async performAutoSave(e,t){try{this.updateSaveStatus(e,{status:"saving"});let{isAuthenticated:a}=o.nc.getState();a&&this.options.enableBackend?await this.saveToBackend(e,t):this.options.enableLocalStorage&&await this.saveToLocalStorage(e,t),this.updateSaveStatus(e,{status:"saved",lastSaved:new Date})}catch(a){if(console.error("Auto-save failed:",a),this.updateSaveStatus(e,{status:"error",error:a instanceof Error?a.message:"Save failed"}),this.options.enableLocalStorage)try{await this.saveToLocalStorage(e,t),this.updateSaveStatus(e,{status:"saved",lastSaved:new Date})}catch(e){console.error("Fallback to localStorage also failed:",e)}}}async saveToBackend(e,t){let a=this.getBackendEndpoint(t.frameworkType);if("new"===e||t.isAnonymous){let o=await r.u.post(a,{title:t.title,framework_type:t.frameworkType,data:t.data});if(o.id||o.session_id){let t=o.id||o.session_id;this.migrateSessionId(e,String(t))}}else await r.u.put("".concat(a,"/").concat(e),{title:t.title,data:t.data})}async saveToLocalStorage(e,t){try{let a="".concat(s.ANONYMOUS_PREFIX).concat(t.frameworkType,"_").concat(e),o=JSON.stringify({...t,lastModified:new Date().toISOString(),isAnonymous:!0});localStorage.setItem(a,o),this.updateLocalStorageIndex(t.frameworkType,e,t.title)}catch(a){if(a instanceof Error&&"QuotaExceededError"===a.name)await this.cleanupOldLocalStorage(),localStorage.setItem("".concat(s.ANONYMOUS_PREFIX).concat(t.frameworkType,"_").concat(e),JSON.stringify(t));else throw a}}async loadSession(e,t){let{isAuthenticated:a}=o.nc.getState();if(!a||"new"===t)return this.loadFromLocalStorage(e,t);try{let a=this.getBackendEndpoint(e),o=await r.u.get("".concat(a,"/").concat(t));return{id:t,frameworkType:e,title:o.title,data:o.data,lastModified:new Date(o.updated_at||o.lastModified),version:o.version||1,isAnonymous:!1}}catch(e){return console.error("Failed to load from backend:",e),null}}loadFromLocalStorage(e,t){try{let a="".concat(s.ANONYMOUS_PREFIX).concat(e,"_").concat(t),o=localStorage.getItem(a);if(!o)return null;let r=JSON.parse(o);return{...r,lastModified:new Date(r.lastModified)}}catch(e){return console.error("Failed to load from localStorage:",e),null}}getAnonymousSessions(e){let t=[],a="".concat(s.ANONYMOUS_PREFIX).concat(e,"_");for(let e=0;e<localStorage.length;e++){let o=localStorage.key(e);if(null==o?void 0:o.startsWith(a))try{let e=localStorage.getItem(o);if(e){let a=JSON.parse(e);t.push({...a,lastModified:new Date(a.lastModified)})}}catch(e){console.error("Failed to parse localStorage data:",e)}}return t.sort((e,t)=>t.lastModified.getTime()-e.lastModified.getTime())}async migrateAnonymousData(){let{isAuthenticated:e}=o.nc.getState();if(!e)throw Error("User must be authenticated to migrate data");for(let e of this.getAllAnonymousSessions())try{e.isAnonymous=!1,await this.saveToBackend("new",e);let t="".concat(s.ANONYMOUS_PREFIX).concat(e.frameworkType,"_").concat(e.id);localStorage.removeItem(t)}catch(t){console.error("Failed to migrate session:",e.id,t)}this.cleanupLocalStorageIndex()}preserveWorkForAuthentication(){let e=this.getAllAnonymousSessions();e.length>0&&sessionStorage.setItem(s.MIGRATION_DATA,JSON.stringify(e))}async restoreWorkAfterAuthentication(){let e=sessionStorage.getItem(s.MIGRATION_DATA);if(e)try{for(let t of JSON.parse(e))t.isAnonymous=!1,await this.saveToBackend("new",t);sessionStorage.removeItem(s.MIGRATION_DATA),this.clearAllAnonymousData()}catch(e){console.error("Failed to restore work after authentication:",e)}}getSaveStatus(e){return this.saveStatus.get(e)||{status:"idle"}}updateSaveStatus(e,t){let a=this.saveStatus.get(e)||{status:"idle"};this.saveStatus.set(e,{...a,...t})}getBackendEndpoint(e){return({ach:"/frameworks",swot:"/frameworks/swot",cog:"/frameworks/sessions",pest:"/frameworks/sessions",dime:"/frameworks/dime",vrio:"/frameworks/sessions","pmesii-pt":"/frameworks/sessions",starbursting:"/frameworks",behavior:"/frameworks",deception:"/frameworks",dotmlpf:"/frameworks","fundamental-flow":"/frameworks"})[e]||"/frameworks"}generateSessionId(){return"anon_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}migrateSessionId(e,t){let a=this.saveStatus.get(e);a&&(this.saveStatus.set(t,a),this.saveStatus.delete(e))}getAllAnonymousSessions(){let e=[];for(let t=0;t<localStorage.length;t++){let a=localStorage.key(t);if(null==a?void 0:a.startsWith(s.ANONYMOUS_PREFIX))try{let t=localStorage.getItem(a);if(t){let a=JSON.parse(t);e.push({...a,lastModified:new Date(a.lastModified)})}}catch(e){console.error("Failed to parse localStorage data:",e)}}return e}updateLocalStorageIndex(e,t,a){try{let o="".concat(s.ANONYMOUS_PREFIX,"index"),r=localStorage.getItem(o),n=r?JSON.parse(r):{};n[e]||(n[e]=[]);let i=n[e].findIndex(e=>e.id===t),l={id:t,title:a,lastModified:new Date().toISOString()};i>=0?n[e][i]=l:n[e].push(l),localStorage.setItem(o,JSON.stringify(n))}catch(e){console.error("Failed to update localStorage index:",e)}}async cleanupOldLocalStorage(){for(let[e,t]of Object.entries(this.getAllAnonymousSessions().reduce((e,t)=>(e[t.frameworkType]||(e[t.frameworkType]=[]),e[t.frameworkType].push(t),e),{})))for(let a of t.sort((e,t)=>t.lastModified.getTime()-e.lastModified.getTime()).slice(10)){let t="".concat(s.ANONYMOUS_PREFIX).concat(e,"_").concat(a.id);localStorage.removeItem(t)}}clearAllAnonymousData(){let e=[];for(let t=0;t<localStorage.length;t++){let a=localStorage.key(t);(null==a?void 0:a.startsWith(s.ANONYMOUS_PREFIX))&&e.push(a)}e.forEach(e=>localStorage.removeItem(e))}cleanupLocalStorageIndex(){localStorage.removeItem("".concat(s.ANONYMOUS_PREFIX,"index"))}constructor(e={}){this.saveQueue=new Map,this.saveStatus=new Map,this.options={debounceMs:500,maxRetries:3,enableLocalStorage:!0,enableBackend:!0,...e},this.scheduleAutoSave=this.debounce(this.performAutoSave.bind(this),this.options.debounceMs)}}let i=new n}}]);