"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{10177:(e,t,n)=>{n.d(t,{N:()=>H});var i=n(95155),o=n(12115),a=n(64261),l=n(57434),r=n(99890),s=n(91788),c=n(51154),d=n(5196),h=n(85339),g=n(66695),p=n(30285),y=n(26126),u=n(88262),m=n(26575),v=n(26597),f=n(76118),x=n(5976),b=n(25027),E=n(67372),S=n(49509);let C=new E.Ay({apiKey:S.env.NEXT_PUBLIC_OPENAI_API_KEY||"demo-key",dangerouslyAllowBrowser:!0});async function w(e){try{var t,n;let i=function(e){var t;let n=e.analysis||[],i=n[0],o=null==(t=e.hypotheses.find(e=>e.id===(null==i?void 0:i.hypothesisId)))?void 0:t.text,a="TITLE: ".concat(e.title,"\n");return e.description&&(a+="DESCRIPTION: ".concat(e.description,"\n")),a+="SCALE TYPE: ".concat(e.scaleType," (").concat("logarithmic"===e.scaleType?"Fibonacci sequence":"Linear 1-5",")\n"),a+="ANALYSIS DATE: ".concat(e.createdAt.toLocaleDateString(),"\n\n"),a+="HYPOTHESES (".concat(e.hypotheses.length," total):\n"),e.hypotheses.forEach((e,t)=>{let i=n.find(t=>t.hypothesisId===e.id);a+="H".concat(t+1,": ").concat(e.text,"\n"),i&&(a+="   - Weighted Score: ".concat(i.weightedScore.toFixed(2),"\n"),a+="   - Supporting Evidence: ".concat(i.supportingEvidence,"\n"),a+="   - Contradicting Evidence: ".concat(i.contradictingEvidence,"\n"),a+="   - Confidence: ".concat(i.confidenceLevel,"\n"),a+="   - Status: ".concat(i.rejectionThreshold?"REJECTED":"VIABLE","\n")),a+="\n"}),a+="EVIDENCE (".concat(e.evidence.length," total):\n"),e.evidence.forEach((t,n)=>{if(a+="E".concat(n+1,": ").concat(t.text,"\n"),t.confidenceScore){a+="   - SATS Credibility Score: ".concat(t.confidenceScore,"/13\n");let e=t.confidenceScore>=11?"VERY HIGH":t.confidenceScore>=7?"HIGH":t.confidenceScore>=4?"MODERATE":t.confidenceScore>=2?"LOW":"VERY LOW";a+="   - Credibility Level: ".concat(e,"\n")}a+="   - Hypothesis Scores:\n",e.hypotheses.forEach((n,i)=>{var o;let l=null==(o=e.scores.get(t.id))?void 0:o.get(n.id);l&&(a+="     H".concat(i+1,": ").concat(l.score>0?"+":"").concat(l.score,"\n"))}),a+="\n"}),i&&o&&(a+="PRIMARY CONCLUSION:\n",a+="Most Likely Hypothesis: ".concat(o,"\n"),a+="Weighted Score: ".concat(i.weightedScore.toFixed(2),"\n"),a+="Confidence Level: ".concat(i.confidenceLevel,"\n"),a+="Supporting Evidence Count: ".concat(i.supportingEvidence,"\n"),a+="Contradicting Evidence Count: ".concat(i.contradictingEvidence,"\n")),a}(e),o=null==(n=(await C.chat.completions.create({model:"gpt-4o-mini",messages:[{role:"system",content:"You are a senior intelligence analyst with expertise in structured analytic techniques, particularly Analysis of Competing Hypotheses (ACH). You provide objective, professional assessments based on available evidence."},{role:"user",content:"You are a senior intelligence analyst conducting an Analysis of Competing Hypotheses (ACH). Based on the following analysis data, provide a professional assessment for a military commander's briefing.\n\nANALYSIS CONTEXT:\n".concat(i,'\n\nPlease provide a structured response with:\n\n1. EXECUTIVE SUMMARY (single concise paragraph):\n   - Write as if briefing a commander (CDR) following ACH methodology principles\n   - Focus on hypotheses that can be dismissed/ruled out based on evidence\n   - Identify remaining viable hypotheses rather than selecting one "most likely"\n   - Emphasize what we can confidently eliminate vs. what remains plausible\n   - Keep it focused, direct, and tactical - no more than 4-5 sentences\n\n2. KEY FINDINGS (3-5 bullet points):\n   - Most significant insights from the analysis\n   - Critical evidence that drives conclusions\n   - Evidence quality and credibility factors\n\n3. RECOMMENDATIONS (2-4 bullet points):\n   - Specific actionable recommendations based on findings\n   - Areas for additional collection or investigation\n   - Risk mitigation considerations\n\n4. CONFIDENCE ASSESSMENT (1 paragraph):\n   - Overall confidence in the primary hypothesis\n   - Factors affecting confidence (evidence quality, quantity, consistency)\n   - Limitations and uncertainties\n\n5. ALTERNATIVE EXPLANATIONS (2-3 bullet points):\n   - Other plausible hypotheses that remain viable\n   - Why they are less likely but still possible\n\n6. INTELLIGENCE GAPS (2-3 bullet points):\n   - Missing information that would strengthen analysis\n   - Collection priorities for follow-up\n\nFormat your response as JSON with the following structure:\n{\n  "executiveSummary": "...",\n  "keyFindings": ["...", "..."],\n  "recommendations": ["...", "..."],\n  "confidenceAssessment": "...",\n  "alternativeExplanations": ["...", "..."],\n  "gaps": ["...", "..."]\n}\n\nEnsure your analysis is professional, objective, and follows intelligence community standards.')}],temperature:.3,max_tokens:2e3})).choices[0])||null==(t=n.message)?void 0:t.content;if(!o)throw Error("No response from AI service");return JSON.parse(o)}catch(t){return console.error("Error generating AI analysis:",t),function(e){var t;let n=e.analysis||[],i=n[0],o=(null==(t=e.hypotheses.find(e=>e.id===(null==i?void 0:i.hypothesisId)))?void 0:t.text)||"Primary hypothesis";return{executiveSummary:"CDR, ACH analysis of ".concat(e.hypotheses.length," competing hypotheses allows us to dismiss ").concat(n.filter(e=>e.rejectionThreshold).length," scenarios based on contradictory evidence. ").concat(n.filter(e=>!e.rejectionThreshold).length,' hypotheses remain viable, with "').concat(o,'" showing strongest support from available evidence. Key focus should be on continued collection to further eliminate remaining possibilities rather than committing to a single explanation.'),keyFindings:["".concat(n.filter(e=>e.rejectionThreshold).length," hypotheses dismissed due to contradictory evidence"),"".concat(n.filter(e=>!e.rejectionThreshold).length," hypotheses remain viable based on current evidence"),"Evidence evaluation uses SATS-based credibility assessment for systematic analysis",'"'.concat(o,'" shows strongest evidence support among remaining viable options')],recommendations:["Focus collection efforts on evidence that could further eliminate remaining viable hypotheses","Avoid premature commitment to single explanation until alternatives are ruled out","Monitor indicators that could resurrect dismissed hypotheses or eliminate remaining ones"],confidenceAssessment:"Overall confidence in the primary hypothesis is ".concat((null==i?void 0:i.confidenceLevel)||"moderate"," based on the quantity and quality of available evidence. The assessment considers both the consistency of evidence with the hypothesis and the credibility of information sources as evaluated through SATS methodology."),alternativeExplanations:n.slice(1,3).map(t=>{let n=e.hypotheses.find(e=>e.id===t.hypothesisId);return"".concat((null==n?void 0:n.text)||"Alternative hypothesis"," (Score: ").concat(t.weightedScore.toFixed(2),")")}).filter(Boolean),gaps:["Additional corroborating evidence for primary hypothesis","Information to definitively rule out alternative explanations","Enhanced source evaluation for key pieces of evidence"]}}(e)}}async function A(){try{if(!S.env.NEXT_PUBLIC_OPENAI_API_KEY||"demo-key"===S.env.NEXT_PUBLIC_OPENAI_API_KEY)return!1;return!!(await C.chat.completions.create({model:"gpt-4o-mini",messages:[{role:"user",content:"Test"}],max_tokens:1})).choices[0]}catch(e){return!1}}async function F(e){let t=new m.Workbook;t.creator=e.analyst||"Research Tools Platform",t.created=e.createdAt,t.modified=new Date;let n=t.addWorksheet("ACH Matrix");await k(n,e);let i=t.addWorksheet("Analysis Summary");await T(i,e);let o=t.addWorksheet("Evidence Details");await N(o,e);let a=t.addWorksheet("Scale Reference");return await j(a,e),await t.xlsx.writeBuffer()}async function k(e,t){let{hypotheses:n,evidence:i,scores:o,scaleType:a}=t;e.mergeCells("A1","".concat(String.fromCharCode(65+n.length),"1"));let l=e.getCell("A1");l.value=t.title,l.font={size:16,bold:!0},l.alignment={horizontal:"center"},e.mergeCells("A2","".concat(String.fromCharCode(65+n.length),"2"));let r=e.getCell("A2");r.value="Analysis of Competing Hypotheses Matrix (".concat("logarithmic"===a?"Logarithmic":"Linear"," Scale)"),r.font={size:12,italic:!0},r.alignment={horizontal:"center"},e.getCell("A4").value="Evidence",e.getCell("A4").font={bold:!0},e.getCell("A4").fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFD0D0D0"}},n.forEach((t,n)=>{let i=String.fromCharCode(66+n),o=e.getCell("".concat(i,"4"));o.value="H".concat(n+1,": ").concat(t.text),o.font={bold:!0},o.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE0E0FF"}},o.alignment={horizontal:"center",wrapText:!0},e.getColumn(i).width=20}),i.forEach((t,i)=>{let l=i+5,r=e.getCell("A".concat(l));r.value=t.text,r.alignment={wrapText:!0,vertical:"top"},t.confidenceScore&&(r.value+=" [Credibility: ".concat(t.confidenceScore,"/13]")),n.forEach((n,i)=>{let r=String.fromCharCode(66+i),s=e.getCell("".concat(r).concat(l)),c=o.get(t.id),d=null==c?void 0:c.get(n.id);if(d){if(s.value=d.score,s.alignment={horizontal:"center"},d.score>0){let e=Math.floor(255-100*Math.min(Math.abs(d.score)/("logarithmic"===a?13:5),1));s.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF".concat(e.toString(16).padStart(2,"0"),"FF").concat(e.toString(16).padStart(2,"0"))}}}else if(d.score<0){let e=Math.floor(255-100*Math.min(Math.abs(d.score)/("logarithmic"===a?13:5),1));s.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFF".concat(e.toString(16).padStart(2,"0")).concat(e.toString(16).padStart(2,"0"))}}}else s.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF0F0F0"}};s.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}})}),e.getColumn("A").width=40;let s=i.length+6;e.getCell("A".concat(s)).value="TOTALS",e.getCell("A".concat(s)).font={bold:!0},e.getCell("A".concat(s)).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"}},n.forEach((t,n)=>{let a=String.fromCharCode(66+n),l=e.getCell("".concat(a).concat(s)),r=0;i.forEach(e=>{let n=o.get(e.id),i=null==n?void 0:n.get(t.id);i&&(r+=i.score)}),l.value=r,l.font={bold:!0},l.alignment={horizontal:"center"},l.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"}}})}async function T(e,t){let n=t.analysis||(0,b.Ln)(t.hypotheses,t.scores,t.scaleType);e.getCell("A1").value="ACH Analysis Summary",e.getCell("A1").font={size:16,bold:!0},e.getCell("A3").value="Analysis Date:",e.getCell("B3").value=t.createdAt.toLocaleDateString(),t.analyst&&(e.getCell("A4").value="Analyst:",e.getCell("B4").value=t.analyst),t.organization&&(e.getCell("A5").value="Organization:",e.getCell("B5").value=t.organization),e.getCell("A7").value="Hypothesis Ranking (by Weighted Score)",e.getCell("A7").font={size:14,bold:!0},["Rank","Hypothesis","Weighted Score","Total Score","Supporting","Contradicting","Confidence","Status"].forEach((t,n)=>{let i=e.getCell("".concat(String.fromCharCode(65+n),"9"));i.value=t,i.font={bold:!0},i.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFD0D0D0"}}}),n.forEach((n,i)=>{let o=10+i,a=t.hypotheses.find(e=>e.id===n.hypothesisId);e.getCell("A".concat(o)).value=i+1,e.getCell("B".concat(o)).value=(null==a?void 0:a.text)||"Hypothesis ".concat(i+1),e.getCell("C".concat(o)).value=Math.round(100*n.weightedScore)/100,e.getCell("D".concat(o)).value=n.totalScore,e.getCell("E".concat(o)).value=n.supportingEvidence,e.getCell("F".concat(o)).value=n.contradictingEvidence,e.getCell("G".concat(o)).value=n.confidenceLevel,e.getCell("H".concat(o)).value=n.rejectionThreshold?"REJECTED":"VIABLE",n.rejectionThreshold?(e.getCell("H".concat(o)).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFF0000"}},e.getCell("H".concat(o)).font={color:{argb:"FFFFFFFF"}}):0===i&&(e.getCell("H".concat(o)).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF00FF00"}})}),e.getColumn("A").width=8,e.getColumn("B").width=40,e.getColumn("C").width=15,e.getColumn("D").width=12,e.getColumn("E").width=12,e.getColumn("F").width=15,e.getColumn("G").width=12,e.getColumn("H").width=12}async function N(e,t){e.getCell("A1").value="Evidence Details and SATS Evaluation",e.getCell("A1").font={size:16,bold:!0},["Evidence ID","Evidence Text","Credibility Score","Credibility Level","SATS Evaluation"].forEach((t,n)=>{let i=e.getCell("".concat(String.fromCharCode(65+n),"3"));i.value=t,i.font={bold:!0},i.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFD0D0D0"}}}),t.evidence.forEach((t,n)=>{let i=4+n;e.getCell("A".concat(i)).value="E".concat(n+1),e.getCell("B".concat(i)).value=t.text,e.getCell("C".concat(i)).value=t.confidenceScore||"Not Evaluated";let o="Unknown";if(t.confidenceScore&&(o=t.confidenceScore>=11?"VERY HIGH":t.confidenceScore>=7?"HIGH":t.confidenceScore>=4?"MODERATE":t.confidenceScore>=2?"LOW":"VERY LOW"),e.getCell("D".concat(i)).value=o,t.evaluationResponses){let n=Object.entries(t.evaluationResponses).map(e=>{let[t,n]=e;return"".concat(t,": ").concat(n)}).join("; ");e.getCell("E".concat(i)).value=n}}),e.getColumn("A").width=12,e.getColumn("B").width=50,e.getColumn("C").width=15,e.getColumn("D").width=15,e.getColumn("E").width=40}async function j(e,t){e.getCell("A1").value="".concat("logarithmic"===t.scaleType?"Logarithmic (Fibonacci)":"Linear"," Scale Reference"),e.getCell("A1").font={size:16,bold:!0},e.getCell("A3").value="Score",e.getCell("B3").value="Label",e.getCell("C3").value="Description";let n=e.getRow(3);n.font={bold:!0},n.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFD0D0D0"}},("logarithmic"===t.scaleType?[{value:13,label:"Strongly Supports",description:"Evidence strongly confirms hypothesis"},{value:8,label:"Moderately Supports",description:"Evidence moderately confirms hypothesis"},{value:5,label:"Slightly Supports",description:"Evidence slightly confirms hypothesis"},{value:3,label:"Weakly Supports",description:"Evidence weakly confirms hypothesis"},{value:1,label:"Very Weakly Supports",description:"Evidence very weakly confirms hypothesis"},{value:0,label:"Neutral",description:"Evidence neither supports nor contradicts"},{value:-1,label:"Very Weakly Contradicts",description:"Evidence very weakly contradicts hypothesis"},{value:-3,label:"Weakly Contradicts",description:"Evidence weakly contradicts hypothesis"},{value:-5,label:"Slightly Contradicts",description:"Evidence slightly contradicts hypothesis"},{value:-8,label:"Moderately Contradicts",description:"Evidence moderately contradicts hypothesis"},{value:-13,label:"Strongly Contradicts",description:"Evidence strongly contradicts hypothesis"}]:[{value:5,label:"Strongly Supports",description:"Evidence strongly confirms hypothesis"},{value:4,label:"Moderately Supports",description:"Evidence moderately confirms hypothesis"},{value:3,label:"Slightly Supports",description:"Evidence slightly confirms hypothesis"},{value:2,label:"Weakly Supports",description:"Evidence weakly confirms hypothesis"},{value:1,label:"Very Weakly Supports",description:"Evidence very weakly confirms hypothesis"},{value:0,label:"Neutral",description:"Evidence neither supports nor contradicts"},{value:-1,label:"Very Weakly Contradicts",description:"Evidence very weakly contradicts hypothesis"},{value:-2,label:"Weakly Contradicts",description:"Evidence weakly contradicts hypothesis"},{value:-3,label:"Slightly Contradicts",description:"Evidence slightly contradicts hypothesis"},{value:-4,label:"Moderately Contradicts",description:"Evidence moderately contradicts hypothesis"},{value:-5,label:"Strongly Contradicts",description:"Evidence strongly contradicts hypothesis"}]).forEach((t,n)=>{let i=4+n;e.getCell("A".concat(i)).value=t.value,e.getCell("B".concat(i)).value=t.label,e.getCell("C".concat(i)).value=t.description,t.value>0?e.getCell("A".concat(i)).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE0FFE0"}}:t.value<0?e.getCell("A".concat(i)).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFE0E0"}}:e.getCell("A".concat(i)).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF0F0F0"}}}),e.getColumn("A").width=8,e.getColumn("B").width=25,e.getColumn("C").width=50}async function P(e){let t=new v.jsPDF,n=e.analysis||(0,b.Ln)(e.hypotheses,e.scores,e.scaleType),i=20,o=null;try{await A()&&(o=await w(e))}catch(e){console.warn("AI analysis not available, using fallback")}if(t.setFontSize(24),t.setFont("helvetica","bold"),t.text(e.title,105,40,{align:"center"}),t.setFontSize(16),t.setFont("helvetica","normal"),t.text("Analysis of Competing Hypotheses",105,60,{align:"center"}),t.text("Intelligence Assessment Report",105,75,{align:"center"}),t.setFontSize(12),t.text("Generated: ".concat(e.createdAt.toLocaleDateString()),105,100,{align:"center"}),e.analyst&&t.text("Analyst: ".concat(e.analyst),105,115,{align:"center"}),e.organization&&t.text("Organization: ".concat(e.organization),105,130,{align:"center"}),t.addPage(),i=30,t.setFontSize(18),t.setFont("helvetica","bold"),t.text("Executive Summary",20,i),i+=15,t.setFontSize(12),t.setFont("helvetica","normal"),o)t.splitTextToSize(o.executiveSummary,170).forEach(e=>{i>270&&(t.addPage(),i=30),t.text(e,20,i),i+=6});else{let o=n[0],a=e.hypotheses.find(e=>e.id===o.hypothesisId);t.text("Analysis Question: ".concat(e.title),20,i),i+=10,e.description&&(t.text("Context: ".concat(e.description),20,i),i+=10),t.text("Primary Conclusion: ".concat((null==a?void 0:a.text)||"Primary hypothesis"),20,i),i+=10,t.text("Confidence Level: ".concat(o.confidenceLevel),20,i),i+=10,t.text("Weighted Score: ".concat(Math.round(100*o.weightedScore)/100),20,i)}t.addPage(),i=30,t.setFontSize(18),t.setFont("helvetica","bold"),t.text("Methodology",20,i),i+=15,t.setFontSize(12),t.setFont("helvetica","normal");let a="This Analysis of Competing Hypotheses (ACH) employed structured analytic techniques to evaluate ".concat(e.hypotheses.length," competing hypotheses against ").concat(e.evidence.length," pieces of evidence. The analysis used a ").concat(e.scaleType," scoring scale to assess the consistency of each piece of evidence with each hypothesis.\n\nEvidence Evaluation: Each piece of evidence was evaluated using the Structured Analytic Techniques Standards (SATS) methodology, assessing factors including source classification, corroboration, bias potential, and access to information. Evidence credibility scores range from 1 (very low) to 13 (very high).\n\nScoring Method: The ").concat(e.scaleType," scale ").concat("logarithmic"===e.scaleType?"uses Fibonacci sequence values (1, 3, 5, 8, 13) to better match human perception of differences in evidence strength":"uses linear values (1-5) for organizational consistency",". Positive scores indicate evidence supports a hypothesis, negative scores indicate contradiction, and zero indicates neutrality.\n\nWeighting: Final hypothesis scores incorporate both consistency ratings and evidence credibility, ensuring that strong claims from weak sources receive appropriate weight adjustment.");t.splitTextToSize(a,170).forEach(e=>{i>270&&(t.addPage(),i=30),t.text(e,20,i),i+=6}),o&&o.keyFindings.length>0&&((i+=15)>250&&(t.addPage(),i=30),t.setFontSize(14),t.setFont("helvetica","bold"),t.text("Key Findings",20,i),i+=10,t.setFontSize(12),t.setFont("helvetica","normal"),o.keyFindings.forEach((e,n)=>{i>270&&(t.addPage(),i=30),t.splitTextToSize("• ".concat(e),165).forEach(e=>{t.text(e,25,i),i+=6}),i+=3})),t.addPage(),i=30,t.setFontSize(18),t.setFont("helvetica","bold"),t.text("Hypothesis Analysis",20,i),i+=15;let l=n.map((t,n)=>{let i=e.hypotheses.find(e=>e.id===t.hypothesisId);return[(n+1).toString(),(null==i?void 0:i.text)||"Hypothesis ".concat(n+1),t.weightedScore.toFixed(2),t.totalScore.toString(),t.supportingEvidence.toString(),t.contradictingEvidence.toString(),t.confidenceLevel,t.rejectionThreshold?"REJECTED":"VIABLE"]});(0,f.Ay)(t,{head:[["Rank","Hypothesis","Weighted Score","Total","Supporting","Contradicting","Confidence","Status"]],body:l,startY:i,styles:{fontSize:9,cellPadding:3},columnStyles:{0:{cellWidth:15},1:{cellWidth:60},2:{cellWidth:20},3:{cellWidth:15},4:{cellWidth:18},5:{cellWidth:18},6:{cellWidth:20},7:{cellWidth:20}},didParseCell:e=>{7===e.column.index&&"REJECTED"===e.cell.text[0]?(e.cell.styles.fillColor=[255,220,220],e.cell.styles.textColor=[150,0,0]):7===e.column.index&&"VIABLE"===e.cell.text[0]&&(e.cell.styles.fillColor=[220,255,220],e.cell.styles.textColor=[0,100,0])}}),t.addPage(),i=30,t.setFontSize(18),t.setFont("helvetica","bold"),t.text("Evidence Analysis",20,i),i+=15,t.setFontSize(12),t.setFont("helvetica","normal"),t.text("This analysis evaluated ".concat(e.evidence.length," pieces of evidence using SATS methodology for credibility assessment."),20,i),i+=15;let r=e.evidence.map((e,t)=>{var n;let i=e.confidenceScore?e.confidenceScore>=11?"VERY HIGH":e.confidenceScore>=7?"HIGH":e.confidenceScore>=4?"MODERATE":e.confidenceScore>=2?"LOW":"VERY LOW":"Not Evaluated";return["E".concat(t+1),e.text,(null==(n=e.confidenceScore)?void 0:n.toString())||"N/A",i]});(0,f.Ay)(t,{head:[["ID","Evidence Description","SATS Score","Credibility Level"]],body:r,startY:i,styles:{fontSize:9,cellPadding:3},columnStyles:{0:{cellWidth:15},1:{cellWidth:100},2:{cellWidth:20},3:{cellWidth:30}}}),t.addPage(),i=30,t.setFontSize(18),t.setFont("helvetica","bold"),t.text("Evidence-Hypothesis Consistency Matrix",20,i),i+=15;let s=["Evidence",...e.hypotheses.map((e,t)=>"H".concat(t+1))],c=e.evidence.map((t,n)=>{let i=["E".concat(n+1)];return e.hypotheses.forEach(n=>{var o;let a=null==(o=e.scores.get(t.id))?void 0:o.get(n.id);i.push(a?"".concat(a.score>0?"+":"").concat(a.score):"-")}),i});(0,f.Ay)(t,{head:[s],body:c,startY:i,styles:{fontSize:8,cellPadding:2,halign:"center"},didParseCell:e=>{if(e.row.index>0&&e.column.index>0){let t=parseFloat(e.cell.text[0]);isNaN(t)||(t>0?e.cell.styles.fillColor=[220,255,220]:t<0?e.cell.styles.fillColor=[255,220,220]:e.cell.styles.fillColor=[240,240,240])}}}),o&&(o.recommendations.length>0&&(t.addPage(),i=30,t.setFontSize(18),t.setFont("helvetica","bold"),t.text("Recommendations",20,i),i+=15,t.setFontSize(12),t.setFont("helvetica","normal"),o.recommendations.forEach((e,n)=>{i>270&&(t.addPage(),i=30),t.splitTextToSize("".concat(n+1,". ").concat(e),165).forEach(e=>{t.text(e,20,i),i+=6}),i+=5})),(i+=15)>250&&(t.addPage(),i=30),t.setFontSize(16),t.setFont("helvetica","bold"),t.text("Confidence Assessment",20,i),i+=10,t.setFontSize(12),t.setFont("helvetica","normal"),t.splitTextToSize(o.confidenceAssessment,170).forEach(e=>{i>270&&(t.addPage(),i=30),t.text(e,20,i),i+=6}),o.gaps.length>0&&((i+=15)>250&&(t.addPage(),i=30),t.setFontSize(16),t.setFont("helvetica","bold"),t.text("Intelligence Gaps",20,i),i+=10,t.setFontSize(12),t.setFont("helvetica","normal"),o.gaps.forEach((e,n)=>{i>270&&(t.addPage(),i=30),t.splitTextToSize("• ".concat(e),165).forEach(e=>{t.text(e,25,i),i+=6}),i+=3})));let d=t.getNumberOfPages();for(let e=1;e<=d;e++)t.setPage(e),t.setFontSize(10),t.setFont("helvetica","normal"),t.text("Page ".concat(e," of ").concat(d),190,285,{align:"right"}),t.text("FOR OFFICIAL USE ONLY",105,10,{align:"center"}),t.text("FOR OFFICIAL USE ONLY",105,290,{align:"center"});return t.output("arraybuffer")}async function L(e){var t;let n=e.analysis||(0,b.Ln)(e.hypotheses,e.scores,e.scaleType),i=[{children:[new x.Paragraph({text:e.title,heading:x.HeadingLevel.TITLE,alignment:x.Yus.CENTER}),new x.Paragraph({text:"Analysis of Competing Hypotheses Report",heading:x.HeadingLevel.HEADING_1,alignment:x.Yus.CENTER}),new x.Paragraph({children:[new x.TextRun({text:"Generated: ".concat(e.createdAt.toLocaleDateString()),break:1}),...e.analyst?[new x.TextRun({text:"Analyst: ".concat(e.analyst),break:1})]:[],...e.organization?[new x.TextRun({text:"Organization: ".concat(e.organization),break:1})]:[]],alignment:x.Yus.CENTER}),new x.Paragraph({text:"Executive Summary",heading:x.HeadingLevel.HEADING_1}),new x.Paragraph({children:[new x.TextRun({text:"This analysis evaluates ".concat(e.hypotheses.length," competing hypotheses against ").concat(e.evidence.length," pieces of evidence using a ").concat(e.scaleType," scoring scale.")})]}),new x.Paragraph({children:[new x.TextRun({text:"Primary Hypothesis: ",bold:!0}),new x.TextRun({text:(null==(t=e.hypotheses.find(e=>e.id===n[0].hypothesisId))?void 0:t.text)||"Unknown"})]}),new x.Paragraph({children:[new x.TextRun({text:"Weighted Score: ",bold:!0}),new x.TextRun({text:"".concat(Math.round(100*n[0].weightedScore)/100)})]}),new x.Paragraph({text:"Hypothesis Ranking",heading:x.HeadingLevel.HEADING_1}),new x.XIK({width:{size:100,type:x.PsV.PERCENTAGE},rows:[new x.Hjg({children:[new x.nA6({children:[new x.Paragraph("Rank")]}),new x.nA6({children:[new x.Paragraph("Hypothesis")]}),new x.nA6({children:[new x.Paragraph("Weighted Score")]}),new x.nA6({children:[new x.Paragraph("Status")]})]}),...n.map((t,n)=>{let i=e.hypotheses.find(e=>e.id===t.hypothesisId);return new x.Hjg({children:[new x.nA6({children:[new x.Paragraph((n+1).toString())]}),new x.nA6({children:[new x.Paragraph((null==i?void 0:i.text)||"Hypothesis ".concat(n+1))]}),new x.nA6({children:[new x.Paragraph((Math.round(100*t.weightedScore)/100).toString())]}),new x.nA6({children:[new x.Paragraph(t.rejectionThreshold?"REJECTED":"VIABLE")]})]})})]})]}],o=new x.Document({sections:i});return await x.Packer.toBuffer(o)}let I=[{id:"excel",name:"Excel Spreadsheet",description:"Government-standard ACH matrix with hypothesis columns, evidence rows, and color-coded scoring",icon:a.A,mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",extension:"xlsx",recommended:!0,governmentStandard:!0},{id:"pdf",name:"PDF Report",description:"Comprehensive intelligence report with AI-generated executive summary, evidence analysis, SATS ratings, and methodology",icon:l.A,mimeType:"application/pdf",extension:"pdf",recommended:!0},{id:"word",name:"Word Document",description:"Editable document with structured analysis, tables, and findings for further editing",icon:r.A,mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",extension:"docx"}];function H(e){let{data:t,className:n}=e,[a,l]=(0,o.useState)(new Set),[r,m]=(0,o.useState)(new Set),{toast:v}=(0,u.d)(),f=async e=>{l(t=>new Set(t).add(e));try{let n,i=I.find(t=>t.id===e);switch(e){case"excel":n=await F(t);break;case"pdf":n=await P(t);break;case"word":n=await L(t);break;default:throw Error("Unsupported export format: ".concat(e))}!function(e,t,n){let i=new Blob([e],{type:n}),o=URL.createObjectURL(i),a=document.createElement("a");a.href=o,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(o)}(n,(e=>{var n;let i=t.title.replace(/[^a-zA-Z0-9]/g,"_").toLowerCase(),o=t.createdAt.toISOString().split("T")[0];return"ach_".concat(i,"_").concat(o,".").concat(null==(n=I.find(t=>t.id===e))?void 0:n.extension)})(e),i.mimeType),m(t=>new Set(t).add(e)),v({title:"Export Successful",description:"".concat(i.name," has been downloaded successfully.")}),setTimeout(()=>{m(t=>{let n=new Set(t);return n.delete(e),n})},3e3)}catch(t){console.error("Error exporting ".concat(e,":"),t),v({title:"Export Failed",description:"Failed to export ".concat(e.toUpperCase(),". Please try again."),variant:"destructive"})}finally{l(t=>{let n=new Set(t);return n.delete(e),n})}},x=async()=>{for(let e of I)a.has(e.id)||(await f(e.id),await new Promise(e=>setTimeout(e,500)))};return(0,i.jsxs)(g.Zp,{className:n,children:[(0,i.jsxs)(g.aR,{children:[(0,i.jsxs)(g.ZB,{className:"flex items-center gap-2",children:[(0,i.jsx)(s.A,{className:"h-5 w-5"}),"Export ACH Analysis"]}),(0,i.jsx)(g.BT,{children:"Download your analysis in professional formats suitable for government and organizational use"})]}),(0,i.jsxs)(g.Wu,{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"p-4 bg-gray-50 dark:bg-slate-800 rounded-lg",children:[(0,i.jsx)("h4",{className:"font-medium mb-2",children:"Analysis Summary"}),(0,i.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"text-gray-500",children:"Hypotheses:"}),(0,i.jsx)("div",{className:"font-medium",children:t.hypotheses.length})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"text-gray-500",children:"Evidence:"}),(0,i.jsx)("div",{className:"font-medium",children:t.evidence.length})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"text-gray-500",children:"Scale:"}),(0,i.jsx)("div",{className:"font-medium capitalize",children:t.scaleType})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"text-gray-500",children:"Date:"}),(0,i.jsx)("div",{className:"font-medium",children:t.createdAt.toLocaleDateString()})]})]})]}),(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("h4",{className:"font-medium",children:"Export Formats"}),(0,i.jsx)(p.$,{onClick:x,disabled:a.size>0,variant:"outline",size:"sm",children:a.size>0?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(c.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Exporting..."]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.A,{className:"h-4 w-4 mr-2"}),"Export All"]})})]}),(0,i.jsx)("div",{className:"grid gap-4",children:I.map(e=>{let t=a.has(e.id),n=r.has(e.id),o=e.icon;return(0,i.jsxs)("div",{className:"flex items-center gap-4 p-4 border rounded-lg hover:bg-gray-50 dark:hover:bg-slate-800 transition-colors",children:[(0,i.jsx)("div",{className:"flex-shrink-0",children:(0,i.jsx)(o,{className:"h-8 w-8 text-blue-600"})}),(0,i.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,i.jsx)("h5",{className:"font-medium",children:e.name}),e.recommended&&(0,i.jsx)(y.E,{variant:"secondary",className:"text-xs",children:"Recommended"}),e.governmentStandard&&(0,i.jsx)(y.E,{variant:"outline",className:"text-xs border-green-500 text-green-700 dark:text-green-400",children:"Gov Standard"})]}),(0,i.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.description})]}),(0,i.jsx)("div",{className:"flex-shrink-0",children:(0,i.jsx)(p.$,{onClick:()=>f(e.id),disabled:t,variant:n?"default":"outline",size:"sm",children:t?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(c.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Exporting..."]}):n?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(d.A,{className:"h-4 w-4 mr-2"}),"Downloaded"]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.A,{className:"h-4 w-4 mr-2"}),"Export"]})})})]},e.id)})})]}),(0,i.jsx)("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:(0,i.jsxs)("div",{className:"flex items-start gap-2",children:[(0,i.jsx)(h.A,{className:"h-4 w-4 text-blue-600 shrink-0 mt-0.5"}),(0,i.jsxs)("div",{className:"text-sm text-blue-800 dark:text-blue-200",children:[(0,i.jsx)("p",{className:"font-medium mb-2",children:"Export Tips:"}),(0,i.jsxs)("ul",{className:"space-y-1 text-xs",children:[(0,i.jsxs)("li",{children:["• ",(0,i.jsx)("strong",{children:"Excel:"})," Best for government workflows - opens in desktop Excel with full formatting"]}),(0,i.jsxs)("li",{children:["• ",(0,i.jsx)("strong",{children:"PDF:"})," Professional reports for distribution and archival"]}),(0,i.jsxs)("li",{children:["• ",(0,i.jsx)("strong",{children:"Word:"})," Editable format for collaborative analysis and report writing"]}),(0,i.jsxs)("li",{children:["• ",(0,i.jsx)("strong",{children:"PowerPoint:"})," Ready-to-use briefing slides for presentations"]})]})]})]})})]})]})}},25027:(e,t,n)=>{n.d(t,{Je:()=>s,Ln:()=>l,U_:()=>r,i5:()=>o,i7:()=>i});let i=[{label:"Strongly Supports",value:13,color:"text-green-800 bg-green-100 dark:text-green-100 dark:bg-green-800",description:"Evidence strongly confirms hypothesis"},{label:"Moderately Supports",value:8,color:"text-green-700 bg-green-50 dark:text-green-200 dark:bg-green-700",description:"Evidence moderately confirms hypothesis"},{label:"Slightly Supports",value:5,color:"text-green-600 bg-green-50 dark:text-green-200 dark:bg-green-600",description:"Evidence slightly confirms hypothesis"},{label:"Weakly Supports",value:3,color:"text-green-500 bg-green-50 dark:text-green-200 dark:bg-green-500",description:"Evidence weakly confirms hypothesis"},{label:"Very Weakly Supports",value:1,color:"text-green-400 bg-green-50 dark:text-green-200 dark:bg-green-400",description:"Evidence very weakly confirms hypothesis"},{label:"Neutral",value:0,color:"text-gray-600 bg-gray-100 dark:text-gray-200 dark:bg-gray-600",description:"Evidence neither supports nor contradicts"},{label:"Very Weakly Contradicts",value:-1,color:"text-red-400 bg-red-50 dark:text-red-200 dark:bg-red-400",description:"Evidence very weakly contradicts hypothesis"},{label:"Weakly Contradicts",value:-3,color:"text-red-500 bg-red-50 dark:text-red-200 dark:bg-red-500",description:"Evidence weakly contradicts hypothesis"},{label:"Slightly Contradicts",value:-5,color:"text-red-600 bg-red-50 dark:text-red-200 dark:bg-red-600",description:"Evidence slightly contradicts hypothesis"},{label:"Moderately Contradicts",value:-8,color:"text-red-700 bg-red-50 dark:text-red-200 dark:bg-red-700",description:"Evidence moderately contradicts hypothesis"},{label:"Strongly Contradicts",value:-13,color:"text-red-800 bg-red-100 dark:text-red-100 dark:bg-red-800",description:"Evidence strongly contradicts hypothesis"}],o=[{label:"Strongly Supports",value:5,color:"text-green-800 bg-green-100 dark:text-green-100 dark:bg-green-800",description:"Evidence strongly confirms hypothesis"},{label:"Moderately Supports",value:4,color:"text-green-700 bg-green-50 dark:text-green-200 dark:bg-green-700",description:"Evidence moderately confirms hypothesis"},{label:"Slightly Supports",value:3,color:"text-green-600 bg-green-50 dark:text-green-200 dark:bg-green-600",description:"Evidence slightly confirms hypothesis"},{label:"Weakly Supports",value:2,color:"text-green-500 bg-green-50 dark:text-green-200 dark:bg-green-500",description:"Evidence weakly confirms hypothesis"},{label:"Very Weakly Supports",value:1,color:"text-green-400 bg-green-50 dark:text-green-200 dark:bg-green-400",description:"Evidence very weakly confirms hypothesis"},{label:"Neutral",value:0,color:"text-gray-600 bg-gray-100 dark:text-gray-200 dark:bg-gray-600",description:"Evidence neither supports nor contradicts"},{label:"Very Weakly Contradicts",value:-1,color:"text-red-400 bg-red-50 dark:text-red-200 dark:bg-red-400",description:"Evidence very weakly contradicts hypothesis"},{label:"Weakly Contradicts",value:-2,color:"text-red-500 bg-red-50 dark:text-red-200 dark:bg-red-500",description:"Evidence weakly contradicts hypothesis"},{label:"Slightly Contradicts",value:-3,color:"text-red-600 bg-red-50 dark:text-red-200 dark:bg-red-600",description:"Evidence slightly contradicts hypothesis"},{label:"Moderately Contradicts",value:-4,color:"text-red-700 bg-red-50 dark:text-red-200 dark:bg-red-700",description:"Evidence moderately contradicts hypothesis"},{label:"Strongly Contradicts",value:-5,color:"text-red-800 bg-red-100 dark:text-red-100 dark:bg-red-800",description:"Evidence strongly contradicts hypothesis"}];function a(e,t,n){let i=Math.abs(e)/("logarithmic"===n?13:5),o=t/13;return i>.6&&o<.4?.3+.7*o:i>.4&&o<.6?.5+.5*o:.7+.3*o}function l(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"logarithmic";return e.map(i=>{let o=Array.from(t.values()).map(e=>e.get(i.id)).filter(e=>void 0!==e),l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"logarithmic";return e.reduce((e,n)=>{var i,o;let l=(null==(i=n.weight)?void 0:i.credibility)||3,r=(null==(o=n.weight)?void 0:o.relevance)||3,s=n.evidenceCredibility?n.evidenceCredibility/13:l*r/25,c=n.evidenceCredibility?a(n.score,n.evidenceCredibility,t):1;return e+n.score*c*s},0)}(o,n),r=o.reduce((e,t)=>e+t.score,0),s=o.filter(e=>e.score>0).length,c=o.filter(e=>e.score<0).length,d=o.filter(e=>0===e.score).length,h=o.length>0?o.reduce((e,t)=>{var n,i;return e+(((null==(n=t.weight)?void 0:n.credibility)||3)+((null==(i=t.weight)?void 0:i.relevance)||3))/2},0)/o.length:0,g=new Map;return e.forEach(e=>{let n=Array.from(t.values()).map(t=>{var n;return(null==(n=t.get(e.id))?void 0:n.score)||0});g.set(e.id,n.reduce((e,t)=>e+t,0))}),{hypothesisId:i.id,totalScore:r,weightedScore:l,supportingEvidence:s,contradictingEvidence:c,neutralEvidence:d,diagnosticValue:function(e){let t=Array.from(e.values());if(t.length<2)return 0;let n=t.reduce((e,t)=>e+t,0)/t.length;return Math.sqrt(t.reduce((e,t)=>e+Math.pow(t-n,2),0)/t.length)}(g),confidenceLevel:function(e,t,n){if(n&&n.length>0){let t=n.filter(e=>void 0!==e.evidenceCredibility).map(e=>e.evidenceCredibility);if(t.length>0){let n=t.reduce((e,t)=>e+t,0)/t.length,i=n/13*e*5;return i>12&&n>=8?"High":i>6&&n>=5?"Medium":"Low"}}let i=e*t;return i>15?"High":i>7?"Medium":"Low"}(o.length,h,o),rejectionThreshold:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"logarithmic";return e<("logarithmic"===t?-20:-10)}(l,n)}}).sort((e,t)=>t.weightedScore-e.weightedScore)}function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"logarithmic";return("logarithmic"===t?i:o).find(t=>t.value===e)}function s(e,t){let n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"logarithmic",o="logarithmic"===i?13:5,l=a(e,t,i),r=e*l;return n=Math.abs(r)>.8*o?t>=8?"Very Strong":"Claimed Strong (Low Credibility)":Math.abs(r)>.6*o?t>=6?"Strong":"Claimed Strong (Moderate Credibility)":Math.abs(r)>.4*o?t>=4?"Moderate":"Weak (Low Credibility)":"Weak",{effectiveScore:r,strengthDescription:n,confidenceAdjustment:l}}}}]);