import{j as e}from"./ui-vendor-DBphXmDA.js";import{r as c,f as ha}from"./react-vendor-CfYLSWvh.js";import{h as ua}from"./viz-libs-B9RIjOsc.js";import{C as f,a as Y,b as se,c as pa,d as X}from"./card-BGAig-Dv.js";import{l as ps,H as At,B as d,m as gs,n as fs,o as js,p as Ts,e as z,I as We,S as $t,z as Tt,C as zt,E as Lt,F as Qe,q as he,d as It,A as ms,r as xs,t as Qs,G as ga,u as fa,D as Me,g as Ue,h as qe,i as ja,j as ns,k as J,w as ya}from"./index-QqleixXe.js";import{P as Z}from"./progress-Cg1bbsHw.js";import{T as ba,a as Na,b as va,c as wa}from"./tooltip-_NEsV_z7.js";import{a as ka,l as _a,b as Ca}from"./citation-library-DsFrzEV3.js";import{S as ve}from"./slider-B52ikc1m.js";import{T as Nt,a as vt,b as ls,c as os}from"./tabs-If3dmLWi.js";import{ah as hs,L as q,E as Ce,q as Rt,a as Ae,d as we,aj as zs,az as ts,v as Ge,U as Be,b1 as Bs,aI as wt,am as kt,V as Ys,aa as Sa,aB as Ea,T as De,R as Aa,c as $e,$ as Gs,l as us,x as Js,Y as Ls,r as Ve,X as $a,a1 as Xs,Q as Ft,h as ss,P as Se,ad as Ta,ai as za,w as Ot,b2 as La,S as Ee,aK as Te,b0 as Pt,M as Ia,b3 as _t,b4 as He,aP as Ks,b5 as cs,aR as Ra,C as ds,a0 as Fa,A as Oa,a2 as Pa,ay as Ct,I as Ma,b6 as Ua,b7 as qa,a9 as es,aO as Da,b8 as Ha,b9 as Va,ba as Wa}from"./icons-x9tcvtYN.js";import{S as Qa}from"./separator-ozDNNLDu.js";import"./state-vendor-BXB5jEEt.js";function St(o,n){const j=Ba(o),v=Ga(o.author),{year:M,month:R,day:L}=Ja(o.publish_date),F={authors:v,title:o.title||"Untitled",year:M,month:R,day:L,url:n||o.url,siteName:o.domain,accessDate:new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})};return j==="news"&&(F.publication=o.domain),{sourceType:j,fields:F}}function Ba(o){if(o.is_social_media)return"website";const n=["news","times","post","guardian","reuters","cnn","bbc","npr"],j=o.domain.toLowerCase();return n.some(R=>j.includes(R))?"news":["journal","academic",".edu","research","pubmed","scholar"].some(R=>j.includes(R))?"journal":[".gov",".org","report","whitepaper"].some(R=>j.includes(R))?"report":"website"}function Ga(o){if(!o||o.trim()==="")return[{firstName:"",lastName:"",middleName:""}];if(o.includes(",")){const j=o.split(",").map(v=>v.trim());return[{firstName:j[1]||"",lastName:j[0]||"",middleName:""}]}const n=o.trim().split(/\s+/);return n.length===1?[{firstName:"",lastName:n[0],middleName:""}]:n.length===2?[{firstName:n[0],lastName:n[1],middleName:""}]:[{firstName:n[0],middleName:n.slice(1,-1).join(" "),lastName:n[n.length-1]}]}function Ja(o){if(!o)return{};try{const n=new Date(o);if(isNaN(n.getTime())){const j=o.match(/\b(19|20)\d{2}\b/);return j?{year:j[0]}:{}}return{year:n.getFullYear().toString(),month:(n.getMonth()+1).toString().padStart(2,"0"),day:n.getDate().toString().padStart(2,"0")}}catch{return{}}}function Ka(o){const n=new URLSearchParams;if(n.set("sourceType",o.sourceType),n.set("title",o.fields.title),o.fields.url&&n.set("url",o.fields.url),o.fields.siteName&&n.set("siteName",o.fields.siteName),o.fields.year&&n.set("year",o.fields.year),o.fields.month&&n.set("month",o.fields.month),o.fields.day&&n.set("day",o.fields.day),o.fields.accessDate&&n.set("accessDate",o.fields.accessDate),o.fields.authors&&o.fields.authors.length>0){const j=o.fields.authors[0];j.firstName&&n.set("firstName",j.firstName),j.lastName&&n.set("lastName",j.lastName),j.middleName&&n.set("middleName",j.middleName)}return o.fields.publication&&n.set("publication",o.fields.publication),o.fields.publisher&&n.set("publisher",o.fields.publisher),n}function Ya({claimAdjustmentId:o,onLinked:n}){const[j,v]=c.useState(!1),[M,R]=c.useState(""),[L,F]=c.useState(!1),[E,te]=c.useState([]),[k,ue]=c.useState([]),[K,pe]=c.useState(!1),[V,t]=c.useState(null),[D,H]=c.useState("supports"),[u,I]=c.useState(75),[ne,ae]=c.useState(75),[le,re]=c.useState(""),[ge,fe]=c.useState(!1);c.useEffect(()=>{j&&oe()},[j]);const oe=async()=>{try{pe(!0);const h=await fetch(`/api/claims/get-evidence-links/${o}`,{credentials:"include"});if(!h.ok)throw new Error("Failed to load linked evidence");const G=await h.json();G.success&&ue(G.links||[])}catch(h){console.error("Error loading linked evidence:",h)}finally{pe(!1)}},ie=async()=>{try{F(!0);const h=new URLSearchParams({q:M,limit:"20",claim_id:o}),G=await fetch(`/api/claims/search-evidence?${h}`,{credentials:"include"});if(!G.ok)throw new Error("Failed to search evidence");const Ne=await G.json();Ne.success&&te(Ne.evidence||[])}catch(h){console.error("Error searching evidence:",h)}finally{F(!1)}},je=async()=>{if(V)try{fe(!0);const h=await fetch("/api/claims/link-evidence",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({claim_adjustment_id:o,evidence_id:V.id,relationship:D,relevance_score:u,confidence:ne,notes:le||void 0})});if(!h.ok){const G=await h.json();throw new Error(G.error||"Failed to link evidence")}t(null),re(""),I(75),ae(75),H("supports"),await oe(),M&&await ie(),n?.()}catch(h){console.error("Error linking evidence:",h),alert(h instanceof Error?h.message:"Failed to link evidence")}finally{fe(!1)}},ye=async h=>{if(confirm("Remove this evidence link?"))try{if(!(await fetch(`/api/claims/remove-evidence-link/${h}`,{method:"DELETE",credentials:"include"})).ok)throw new Error("Failed to remove link");await oe(),M&&await ie(),n?.()}catch(G){console.error("Error removing link:",G),alert("Failed to remove evidence link")}},be=h=>{switch(h){case"supports":return"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400";case"contradicts":return"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400";case"provides_context":return"bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-400";default:return"bg-gray-100 text-gray-700 dark:bg-gray-900/20 dark:text-gray-400"}},ce=h=>{switch(h){case"supports":return e.jsx(zs,{className:"h-3 w-3"});case"contradicts":return e.jsx(ts,{className:"h-3 w-3"});case"provides_context":return e.jsx(Ge,{className:"h-3 w-3"});default:return null}};return e.jsxs(ps,{open:j,onOpenChange:v,children:[e.jsx(At,{asChild:!0,children:e.jsxs(d,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(hs,{className:"h-4 w-4"}),"Link Evidence (",k.length,")"]})}),e.jsxs(gs,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(fs,{children:[e.jsx(js,{children:"Link Evidence to Claim"}),e.jsx(Ts,{children:"Connect evidence from your library to support, contradict, or provide context for this claim"})]}),e.jsxs("div",{className:"space-y-6",children:[K?e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(q,{className:"h-4 w-4 animate-spin"}),"Loading linked evidence..."]}):k.length>0?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h4",{className:"font-semibold text-sm",children:["Linked Evidence (",k.length,")"]}),e.jsx("div",{className:"space-y-2",children:k.map(h=>e.jsx(f,{className:"p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(z,{className:be(h.relationship),children:[ce(h.relationship),e.jsx("span",{className:"ml-1",children:h.relationship.replace("_"," ").toUpperCase()})]}),e.jsx("span",{className:"text-sm font-medium",children:h.title})]}),h.content_snippet&&e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2",children:h.content_snippet}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Relevance: ",h.relevance_score,"%"]}),e.jsxs("span",{children:["Confidence: ",h.confidence,"%"]}),h.credibility_score&&e.jsxs("span",{children:["Credibility: ",h.credibility_score,"/100"]})]}),h.notes&&e.jsxs("p",{className:"text-xs italic text-muted-foreground",children:["Note: ",h.notes]})]}),e.jsxs("div",{className:"flex gap-1",children:[h.source_url&&e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>window.open(h.source_url,"_blank"),children:e.jsx(Ce,{className:"h-3 w-3"})}),e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>ye(h.link_id),children:e.jsx(Rt,{className:"h-3 w-3"})})]})]})},h.link_id))})]}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No evidence linked yet"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-semibold text-sm",children:"Add New Evidence Link"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(We,{placeholder:"Search your evidence library...",value:M,onChange:h=>R(h.target.value),onKeyDown:h=>h.key==="Enter"&&ie()}),e.jsx(d,{onClick:ie,disabled:L,children:L?e.jsx(q,{className:"h-4 w-4 animate-spin"}):e.jsx(Ae,{className:"h-4 w-4"})})]}),E.length>0&&e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:E.map(h=>e.jsx(f,{className:`p-3 cursor-pointer transition-colors ${V?.id===h.id?"ring-2 ring-primary":"hover:bg-accent"}`,onClick:()=>t(h),children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(we,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:h.title})]}),h.content_snippet&&e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2 ml-6",children:h.content_snippet}),e.jsxs("div",{className:"flex items-center gap-2 ml-6",children:[e.jsx(z,{variant:"outline",className:"text-xs",children:h.source_type}),h.credibility_score&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Credibility: ",h.credibility_score,"/100"]})]})]})},h.id))}),V&&e.jsxs("div",{className:"space-y-4 p-4 bg-accent rounded-lg",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Relationship Type"}),e.jsxs($t,{value:D,onValueChange:h=>H(h),children:[e.jsx(Tt,{children:e.jsx(zt,{})}),e.jsxs(Lt,{children:[e.jsx(Qe,{value:"supports",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(zs,{className:"h-4 w-4 text-green-600"}),"Supports - Evidence confirms the claim"]})}),e.jsx(Qe,{value:"contradicts",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ts,{className:"h-4 w-4 text-red-600"}),"Contradicts - Evidence refutes the claim"]})}),e.jsx(Qe,{value:"provides_context",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"h-4 w-4 text-blue-600"}),"Provides Context - Evidence adds background"]})})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium",children:["Relevance Score: ",u,"%"]}),e.jsx(ve,{value:[u],onValueChange:h=>I(h[0]),min:0,max:100,step:5})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium",children:["Confidence: ",ne,"%"]}),e.jsx(ve,{value:[ne],onValueChange:h=>ae(h[0]),min:0,max:100,step:5})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Notes (optional)"}),e.jsx(he,{value:le,onChange:h=>re(h.target.value),placeholder:"Why is this evidence relevant to the claim?",rows:2})]}),e.jsx(d,{onClick:je,disabled:ge,className:"w-full",children:ge?e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"h-4 w-4 mr-2 animate-spin"}),"Linking..."]}):e.jsxs(e.Fragment,{children:[e.jsx(hs,{className:"h-4 w-4 mr-2"}),"Link Evidence"]})})]})]})]})]})]})}function Xa({claimAdjustmentId:o,onLinked:n}){const[j,v]=c.useState(!1),[M,R]=c.useState(""),[L,F]=c.useState(!1),[E,te]=c.useState([]),[k,ue]=c.useState([]),[K,pe]=c.useState(null),[V,t]=c.useState(!1),[D,H]=c.useState(null),[u,I]=c.useState("claim_maker"),[ne,ae]=c.useState(0),[le,re]=c.useState(""),[ge,fe]=c.useState(!1);c.useEffect(()=>{j&&oe()},[j]);const oe=async()=>{try{t(!0);const p=await fetch(`/api/claims/get-claim-entities/${o}`,{credentials:"include"});if(!p.ok)throw new Error("Failed to load linked entities");const W=await p.json();W.success&&(ue(W.entities||[]),pe(W.grouped_by_role||null))}catch(p){console.error("Error loading linked entities:",p)}finally{t(!1)}},ie=async()=>{try{F(!0);const p=new URLSearchParams({q:M,limit:"20",claim_id:o}),W=await fetch(`/api/claims/search-actors?${p}`,{credentials:"include"});if(!W.ok)throw new Error("Failed to search actors");const w=await W.json();w.success&&te(w.actors||[])}catch(p){console.error("Error searching actors:",p)}finally{F(!1)}},je=async()=>{if(D)try{fe(!0);const p=await fetch("/api/claims/link-entity",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({claim_adjustment_id:o,entity_id:D.id,entity_name:D.name,entity_type:D.type||"other",role:u,context:le||void 0,credibility_impact:ne})});if(!p.ok){const W=await p.json();throw new Error(W.error||"Failed to link entity")}H(null),re(""),ae(0),I("claim_maker"),await oe(),M&&await ie(),n?.()}catch(p){console.error("Error linking entity:",p),alert(p instanceof Error?p.message:"Failed to link entity")}finally{fe(!1)}},ye=async p=>{if(confirm("Remove this entity mention?"))try{if(!(await fetch(`/api/claims/remove-entity-mention/${p}`,{method:"DELETE",credentials:"include"})).ok)throw new Error("Failed to remove mention");await oe(),M&&await ie(),n?.()}catch(W){console.error("Error removing mention:",W),alert("Failed to remove entity mention")}},be=p=>{switch(p){case"claim_maker":return"bg-purple-100 text-purple-700 dark:bg-purple-900/20 dark:text-purple-400";case"subject":return"bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-400";case"mentioned":return"bg-gray-100 text-gray-700 dark:bg-gray-900/20 dark:text-gray-400";case"affected":return"bg-orange-100 text-orange-700 dark:bg-orange-900/20 dark:text-orange-400";default:return"bg-gray-100 text-gray-700 dark:bg-gray-900/20 dark:text-gray-400"}},ce=p=>{switch(p){case"claim_maker":return e.jsx(Bs,{className:"h-3 w-3"});case"subject":return e.jsx(Be,{className:"h-3 w-3"});case"mentioned":return e.jsx(wt,{className:"h-3 w-3"});case"affected":return e.jsx(kt,{className:"h-3 w-3"});default:return null}},h=p=>p>10?e.jsx(Ys,{className:"h-3 w-3 text-green-600"}):p<-10?e.jsx(Sa,{className:"h-3 w-3 text-red-600"}):e.jsx(Ea,{className:"h-3 w-3 text-gray-600"}),G=p=>p>10?"text-green-700 dark:text-green-400":p<-10?"text-red-700 dark:text-red-400":"text-gray-700 dark:text-gray-400",Ne=k.length;return e.jsxs(ps,{open:j,onOpenChange:v,children:[e.jsx(At,{asChild:!0,children:e.jsxs(d,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(Be,{className:"h-4 w-4"}),"Link Entities (",Ne,")"]})}),e.jsxs(gs,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(fs,{children:[e.jsx(js,{children:"Link Entities to Claim"}),e.jsx(Ts,{children:"Track who made the claim, who/what it's about, and assess credibility impact"})]}),e.jsxs("div",{className:"space-y-6",children:[V?e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(q,{className:"h-4 w-4 animate-spin"}),"Loading linked entities..."]}):k.length>0?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-semibold text-sm",children:["Linked Entities (",Ne,")"]}),K&&Object.entries(K).map(([p,W])=>W.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(z,{className:be(p),children:[ce(p),e.jsx("span",{className:"ml-1",children:p.replace("_"," ").toUpperCase()})]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",W.length,")"]})]}),e.jsx("div",{className:"space-y-2 ml-4",children:W.map(w=>e.jsx(f,{className:"p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:w.entity_name}),e.jsx(z,{variant:"outline",className:"text-xs",children:w.entity_type})]}),e.jsx("div",{className:"flex items-center gap-3 text-xs",children:e.jsxs("span",{className:`flex items-center gap-1 ${G(w.credibility_impact)}`,children:[h(w.credibility_impact),"Impact: ",w.credibility_impact>0?"+":"",w.credibility_impact]})}),w.context&&e.jsx("p",{className:"text-xs text-muted-foreground italic",children:w.context})]}),e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>ye(w.id),children:e.jsx(Rt,{className:"h-3 w-3"})})]})},w.id))})]},p))]}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No entities linked yet"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-semibold text-sm",children:"Add Entity"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(We,{placeholder:"Search actors in your library...",value:M,onChange:p=>R(p.target.value),onKeyDown:p=>p.key==="Enter"&&ie()}),e.jsx(d,{onClick:ie,disabled:L,children:L?e.jsx(q,{className:"h-4 w-4 animate-spin"}):e.jsx(Ae,{className:"h-4 w-4"})})]}),E.length>0&&e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:E.map(p=>e.jsx(f,{className:`p-3 cursor-pointer transition-colors ${D?.id===p.id?"ring-2 ring-primary":"hover:bg-accent"}`,onClick:()=>H(p),children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Bs,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:p.name})]}),p.description&&e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-1 ml-6",children:p.description}),e.jsxs("div",{className:"flex items-center gap-2 ml-6",children:[e.jsx(z,{variant:"outline",className:"text-xs",children:p.type}),p.credibility_rating&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Credibility: ",p.credibility_rating,"/100"]}),p.bias_rating&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Bias: ",p.bias_rating]})]})]})},p.id))}),D&&e.jsxs("div",{className:"space-y-4 p-4 bg-accent rounded-lg",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Entity Role in Claim"}),e.jsxs($t,{value:u,onValueChange:p=>I(p),children:[e.jsx(Tt,{children:e.jsx(zt,{})}),e.jsxs(Lt,{children:[e.jsx(Qe,{value:"claim_maker",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Bs,{className:"h-4 w-4"}),"Claim Maker - Who made this statement"]})}),e.jsx(Qe,{value:"subject",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Be,{className:"h-4 w-4"}),"Subject - Who/what the claim is about"]})}),e.jsx(Qe,{value:"mentioned",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(wt,{className:"h-4 w-4"}),"Mentioned - Referenced in the claim"]})}),e.jsx(Qe,{value:"affected",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(kt,{className:"h-4 w-4"}),"Affected - Impacted by the claim"]})})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium",children:["Credibility Impact: ",ne>0?"+":"",ne]}),e.jsx(ve,{value:[ne],onValueChange:p=>ae(p[0]),min:-50,max:50,step:5}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:"Decreases (-50)"}),e.jsx("span",{children:"Neutral (0)"}),e.jsx("span",{children:"Increases (+50)"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"How does this entity's involvement affect claim credibility?"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Context (optional)"}),e.jsx(he,{value:le,onChange:p=>re(p.target.value),placeholder:"Additional context about this entity's role...",rows:2})]}),e.jsx(d,{onClick:je,disabled:ge,className:"w-full",children:ge?e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"h-4 w-4 mr-2 animate-spin"}),"Linking..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Be,{className:"h-4 w-4 mr-2"}),"Link Entity"]})})]})]})]})]})]})}function Za({contentAnalysisId:o,claimAnalysis:n}){const{toast:j}=It();if(!n||!n.claims||n.claims.length===0)return null;const[v,M]=c.useState(n),{claims:R,summary:L}=v,F=R.some(l=>l.deception_analysis.risk_score===null||l.deception_analysis.methods.internal_consistency.score===null),[E,te]=c.useState(null),[k,ue]=c.useState({}),[K,pe]=c.useState(50),[V,t]=c.useState(""),[D,H]=c.useState(""),[u,I]=c.useState({internal_consistency:{score:50,reasoning:""},source_credibility:{score:50,reasoning:""},evidence_quality:{score:50,reasoning:""},logical_coherence:{score:50,reasoning:""},temporal_consistency:{score:50,reasoning:""},specificity:{score:50,reasoning:""}}),[ne,ae]=c.useState(!0),[le,re]=c.useState(!1),[ge,fe]=c.useState(null),[oe,ie]=c.useState(!1),[je,ye]=c.useState({}),[be,ce]=c.useState({}),[h,G]=c.useState({});c.useEffect(()=>{(async()=>{try{ae(!0),fe(null);const x=await fetch(`/api/claims/get-adjustments/${o}`,{credentials:"include"});if(!x.ok){if(x.status===404){console.log("No saved adjustments found for this content"),ae(!1);return}throw new Error(`Failed to load adjustments: ${x.statusText}`)}const C=x.headers.get("content-type");if(!C||!C.includes("application/json")){console.warn("Non-JSON response received for claim adjustments"),ae(!1);return}const A=await x.json();if(A.success&&A.adjustments){const Q={};A.adjustments.forEach(_=>{Q[_.claim_index]={id:_.id,adjustedRiskScore:_.adjusted_risk_score,userComment:_.user_comment||"",adjustedAt:_.updated_at}}),ue(Q)}}catch(x){console.error("Error loading claim adjustments:",x),fe(x instanceof Error?x.message:"Unknown error")}finally{ae(!1)}})()},[o]);const Ne=(l,x)=>{te(l);const C=R[l],A=k[l];pe(A?.adjustedRiskScore??x),t(A?.userComment??""),H(C.claim),I({internal_consistency:{score:C.deception_analysis.methods.internal_consistency.score??50,reasoning:C.deception_analysis.methods.internal_consistency.reasoning??""},source_credibility:{score:C.deception_analysis.methods.source_credibility.score??50,reasoning:C.deception_analysis.methods.source_credibility.reasoning??""},evidence_quality:{score:C.deception_analysis.methods.evidence_quality.score??50,reasoning:C.deception_analysis.methods.evidence_quality.reasoning??""},logical_coherence:{score:C.deception_analysis.methods.logical_coherence.score??50,reasoning:C.deception_analysis.methods.logical_coherence.reasoning??""},temporal_consistency:{score:C.deception_analysis.methods.temporal_consistency.score??50,reasoning:C.deception_analysis.methods.temporal_consistency.reasoning??""},specificity:{score:C.deception_analysis.methods.specificity.score??50,reasoning:C.deception_analysis.methods.specificity.reasoning??""}})},p=()=>{te(null),pe(50),t(""),H(""),I({internal_consistency:{score:50,reasoning:""},source_credibility:{score:50,reasoning:""},evidence_quality:{score:50,reasoning:""},logical_coherence:{score:50,reasoning:""},temporal_consistency:{score:50,reasoning:""},specificity:{score:50,reasoning:""}})},W=async l=>{try{re(!0);const x=R[l],C={content_analysis_id:o,claim_index:l,claim_text:x.claim,claim_category:x.category,original_risk_score:x.deception_analysis.risk_score,original_overall_risk:x.deception_analysis.overall_risk,original_methods:x.deception_analysis.methods,adjusted_risk_score:K,adjusted_claim_text:D!==x.claim?D:null,adjusted_methods:u,user_comment:V,verification_status:"pending"},A=await fetch("/api/claims/save-adjustment",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(C)});if(!A.ok)throw new Error(`Failed to save adjustment: ${A.statusText}`);const Q=await A.json();Q.success&&(ue({...k,[l]:{id:Q.id,adjustedRiskScore:K,userComment:V,adjustedClaimText:D,adjustedMethods:u,adjustedAt:new Date().toISOString()}}),te(null),pe(50),t(""),H(""),I({internal_consistency:{score:50,reasoning:""},source_credibility:{score:50,reasoning:""},evidence_quality:{score:50,reasoning:""},logical_coherence:{score:50,reasoning:""},temporal_consistency:{score:50,reasoning:""},specificity:{score:50,reasoning:""}}))}catch(x){console.error("Error saving adjustment:",x),alert("Failed to save adjustment. Please try again.")}finally{re(!1)}},w=(l,x)=>k[l]?.adjustedRiskScore??x,Is=l=>{switch(l){case"low":return"text-green-700 bg-green-100 dark:text-green-400 dark:bg-green-900/20";case"medium":return"text-yellow-700 bg-yellow-100 dark:text-yellow-400 dark:bg-yellow-900/20";case"high":return"text-red-700 bg-red-100 dark:text-red-400 dark:bg-red-900/20"}},Rs=l=>{switch(l){case"low":return e.jsx(zs,{className:"h-4 w-4"});case"medium":return e.jsx(De,{className:"h-4 w-4"});case"high":return e.jsx(ts,{className:"h-4 w-4"})}},ys=l=>{switch(l){case"statement":return e.jsx(we,{className:"h-4 w-4"});case"quote":return e.jsx(La,{className:"h-4 w-4"});case"statistic":return e.jsx(Ot,{className:"h-4 w-4"});case"event":return e.jsx(za,{className:"h-4 w-4"});case"relationship":return e.jsx(Ta,{className:"h-4 w-4"});default:return e.jsx(Ge,{className:"h-4 w-4"})}},ze=l=>{switch(l){case"statement":return"bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-400";case"quote":return"bg-purple-100 text-purple-700 dark:bg-purple-900/20 dark:text-purple-400";case"statistic":return"bg-orange-100 text-orange-700 dark:bg-orange-900/20 dark:text-orange-400";case"event":return"bg-teal-100 text-teal-700 dark:bg-teal-900/20 dark:text-teal-400";case"relationship":return"bg-pink-100 text-pink-700 dark:bg-pink-900/20 dark:text-pink-400";default:return"bg-gray-100 text-gray-700 dark:bg-gray-900/20 dark:text-gray-400"}},ke=l=>l==null?"text-gray-600 dark:text-gray-400":l>=80?"text-green-600 dark:text-green-400":l>=60?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400",Fs=async l=>{try{const x=await fetch(`/api/claims/export-markdown/${l}`,{credentials:"include"});if(!x.ok)throw new Error("Failed to export claim");const C=await x.blob(),A=window.URL.createObjectURL(C),Q=document.createElement("a");Q.href=A,Q.download=`claim-${l.substring(0,8)}-${Date.now()}.md`,document.body.appendChild(Q),Q.click(),window.URL.revokeObjectURL(A),document.body.removeChild(Q)}catch(x){console.error("Error exporting claim:",x),alert("Failed to export claim to Markdown")}},bs=async()=>{try{ie(!0);const l=await fetch(`/api/claims/retry-analysis/${o}`,{method:"POST",credentials:"include"});if(!l.ok){const C=await l.json();throw new Error(C.error||"Failed to retry analysis")}const x=await l.json();x.success&&x.claim_analysis&&(M(x.claim_analysis),j({title:"Analysis Complete",description:"AI claim analysis has been successfully re-run",variant:"default"}))}catch(l){console.error("Error retrying analysis:",l),j({title:"Retry Failed",description:l instanceof Error?l.message:"Failed to retry AI analysis",variant:"destructive"})}finally{ie(!1)}},Ns=async l=>{try{ye({...je,[l]:!0});const x=await fetch(`/api/claims/share/${l}`,{method:"POST",credentials:"include"});if(!x.ok){const A=await x.json();throw new Error(A.error||"Failed to create share link")}const C=await x.json();C.success&&C.share_url&&(ce({...be,[l]:C.share_url}),j({title:"Share Link Created",description:"Public link has been generated for this claim",variant:"default"}))}catch(x){console.error("Error sharing claim:",x),j({title:"Share Failed",description:x instanceof Error?x.message:"Failed to create share link",variant:"destructive"})}finally{ye({...je,[l]:!1})}},vs=async(l,x)=>{try{await navigator.clipboard.writeText(x),G({...h,[l]:!0}),j({title:"Link Copied",description:"Share link has been copied to clipboard",variant:"default"}),setTimeout(()=>{G({...h,[l]:!1})},2e3)}catch(C){console.error("Error copying to clipboard:",C),j({title:"Copy Failed",description:"Failed to copy link to clipboard",variant:"destructive"})}},Le=(l,x)=>{localStorage.setItem("ach_hypothesis_from_claim",JSON.stringify({hypothesis:l,source:"Claims Analysis",contentAnalysisId:o,claimIndex:x,timestamp:new Date().toISOString()})),j({title:"Hypothesis Set",description:"Navigate to ACH Analysis to use this claim as a hypothesis",variant:"default"}),window.location.href="/dashboard/frameworks/ach"},Os=(l,x)=>{localStorage.setItem("research_plan_from_claim",JSON.stringify({question:l,source:"Claims Analysis",contentAnalysisId:o,claimIndex:x,timestamp:new Date().toISOString()})),j({title:"Research Plan Started",description:"Navigate to Research Question Generator to develop a plan for this claim",variant:"default"}),window.location.href="/dashboard/tools/research-questions"},_e=async(l,x)=>{j({title:"Deep Analysis",description:"Deep deception analysis feature coming soon. This will perform enhanced multi-method analysis on this specific claim.",variant:"default"})};return e.jsxs("div",{className:"space-y-6",children:[ne&&e.jsxs(ms,{children:[e.jsx(q,{className:"h-4 w-4 animate-spin"}),e.jsx(xs,{children:"Loading saved adjustments..."})]}),ge&&e.jsxs(ms,{variant:"destructive",children:[e.jsx(De,{className:"h-4 w-4"}),e.jsxs(xs,{children:["Failed to load saved adjustments: ",ge]})]}),F&&e.jsxs(ms,{variant:"destructive",className:"border-2",children:[e.jsx(De,{className:"h-5 w-5"}),e.jsxs(xs,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold mb-1",children:"AI Analysis Failed"}),e.jsx("p",{className:"text-sm",children:"Automated claim analysis could not be completed. You can retry the analysis or manually assess each claim below."})]}),e.jsx(d,{onClick:bs,disabled:oe,className:"ml-4 shrink-0",variant:"outline",children:oe?e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"h-4 w-4 mr-2 animate-spin"}),"Retrying..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Aa,{className:"h-4 w-4 mr-2"}),"Retry AI Analysis"]})})]})]}),e.jsxs(f,{className:"border-2",children:[e.jsx(Y,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(se,{className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-5 w-5"}),"Claim Analysis Summary"]}),e.jsxs(pa,{children:[L.total_claims," objective claims extracted and analyzed"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold",children:L.overall_content_credibility!==null&&L.overall_content_credibility!==void 0?L.overall_content_credibility:e.jsx("span",{className:"text-gray-400",children:"N/A"})}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Overall Credibility"})]})]})}),e.jsxs(X,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-green-50 dark:bg-green-900/10",children:[e.jsx(zs,{className:"h-8 w-8 text-green-600 dark:text-green-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-green-700 dark:text-green-400",children:L.low_risk_claims}),e.jsx("div",{className:"text-sm text-green-600 dark:text-green-500",children:"Low Risk Claims"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-yellow-50 dark:bg-yellow-900/10",children:[e.jsx(De,{className:"h-8 w-8 text-yellow-600 dark:text-yellow-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-700 dark:text-yellow-400",children:L.medium_risk_claims}),e.jsx("div",{className:"text-sm text-yellow-600 dark:text-yellow-500",children:"Medium Risk Claims"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-red-50 dark:bg-red-900/10",children:[e.jsx(ts,{className:"h-8 w-8 text-red-600 dark:text-red-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-red-700 dark:text-red-400",children:L.high_risk_claims}),e.jsx("div",{className:"text-sm text-red-600 dark:text-red-500",children:"High Risk Claims"})]})]})]}),L.most_concerning_claim&&L.high_risk_claims>0&&e.jsxs(ms,{className:"mt-4 border-red-200 dark:border-red-800",children:[e.jsx(De,{className:"h-4 w-4 text-red-600"}),e.jsxs(xs,{children:[e.jsx("strong",{children:"Most Concerning Claim:"})," ",L.most_concerning_claim]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Extracted Claims (",R.length,")"]}),R.map((l,x)=>{const C=w(x,l.deception_analysis.risk_score),A=k[x]!==void 0,Q=E===x;return e.jsxs(f,{className:"border-l-4",style:{borderLeftColor:l.deception_analysis.overall_risk==="low"?"#10b981":l.deception_analysis.overall_risk==="medium"?"#f59e0b":"#ef4444"},children:[e.jsxs(Y,{children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 flex-wrap",children:[e.jsxs(z,{className:ze(l.category),children:[ys(l.category),e.jsx("span",{className:"ml-1",children:l.category.toUpperCase()})]}),e.jsxs(z,{className:Is(l.deception_analysis.overall_risk),children:[Rs(l.deception_analysis.overall_risk),e.jsxs("span",{className:"ml-1",children:[l.deception_analysis.overall_risk.toUpperCase()," RISK"]})]}),A&&e.jsxs(z,{variant:"default",className:"bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-400",children:[e.jsx(Gs,{className:"h-3 w-3 mr-1"}),"User Adjusted"]}),l.source&&e.jsxs(z,{variant:"outline",children:["Source: ",l.source]})]}),e.jsx("p",{className:"text-base font-medium leading-relaxed",children:l.claim})]}),e.jsxs("div",{className:"text-center min-w-[80px]",children:[e.jsxs("div",{className:`text-3xl font-bold ${C!==null?ke(100-C):"text-gray-400"}`,children:[C!==null?C:"N/A",A&&C!==l.deception_analysis.risk_score&&l.deception_analysis.risk_score!==null&&e.jsx("span",{className:"text-xs block text-gray-500 line-through",children:l.deception_analysis.risk_score})]}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Risk Score"}),!Q&&e.jsxs(d,{size:"sm",variant:"ghost",className:"mt-2 h-7 text-xs",onClick:()=>Ne(x,C),children:[e.jsx(Gs,{className:"h-3 w-3 mr-1"}),A?"Edit":"Adjust"]})]})]}),Q&&e.jsxs("div",{className:"mt-4 p-4 bg-blue-50 dark:bg-blue-900/10 rounded-lg space-y-4",children:[e.jsxs(Nt,{defaultValue:"overall",className:"w-full",children:[e.jsxs(vt,{className:"grid w-full grid-cols-3",children:[e.jsx(ls,{value:"overall",children:"Overall"}),e.jsx(ls,{value:"claim",children:"Claim Text"}),e.jsx(ls,{value:"methods",children:"Method Scores"})]}),e.jsxs(os,{value:"overall",className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium",children:["Adjust Risk Score: ",K]}),e.jsx(ve,{value:[K],onValueChange:_=>pe(_[0]),min:0,max:100,step:1,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 dark:text-gray-400",children:[e.jsx("span",{children:"Low Risk (0)"}),e.jsx("span",{children:"Medium Risk (50)"}),e.jsx("span",{children:"High Risk (100)"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(us,{className:"h-4 w-4"}),"Your Assessment Comments"]}),e.jsx(he,{value:V,onChange:_=>t(_.target.value),placeholder:"Explain your assessment... (optional)",rows:3,className:"w-full"})]})]}),e.jsx(os,{value:"claim",className:"space-y-4 mt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Gs,{className:"h-4 w-4"}),"Edit Claim Wording"]}),e.jsx(he,{value:D,onChange:_=>H(_.target.value),placeholder:"Edit the claim text...",rows:4,className:"w-full font-medium"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Refine the claim wording to be more precise or correct any errors."})]})}),e.jsxs(os,{value:"methods",className:"space-y-6 mt-4 max-h-96 overflow-y-auto",children:[e.jsxs("div",{className:"space-y-2 pb-4 border-b",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Js,{className:"h-4 w-4"}),"Internal Consistency"]}),e.jsx("span",{className:"text-sm font-bold",children:u.internal_consistency.score})]}),e.jsx(ve,{value:[u.internal_consistency.score],onValueChange:_=>I({...u,internal_consistency:{...u.internal_consistency,score:_[0]}}),min:0,max:100,step:1,className:"w-full"}),e.jsx(he,{value:u.internal_consistency.reasoning,onChange:_=>I({...u,internal_consistency:{...u.internal_consistency,reasoning:_.target.value}}),placeholder:"Reasoning...",rows:2,className:"text-xs"})]}),e.jsxs("div",{className:"space-y-2 pb-4 border-b",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx($e,{className:"h-4 w-4"}),"Source Credibility"]}),e.jsx("span",{className:"text-sm font-bold",children:u.source_credibility.score})]}),e.jsx(ve,{value:[u.source_credibility.score],onValueChange:_=>I({...u,source_credibility:{...u.source_credibility,score:_[0]}}),min:0,max:100,step:1,className:"w-full"}),e.jsx(he,{value:u.source_credibility.reasoning,onChange:_=>I({...u,source_credibility:{...u.source_credibility,reasoning:_.target.value}}),placeholder:"Reasoning...",rows:2,className:"text-xs"})]}),e.jsxs("div",{className:"space-y-2 pb-4 border-b",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(we,{className:"h-4 w-4"}),"Evidence Quality"]}),e.jsx("span",{className:"text-sm font-bold",children:u.evidence_quality.score})]}),e.jsx(ve,{value:[u.evidence_quality.score],onValueChange:_=>I({...u,evidence_quality:{...u.evidence_quality,score:_[0]}}),min:0,max:100,step:1,className:"w-full"}),e.jsx(he,{value:u.evidence_quality.reasoning,onChange:_=>I({...u,evidence_quality:{...u.evidence_quality,reasoning:_.target.value}}),placeholder:"Reasoning...",rows:2,className:"text-xs"})]}),e.jsxs("div",{className:"space-y-2 pb-4 border-b",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ys,{className:"h-4 w-4"}),"Logical Coherence"]}),e.jsx("span",{className:"text-sm font-bold",children:u.logical_coherence.score})]}),e.jsx(ve,{value:[u.logical_coherence.score],onValueChange:_=>I({...u,logical_coherence:{...u.logical_coherence,score:_[0]}}),min:0,max:100,step:1,className:"w-full"}),e.jsx(he,{value:u.logical_coherence.reasoning,onChange:_=>I({...u,logical_coherence:{...u.logical_coherence,reasoning:_.target.value}}),placeholder:"Reasoning...",rows:2,className:"text-xs"})]}),e.jsxs("div",{className:"space-y-2 pb-4 border-b",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ls,{className:"h-4 w-4"}),"Temporal Consistency"]}),e.jsx("span",{className:"text-sm font-bold",children:u.temporal_consistency.score})]}),e.jsx(ve,{value:[u.temporal_consistency.score],onValueChange:_=>I({...u,temporal_consistency:{...u.temporal_consistency,score:_[0]}}),min:0,max:100,step:1,className:"w-full"}),e.jsx(he,{value:u.temporal_consistency.reasoning,onChange:_=>I({...u,temporal_consistency:{...u.temporal_consistency,reasoning:_.target.value}}),placeholder:"Reasoning...",rows:2,className:"text-xs"})]}),e.jsxs("div",{className:"space-y-2 pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ge,{className:"h-4 w-4"}),"Specificity"]}),e.jsx("span",{className:"text-sm font-bold",children:u.specificity.score})]}),e.jsx(ve,{value:[u.specificity.score],onValueChange:_=>I({...u,specificity:{...u.specificity,score:_[0]}}),min:0,max:100,step:1,className:"w-full"}),e.jsx(he,{value:u.specificity.reasoning,onChange:_=>I({...u,specificity:{...u.specificity,reasoning:_.target.value}}),placeholder:"Reasoning...",rows:2,className:"text-xs"})]})]})]}),e.jsxs("div",{className:"flex gap-2 pt-2 border-t",children:[e.jsx(d,{size:"sm",onClick:()=>W(x),className:"flex-1",disabled:le,children:le?e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"h-4 w-4 mr-2 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ve,{className:"h-4 w-4 mr-2"}),"Save All Changes"]})}),e.jsxs(d,{size:"sm",variant:"outline",onClick:p,disabled:le,children:[e.jsx($a,{className:"h-4 w-4 mr-2"}),"Cancel"]})]})]}),!Q&&A&&k[x].userComment&&e.jsx("div",{className:"mt-4 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(us,{className:"h-4 w-4 mt-0.5 text-blue-600 dark:text-blue-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-blue-700 dark:text-blue-400 mb-1",children:"Your Assessment:"}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:k[x].userComment}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Adjusted ",new Date(k[x].adjustedAt).toLocaleString()]})]})]})}),A&&k[x].id&&e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(Ya,{claimAdjustmentId:k[x].id}),e.jsx(Xa,{claimAdjustmentId:k[x].id}),e.jsxs(d,{variant:"outline",size:"sm",className:"gap-2",onClick:()=>Fs(k[x].id),children:[e.jsx(Xs,{className:"h-4 w-4"}),"Export to Markdown"]}),e.jsx(d,{variant:"outline",size:"sm",className:"gap-2",onClick:()=>Ns(k[x].id),disabled:je[k[x].id],children:je[k[x].id]?e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"h-4 w-4 animate-spin"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ft,{className:"h-4 w-4"}),"Share Claim"]})})]}),be[k[x].id]&&e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-blue-50 dark:bg-blue-900/20 rounded",children:[e.jsx(We,{value:be[k[x].id],readOnly:!0,className:"flex-1 text-sm font-mono"}),e.jsx(d,{size:"sm",variant:"ghost",onClick:()=>vs(k[x].id,be[k[x].id]),children:h[k[x].id]?e.jsxs(e.Fragment,{children:[e.jsx(ss,{className:"h-4 w-4 mr-1"}),"Copied!"]}):e.jsxs(e.Fragment,{children:[e.jsx(Se,{className:"h-4 w-4 mr-1"}),"Copy Link"]})})]})]})]}),e.jsxs(X,{children:[e.jsxs(Nt,{defaultValue:"methods",className:"w-full",children:[e.jsxs(vt,{className:"grid w-full grid-cols-2",children:[e.jsx(ls,{value:"methods",children:"Detection Methods"}),e.jsx(ls,{value:"assessment",children:"Assessment"})]}),e.jsxs(os,{value:"methods",className:"space-y-3 mt-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"font-medium flex items-center gap-2",children:[e.jsx(Js,{className:"h-4 w-4"}),"Internal Consistency"]}),e.jsx("span",{className:`font-bold ${l.deception_analysis.methods.internal_consistency.score!==null?ke(l.deception_analysis.methods.internal_consistency.score):"text-gray-400"}`,children:l.deception_analysis.methods.internal_consistency.score??"N/A"})]}),l.deception_analysis.methods.internal_consistency.score!==null?e.jsx(Z,{value:l.deception_analysis.methods.internal_consistency.score,className:"h-2"}):e.jsx("div",{className:"h-2 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:l.deception_analysis.methods.internal_consistency.reasoning})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"font-medium flex items-center gap-2",children:[e.jsx($e,{className:"h-4 w-4"}),"Source Credibility"]}),e.jsx("span",{className:`font-bold ${l.deception_analysis.methods.source_credibility.score!==null?ke(l.deception_analysis.methods.source_credibility.score):"text-gray-400"}`,children:l.deception_analysis.methods.source_credibility.score??"N/A"})]}),l.deception_analysis.methods.source_credibility.score!==null?e.jsx(Z,{value:l.deception_analysis.methods.source_credibility.score,className:"h-2"}):e.jsx("div",{className:"h-2 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:l.deception_analysis.methods.source_credibility.reasoning})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"font-medium flex items-center gap-2",children:[e.jsx(we,{className:"h-4 w-4"}),"Evidence Quality"]}),e.jsx("span",{className:`font-bold ${l.deception_analysis.methods.evidence_quality.score!==null?ke(l.deception_analysis.methods.evidence_quality.score):"text-gray-400"}`,children:l.deception_analysis.methods.evidence_quality.score??"N/A"})]}),l.deception_analysis.methods.evidence_quality.score!==null?e.jsx(Z,{value:l.deception_analysis.methods.evidence_quality.score,className:"h-2"}):e.jsx("div",{className:"h-2 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:l.deception_analysis.methods.evidence_quality.reasoning})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"font-medium flex items-center gap-2",children:[e.jsx(Ys,{className:"h-4 w-4"}),"Logical Coherence"]}),e.jsx("span",{className:`font-bold ${l.deception_analysis.methods.logical_coherence.score!==null?ke(l.deception_analysis.methods.logical_coherence.score):"text-gray-400"}`,children:l.deception_analysis.methods.logical_coherence.score??"N/A"})]}),l.deception_analysis.methods.logical_coherence.score!==null?e.jsx(Z,{value:l.deception_analysis.methods.logical_coherence.score,className:"h-2"}):e.jsx("div",{className:"h-2 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:l.deception_analysis.methods.logical_coherence.reasoning})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"font-medium flex items-center gap-2",children:[e.jsx(Ls,{className:"h-4 w-4"}),"Temporal Consistency"]}),e.jsx("span",{className:`font-bold ${l.deception_analysis.methods.temporal_consistency.score!==null?ke(l.deception_analysis.methods.temporal_consistency.score):"text-gray-400"}`,children:l.deception_analysis.methods.temporal_consistency.score??"N/A"})]}),l.deception_analysis.methods.temporal_consistency.score!==null?e.jsx(Z,{value:l.deception_analysis.methods.temporal_consistency.score,className:"h-2"}):e.jsx("div",{className:"h-2 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:l.deception_analysis.methods.temporal_consistency.reasoning})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"font-medium flex items-center gap-2",children:[e.jsx(Ge,{className:"h-4 w-4"}),"Specificity"]}),e.jsx("span",{className:`font-bold ${l.deception_analysis.methods.specificity.score!==null?ke(l.deception_analysis.methods.specificity.score):"text-gray-400"}`,children:l.deception_analysis.methods.specificity.score??"N/A"})]}),l.deception_analysis.methods.specificity.score!==null?e.jsx(Z,{value:l.deception_analysis.methods.specificity.score,className:"h-2"}):e.jsx("div",{className:"h-2 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:l.deception_analysis.methods.specificity.reasoning})]})]}),e.jsxs(os,{value:"assessment",className:"space-y-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm mb-2",children:"Confidence Assessment"}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:l.deception_analysis.confidence_assessment})]}),l.deception_analysis.red_flags.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-sm mb-2 flex items-center gap-2 text-red-700 dark:text-red-400",children:[e.jsx(De,{className:"h-4 w-4"}),"Red Flags (",l.deception_analysis.red_flags.length,")"]}),e.jsx("ul",{className:"space-y-1",children:l.deception_analysis.red_flags.map((_,ws)=>e.jsxs("li",{className:"text-sm text-red-600 dark:text-red-400 flex items-start gap-2",children:[e.jsx(ts,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:_})]},ws))})]})]})]}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(Js,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"}),e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Further Analysis Options"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(d,{size:"sm",variant:"outline",onClick:()=>Le(l.claim,x),className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-4 w-4"}),"Use as ACH Hypothesis"]}),e.jsxs(d,{size:"sm",variant:"outline",onClick:()=>Os(l.claim,x),className:"flex items-center gap-2",children:[e.jsx(we,{className:"h-4 w-4"}),"Create Research Plan"]}),e.jsxs(d,{size:"sm",variant:"outline",onClick:()=>_e(l.claim),className:"flex items-center gap-2",children:[e.jsx(De,{className:"h-4 w-4"}),"Deep Deception Analysis"]})]})]})]})]},x)})]})]})}const er=({status:o})=>{if(!o||o==="ready")return null;switch(o){case"processing":return e.jsx(z,{variant:"secondary",className:"ml-auto bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300",children:e.jsx(q,{className:"h-3 w-3 animate-spin"})});case"complete":return e.jsx(z,{variant:"default",className:"ml-auto bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300",children:e.jsx(ss,{className:"h-3 w-3"})});case"error":return e.jsx(z,{variant:"destructive",className:"ml-auto",children:"Error"});case"idle":return e.jsx(z,{variant:"outline",className:"ml-auto text-xs",children:"Not Run"});default:return null}},Et=({activeTab:o,onTabChange:n,sections:j,onRunFramework:v,className:M})=>{const R=j.filter(E=>E.isAutomatic),L=j.filter(E=>!E.isAutomatic),F=E=>{const te=E.icon,k=o===E.id,ue=E.status==="idle"&&v&&!E.isAutomatic;return e.jsxs("div",{className:"relative",children:[e.jsx(d,{variant:k?"secondary":"ghost",className:Qs("w-full justify-start text-left h-auto py-3 px-3 group",k&&"bg-accent font-medium"),onClick:()=>n(E.id),children:e.jsxs("div",{className:"flex items-start gap-3 w-full",children:[e.jsx(te,{className:Qs("h-4 w-4 mt-0.5 shrink-0",k&&"text-primary")}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm truncate",children:E.label}),e.jsx(er,{status:E.status})]}),E.description&&e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5 line-clamp-2",children:E.description})]})]})}),ue&&e.jsx(d,{variant:"ghost",size:"sm",className:"absolute right-2 top-2 h-7 w-7 p-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:K=>{K.stopPropagation(),v(E.id)},title:`Run ${E.label} Analysis`,children:e.jsx(Pt,{className:"h-3 w-3"})})]},E.id)};return e.jsxs("div",{className:Qs("flex flex-col h-full border-r bg-muted/30",M),children:[e.jsx("div",{className:"p-4 border-b",children:e.jsx("h3",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide",children:"Analysis Sections"})}),e.jsx(ga,{className:"flex-1",children:e.jsxs("div",{className:"p-2 space-y-1",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"px-3 py-2 flex items-center gap-2",children:[e.jsx(Ee,{className:"h-3.5 w-3.5 text-muted-foreground"}),e.jsx("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Automatic"})]}),e.jsx("div",{className:"space-y-0.5",children:R.map(F)})]}),L.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Qa,{className:"my-2"}),e.jsxs("div",{children:[e.jsxs("div",{className:"px-3 py-2 flex items-center gap-2",children:[e.jsx(Te,{className:"h-3.5 w-3.5 text-muted-foreground"}),e.jsx("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Frameworks"})]}),e.jsx("div",{className:"space-y-0.5",children:L.map(F)})]})]})]})})]})},sr=({activeTab:o,onTabChange:n,sections:j,onRunFramework:v,children:M})=>{const[R,L]=c.useState(!1),F=j.find(te=>te.id===o),E=te=>{n(te),L(!1)};return e.jsxs("div",{className:"flex flex-col lg:flex-row h-full gap-4 lg:gap-0",children:[e.jsx("div",{className:"lg:hidden border-b pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-lg font-semibold",children:F?.label||"Analysis"}),F?.description&&e.jsx("p",{className:"text-sm text-muted-foreground",children:F.description})]}),e.jsx(d,{variant:"outline",size:"icon",className:"shrink-0",onClick:()=>L(!0),children:e.jsx(Ia,{className:"h-5 w-5"})})]})}),e.jsx(ps,{open:R,onOpenChange:L,children:e.jsxs(gs,{className:"w-[90vw] max-w-sm h-[80vh] p-0",children:[e.jsx(fs,{className:"p-4 border-b",children:e.jsx(js,{children:"Analysis Sections"})}),e.jsx("div",{className:"overflow-y-auto",children:e.jsx(Et,{activeTab:o,onTabChange:E,sections:j,onRunFramework:v,className:"border-none"})})]})}),e.jsx("div",{className:"hidden lg:block lg:w-64 xl:w-72 shrink-0",children:e.jsx(Et,{activeTab:o,onTabChange:n,sections:j,onRunFramework:v})}),e.jsx("div",{className:"flex-1 min-w-0 lg:overflow-auto",children:M})]})},ee=ya("ContentIntelligence");function jr(){const{t:o}=fa(),{toast:n}=It(),j=ha(),[v,M]=c.useState(""),[R,L]=c.useState("normal"),[F,E]=c.useState(!1),[te,k]=c.useState("idle"),[ue,K]=c.useState(0),[pe,V]=c.useState(""),[t,D]=c.useState(null),[H,u]=c.useState("overview"),[I,ne]=c.useState({}),[ae,le]=c.useState(""),[re,ge]=c.useState(""),[fe,oe]=c.useState([]),[ie,je]=c.useState(!1),[ye,be]=c.useState(""),[ce,h]=c.useState([]),[G,Ne]=c.useState(!1),[p,W]=c.useState(!1),[w,Is]=c.useState(null),[Rs,ys]=c.useState(!1),[ze,ke]=c.useState(""),[Fs,bs]=c.useState(!1),[Ns,vs]=c.useState(!1),[Le,Os]=c.useState(null),[_e,l]=c.useState("all"),[x,C]=c.useState("references"),[A,Q]=c.useState(null),[_,ws]=c.useState(!1),[g,Zs]=c.useState(null),[Je,et]=c.useState(!1),[N,st]=c.useState(null),[tt,at]=c.useState(!1),[tr,Mt]=c.useState({}),[ar,Ps]=c.useState(!1),[B,rt]=c.useState(null),[Ke,Ms]=c.useState("idle"),[Ut,it]=c.useState(null),[nt,lt]=c.useState(!1),[de,Us]=c.useState("words"),[as,qs]=c.useState("summary"),[Ie,ot]=c.useState(!1),[U,qt]=c.useState(null),[Ds,ct]=c.useState(!1),[Hs,Dt]=c.useState(null),[ks,Re]=c.useState(!1),[_s,Vs]=c.useState(null),[rr,Ht]=c.useState(!1),[Ye,dt]=c.useState(null),[mt,Vt]=c.useState({}),[me,xt]=c.useState(null),[Wt,Cs]=c.useState(!1),[Fe,ht]=c.useState(null),Qt=t?[{id:"overview",label:o("pages.contentIntelligence.sections.overview.label"),icon:we,description:o("pages.contentIntelligence.sections.overview.description"),isAutomatic:!0,status:"complete"},{id:"entities",label:o("pages.contentIntelligence.sections.entities.label"),icon:Be,description:o("pages.contentIntelligence.sections.entities.description"),isAutomatic:!0,status:"complete"},{id:"sentiment",label:o("pages.contentIntelligence.sections.sentiment.label"),icon:_t,description:o("pages.contentIntelligence.sections.sentiment.description"),isAutomatic:!0,status:t?.sentiment_analysis?"complete":"idle"},{id:"links",label:o("pages.contentIntelligence.sections.links.label"),icon:hs,description:o("pages.contentIntelligence.sections.links.description"),isAutomatic:!0,status:"complete"},{id:"word-analysis",label:o("pages.contentIntelligence.sections.wordAnalysis.label"),icon:Ot,description:o("pages.contentIntelligence.sections.wordAnalysis.description"),isAutomatic:!0,status:"complete"},{id:"claims",label:o("pages.contentIntelligence.sections.claims.label"),icon:$e,description:o("pages.contentIntelligence.sections.claims.description"),isAutomatic:!1,status:Ds?"processing":t?.claim_analysis||Hs?"complete":"idle"},{id:"dime",label:o("pages.contentIntelligence.sections.dime.label"),icon:Te,description:o("pages.contentIntelligence.sections.dime.description"),isAutomatic:!1,status:Ie?"processing":t?.dime_analysis||U?"complete":"idle"},{id:"starbursting",label:o("pages.contentIntelligence.sections.starbursting.label"),icon:He,description:o("pages.contentIntelligence.sections.starbursting.description"),isAutomatic:!1,status:Ke},{id:"qa",label:o("pages.contentIntelligence.sections.qa.label"),icon:us,description:o("pages.contentIntelligence.sections.qa.description"),isAutomatic:!1,status:"ready"}]:[],ut=s=>s?s.replace(/\s+/g," ").replace(/\. ([A-Z])/g,`.

$1`).replace(/\n{3,}/g,`

`).trim():"",Oe=s=>{t&&(dt(s),u("overview"),qs("fulltext"),setTimeout(()=>{const a=document.getElementById("full-text-content");a&&a.scrollIntoView({behavior:"smooth",block:"start"}),n({title:"Entity Highlighted",description:`All occurrences of "${s}" are now highlighted in yellow`})},100))},Bt=()=>{dt(null),n({title:"Highlighting Cleared",description:"Entity highlighting has been removed"})},Xe=async(s,a)=>{if(!t)return;const r=`${a}:${s}`;if(mt[r]){ht({entity:s,type:a,summary:mt[r]}),Cs(!0);return}xt(s);try{const i=await fetch("/api/content-intelligence/summarize-entity",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:t.extracted_text,entity_name:s,entity_type:a,content_title:t.title})});if(!i.ok)throw new Error("Failed to generate summary");const b=(await i.json()).summary;Vt(S=>({...S,[r]:b})),ht({entity:s,type:a,summary:b}),Cs(!0),n({title:"Summary Generated",description:`AI summary for "${s}" is ready`})}catch(i){console.error("Error summarizing entity:",i),n({title:"Error",description:"Failed to generate entity summary. Please try again.",variant:"destructive"})}finally{xt(null)}},Gt=(s,a)=>{if(!a||!Ye||Ye!==a)return s;const r=new RegExp(`(${a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return s.split(r).map((m,b)=>m.toLowerCase()===a.toLowerCase()?e.jsx("mark",{className:"bg-yellow-300 dark:bg-yellow-600 px-0.5 rounded",children:m},b):m)},Jt=()=>{if(!t)return;const s=window.open("","_blank");if(!s){n({title:"Error",description:"Please allow popups to export the report",variant:"destructive"});return}const a=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>${t.title||"Content Intelligence Report"}</title>
        <style>
          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; line-height: 1.6; max-width: 900px; margin: 0 auto; padding: 40px 20px; color: #333; }
          h1 { color: #1a1a1a; border-bottom: 3px solid #3b82f6; padding-bottom: 10px; margin-bottom: 30px; }
          h2 { color: #2563eb; margin-top: 40px; margin-bottom: 20px; border-bottom: 2px solid #ddd; padding-bottom: 8px; }
          h3 { color: #4b5563; margin-top: 30px; margin-bottom: 15px; }
          .metadata { background: #f3f4f6; padding: 20px; border-radius: 8px; margin-bottom: 30px; }
          .metadata p { margin: 8px 0; }
          .metadata strong { color: #1f2937; }
          .citation { background: #eff6ff; border-left: 4px solid #3b82f6; padding: 15px; margin: 20px 0; font-family: 'Georgia', serif; }
          .summary { background: #f9fafb; padding: 20px; border-radius: 8px; margin: 20px 0; }
          .qa-item { background: #ffffff; border: 1px solid #e5e7eb; padding: 15px; margin: 10px 0; border-radius: 6px; }
          .qa-question { font-weight: 600; color: #1f2937; margin-bottom: 8px; }
          .qa-answer { color: #4b5563; margin-left: 20px; }
          .entity-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 10px; margin: 15px 0; }
          .entity-item { background: #f3f4f6; padding: 10px; border-radius: 4px; }
          .stat-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0; }
          .stat-card { background: #fefce8; padding: 15px; border-radius: 8px; border-left: 4px solid #eab308; }
          .stat-label { font-size: 0.875rem; color: #78350f; font-weight: 500; }
          .stat-value { font-size: 1.875rem; font-weight: bold; color: #713f12; margin-top: 5px; }
          .link-button { background: #3b82f6; color: white; padding: 10px 20px; border-radius: 6px; text-decoration: none; display: inline-block; margin: 20px 0; }
          .link-button:hover { background: #2563eb; }
          @media print { .no-print { display: none; } }
          @page { margin: 2cm; }
        </style>
      </head>
      <body>
        <h1>Content Intelligence Report</h1>

        <!-- Metadata -->
        <div class="metadata">
          <p><strong>Title:</strong> ${t.title||"Untitled"}</p>
          <p><strong>URL:</strong> <a href="${t.url}" target="_blank">${t.url}</a></p>
          ${t.author?`<p><strong>Author:</strong> ${t.author}</p>`:""}
          ${t.publish_date?`<p><strong>Published:</strong> ${t.publish_date}</p>`:""}
          <p><strong>Domain:</strong> ${t.domain}</p>
          <p><strong>Analysis Date:</strong> ${new Date().toLocaleString()}</p>
          <p><strong>Word Count:</strong> ${t.word_count.toLocaleString()}</p>
          ${t.is_social_media?`<p><strong>Platform:</strong> ${t.social_platform?.toUpperCase()}</p>`:""}
        </div>

        <!-- Citation -->
        ${ze?`
          <h2>Citation (APA)</h2>
          <div class="citation">${ze}</div>
        `:""}

        <!-- Summary -->
        ${t.summary?`
          <h2>Summary</h2>
          <div class="summary">${t.summary}</div>
        `:""}

        <!-- Quick Stats -->
        <h2>Analysis Overview</h2>
        <div class="stat-grid">
          <div class="stat-card">
            <div class="stat-label">Total Words</div>
            <div class="stat-value">${t.word_count.toLocaleString()}</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Unique Words</div>
            <div class="stat-value">${Object.keys(t.word_frequency||{}).length.toLocaleString()}</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">People Identified</div>
            <div class="stat-value">${t.entities?.people?.length||0}</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Organizations</div>
            <div class="stat-value">${t.entities?.organizations?.length||0}</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Locations</div>
            <div class="stat-value">${t.entities?.locations?.length||0}</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Top Phrases</div>
            <div class="stat-value">${t.top_phrases?.length||0}</div>
          </div>
        </div>

        <!-- Entities -->
        ${t.entities?`
          <h2>Extracted Entities</h2>

          ${t.entities.people&&t.entities.people.length>0?`
            <h3>People (${t.entities.people.length})</h3>
            <div class="entity-list">
              ${t.entities.people.slice(0,20).map(r=>`<div class="entity-item">${r.name} ${r.count>1?`(${r.count})`:""}</div>`).join("")}
            </div>
          `:""}

          ${t.entities.organizations&&t.entities.organizations.length>0?`
            <h3>Organizations (${t.entities.organizations.length})</h3>
            <div class="entity-list">
              ${t.entities.organizations.slice(0,20).map(r=>`<div class="entity-item">${r.name} ${r.count>1?`(${r.count})`:""}</div>`).join("")}
            </div>
          `:""}

          ${t.entities.locations&&t.entities.locations.length>0?`
            <h3>Locations (${t.entities.locations.length})</h3>
            <div class="entity-list">
              ${t.entities.locations.slice(0,20).map(r=>`<div class="entity-item">${r.name} ${r.count>1?`(${r.count})`:""}</div>`).join("")}
            </div>
          `:""}

          ${t.entities.emails&&t.entities.emails.length>0?`
            <h3>Emails (${t.entities.emails.length})</h3>
            <div class="entity-list">
              ${t.entities.emails.slice(0,20).map(r=>`<div class="entity-item"><a href="mailto:${r.email}">${r.email}</a> ${r.count>1?`(${r.count})`:""}</div>`).join("")}
            </div>
          `:""}
        `:""}

        <!-- Q&A History -->
        ${ce&&ce.length>0?`
          <h2>Questions & Answers</h2>
          ${ce.map((r,i)=>`
            <div class="qa-item">
              <div class="qa-question">Q${i+1}: ${r.question}</div>
              <div class="qa-answer">A: ${r.answer}</div>
            </div>
          `).join("")}
        `:""}

        <!-- DIME Framework Analysis -->
        ${t.dime_analysis||U?`
          <h2>DIME Framework Analysis</h2>
          <p style="color: #6b7280; font-style: italic; margin-bottom: 20px;">
            Diplomatic, Information, Military, Economic strategic analysis framework
          </p>

          ${t.dime_analysis?.diplomatic||U?.diplomatic?`
            <h3 style="color: #2563eb;"> Diplomatic</h3>
            ${(t.dime_analysis?.diplomatic||U?.diplomatic).map((r,i)=>`
              <div class="qa-item">
                <div class="qa-question">Q${i+1}: ${r.question}</div>
                <div class="qa-answer">A: ${r.answer}</div>
              </div>
            `).join("")}
          `:""}

          ${t.dime_analysis?.information||U?.information?`
            <h3 style="color: #10b981;"> Information</h3>
            ${(t.dime_analysis?.information||U?.information).map((r,i)=>`
              <div class="qa-item">
                <div class="qa-question">Q${i+1}: ${r.question}</div>
                <div class="qa-answer">A: ${r.answer}</div>
              </div>
            `).join("")}
          `:""}

          ${t.dime_analysis?.military||U?.military?`
            <h3 style="color: #ef4444;"> Military</h3>
            ${(t.dime_analysis?.military||U?.military).map((r,i)=>`
              <div class="qa-item">
                <div class="qa-question">Q${i+1}: ${r.question}</div>
                <div class="qa-answer">A: ${r.answer}</div>
              </div>
            `).join("")}
          `:""}

          ${t.dime_analysis?.economic||U?.economic?`
            <h3 style="color: #f59e0b;"> Economic</h3>
            ${(t.dime_analysis?.economic||U?.economic).map((r,i)=>`
              <div class="qa-item">
                <div class="qa-question">Q${i+1}: ${r.question}</div>
                <div class="qa-answer">A: ${r.answer}</div>
              </div>
            `).join("")}
          `:""}

          ${t.dime_analysis?.summary||U?.summary?`
            <div class="summary" style="margin-top: 20px;">
              <strong>DIME Summary:</strong> ${t.dime_analysis?.summary||U?.summary}
            </div>
          `:""}
        `:""}

        <!-- Top Phrases -->
        ${t.top_phrases&&t.top_phrases.length>0?`
          <h2>Top Phrases</h2>
          <div class="entity-list">
            ${t.top_phrases.slice(0,20).map(r=>`<div class="entity-item">${r.phrase} (${r.count})</div>`).join("")}
          </div>
        `:""}

        <!-- Starbursting Link -->
        ${B&&Ke==="complete"?`
          <h2>Starbursting Analysis</h2>
          <p>A comprehensive 5W1H (Who, What, When, Where, Why, How) analysis has been generated for this content.</p>
          <a href="/dashboard/analysis-frameworks/starbursting/${B.session_id}/view" class="link-button no-print">
            View Starbursting Analysis 
          </a>
          <p class="no-print" style="font-size: 0.875rem; color: #6b7280; margin-top: 10px;">
            Direct link: ${window.location.origin}/dashboard/analysis-frameworks/starbursting/${B.session_id}/view
          </p>
        `:""}

        <!-- Print Instructions -->
        <div class="no-print" style="margin-top: 40px; padding: 20px; background: #f3f4f6; border-radius: 8px;">
          <p><strong>To save this report:</strong></p>
          <ul>
            <li>Press Ctrl+P (Windows) or Cmd+P (Mac) to print</li>
            <li>Select "Save as PDF" as the destination</li>
            <li>Click Save</li>
          </ul>
          <button onclick="window.print()" style="background: #3b82f6; color: white; padding: 10px 20px; border: none; border-radius: 6px; cursor: pointer; margin-top: 10px;">
            Print / Save as PDF
          </button>
        </div>

        <div style="margin-top: 60px; padding-top: 20px; border-top: 2px solid #e5e7eb; font-size: 0.75rem; color: #9ca3af; text-align: center;">
          Generated by Content Intelligence Tool  ${new Date().toLocaleString()}
        </div>
      </body>
      </html>
    `;s.document.write(a),s.document.close(),n({title:"Report Generated",description:"Report opened in new window. You can print or save as PDF."})},Kt=async()=>{if(t?.id)try{Re(!0);const s=await fetch("/api/content-intelligence/share",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({analysisId:t.id})});if(!s.ok)throw new Error("Failed to create share link");const a=await s.json();Vs(a.shareUrl),n({title:"Analysis Shared!",description:'Public link created successfully. Click "Copy Link" to share.'})}catch(s){console.error("Share error:",s),n({title:"Share Failed",description:s instanceof Error?s.message:"Failed to create share link",variant:"destructive"})}finally{Re(!1)}},pt=s=>{const a=document.createElement("textarea");return a.innerHTML=s,a.value},gt=s=>s.replace(/\*\*(.+?)\*\*/g,"$1").replace(/\*(.+?)\*/g,"$1").replace(/__(.+?)__/g,"$1").replace(/_(.+?)_/g,"$1").replace(/~~(.+?)~~/g,"$1").replace(/`(.+?)`/g,"$1").replace(/^#+\s+/gm,"").replace(/^\s*[-*+]\s+/gm,"").replace(/^\s*\d+\.\s+/gm,"").replace(/\[(.+?)\]\(.+?\)/g,"$1").replace(/\n{3,}/g,`

`).trim(),Yt=async()=>{if(t){Re(!0);try{const s=t.title||"Content Analysis",a=gt(pt(s)),r=t.summary||"No summary available",i=gt(pt(r)),m=i.length>280?i.substring(0,277)+"...":i,b=t.archive_urls||{};let S=` ${a}

${m}`;b.wayback&&(S+=`

 Archive:
 Wayback Machine: ${b.wayback}`);let y=_s||(t.share_token?`${window.location.origin}/public/content/${t.share_token}`:null);y&&(S=S.replace(m,`${m}

 View Full Analysis:
${y}`));let $=!1,O="";try{await navigator.clipboard.writeText(S),$=!0,O="Modern Clipboard API"}catch(T){ee.warn("Modern clipboard failed, trying fallback:",T);try{const P=document.createElement("textarea");P.value=S,P.style.position="fixed",P.style.left="-999999px",P.style.top="-999999px",document.body.appendChild(P),P.focus(),P.select();const xe=document.execCommand("copy");document.body.removeChild(P),xe&&($=!0,O="execCommand fallback")}catch(P){ee.warn("Fallback clipboard also failed:",P)}}if(!$){const T=document.createElement("div");T.style.cssText="position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:white;dark:bg-gray-800;padding:20px;border-radius:8px;box-shadow:0 4px 6px rgba(0,0,0,0.1);z-index:9999;max-width:90%;max-height:80%;overflow:auto;";const P=document.createElement("h3");P.textContent="Copy this text manually:",P.style.cssText="margin:0 0 10px 0;font-size:16px;font-weight:600;";const xe=document.createElement("textarea");xe.value=S,xe.style.cssText="width:100%;min-height:200px;padding:10px;border:1px solid #ccc;border-radius:4px;font-family:monospace;font-size:12px;",xe.readOnly=!0;const Ze=document.createElement("div");Ze.style.cssText="margin-top:10px;display:flex;gap:10px;";const Pe=document.createElement("button");Pe.textContent="Select All",Pe.style.cssText="padding:8px 16px;background:#3b82f6;color:white;border:none;border-radius:4px;cursor:pointer;",Pe.onclick=()=>xe.select();const $s=document.createElement("button");$s.textContent="Close",$s.style.cssText="padding:8px 16px;background:#6b7280;color:white;border:none;border-radius:4px;cursor:pointer;",$s.onclick=()=>document.body.removeChild(T),Ze.appendChild(Pe),Ze.appendChild($s),T.appendChild(P),T.appendChild(xe),T.appendChild(Ze),document.body.appendChild(T),xe.select(),n({title:"Manual Copy Required",description:"Browser blocked auto-copy. Please copy from the dialog."}),Re(!1);return}ee.debug(`Copy successful using: ${O}`),n({title:"Summary Copied! ",description:y?"Summary with full analysis link copied to clipboard!":"Summary copied! Creating share link in background..."}),!y&&t.id&&$&&(ee.info("Creating share link in background for next copy"),fetch("/api/content-intelligence/share",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({analysisId:t.id})}).then(T=>T.ok?T.json():null).then(T=>{T?.shareUrl&&(Vs(T.shareUrl),ee.info("Share link created for future use:",T.shareUrl))}).catch(T=>ee.warn("Background share link creation failed:",T)))}catch(s){console.error("Copy summary error:",s),n({title:"Copy Failed",description:s instanceof Error?s.message:"Failed to copy summary",variant:"destructive"})}finally{Re(!1)}}},Ss=async(s,a)=>{const r=document.getElementById("word-cloud-container");if(!r||!t){n({title:"Error",description:"Word cloud not found",variant:"destructive"});return}try{ee.info("Starting word cloud export...");const i=document.createElement("div");if(i.style.padding="40px",i.style.background="white",i.style.width="fit-content",i.style.maxWidth="1200px",a){const y=document.createElement("div");y.style.marginBottom="20px",y.style.color="#000",y.innerHTML=`
          <h2 style="font-size: 24px; font-weight: bold; margin-bottom: 8px;">${de.charAt(0).toUpperCase()+de.slice(1)} Word Cloud</h2>
          <p style="font-size: 14px; color: #666; margin-bottom: 4px;"><strong>Source:</strong> ${t.title||"Untitled"}</p>
          <p style="font-size: 14px; color: #666;"><strong>URL:</strong> ${t.url}</p>
        `,i.appendChild(y)}const m=r.cloneNode(!0);m.removeAttribute("id"),i.appendChild(m),i.style.position="absolute",i.style.left="-9999px",i.style.top="-9999px",document.body.appendChild(i);const b=y=>{const $=window.getComputedStyle(y),O=$.color,T=$.backgroundColor,P=$.fontSize,xe=$.fontWeight,Ze=$.opacity;y.className="",O&&!O.includes("oklch")?y.style.color=O:O&&(y.style.color="rgb(0, 0, 0)"),T&&!T.includes("oklch")&&T!=="rgba(0, 0, 0, 0)"&&(y.style.backgroundColor=T),y.style.fontSize=P,y.style.fontWeight=xe,y.style.opacity=Ze,Array.from(y.children).forEach(Pe=>{Pe instanceof HTMLElement&&b(Pe)})};b(m),m.style.background="linear-gradient(135deg, rgb(239, 246, 255) 0%, rgb(250, 245, 255) 100%)",m.style.borderRadius="8px",m.style.padding="32px",m.style.minHeight="300px",m.style.display="flex",m.style.flexWrap="wrap",m.style.alignItems="center",m.style.justifyContent="center",m.style.gap="16px",i.style.setProperty("background-color","#ffffff","important"),ee.debug("Rendering canvas...");const S=await ua(i,{backgroundColor:"#ffffff",scale:2,logging:!1,useCORS:!0,allowTaint:!0});document.body.removeChild(i),ee.debug("Canvas rendered, creating download..."),S.toBlob(y=>{if(!y){n({title:"Error",description:"Failed to create image blob",variant:"destructive"});return}const $=URL.createObjectURL(y),O=document.createElement("a"),T=de.charAt(0).toUpperCase()+de.slice(1);O.download=`wordcloud-${T}-${new Date().getTime()}.${s}`,O.href=$,O.click(),URL.revokeObjectURL($),ee.info("Download triggered successfully"),n({title:"Success",description:`Word cloud exported as ${s.toUpperCase()}`})},`image/${s}`,.95)}catch(i){ee.error("Export failed:",i),n({title:"Error",description:`Failed to export: ${i instanceof Error?i.message:"Unknown error"}`,variant:"destructive"})}};c.useEffect(()=>{Xt();const s=localStorage.getItem("pending_url_analysis");s&&(M(s),localStorage.removeItem("pending_url_analysis"),setTimeout(()=>{const a=document.querySelector("[data-analyze-button]");a&&a.click()},800))},[]);const Xt=async()=>{je(!0);try{const s=await fetch("/api/content-intelligence/saved-links?limit=5");if(s.ok){const a=await s.json();oe(a.links||[])}}catch(s){console.error("Failed to load saved links:",s)}finally{je(!1)}},rs=async()=>{if(!t){n({title:"Error",description:"No analysis available",variant:"destructive"});return}ot(!0);try{const s=await fetch("/api/content-intelligence/dime-analyze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({analysis_id:t.id.toString(),content_text:t.extracted_text,title:t.title||"Untitled",url:t.url})});if(!s.ok)throw new Error("DIME analysis failed");const a=await s.json();qt(a.dime_analysis),D({...t,dime_analysis:a.dime_analysis}),n({title:"DIME Analysis Complete",description:"Framework analysis has been generated successfully"})}catch(s){console.error("DIME analysis error:",s),n({title:"Error",description:"Failed to run DIME analysis",variant:"destructive"})}finally{ot(!1)}},ft=async()=>{if(!t){n({title:"Error",description:"No analysis available",variant:"destructive"});return}if(!t.id){n({title:"Error",description:"Analysis must be saved first",variant:"destructive"});return}ct(!0);try{const s=localStorage.getItem("omnicore_user_hash"),a=await fetch(`/api/claims/analyze/${t.id}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`}});if(!a.ok){const i=await a.json().catch(()=>({}));throw console.error("[Claims] API error:",i),new Error(i.details||i.error||"Claims analysis failed")}const r=await a.json();Dt(r.claim_analysis),D({...t,claim_analysis:r.claim_analysis}),n({title:"Claims Analysis Complete",description:`${r.claim_analysis?.summary?.total_claims||0} claims analyzed successfully`})}catch(s){console.error("Claims analysis error:",s);const a=s instanceof Error?s.message:"Failed to run claims analysis";n({title:"Error",description:a,variant:"destructive"})}finally{ct(!1)}},Zt=async s=>{if(t)switch(s){case"claims":await ft(),u("claims");break;case"dime":await rs(),u("dime");break;case"starbursting":t.id&&(await As(t.id),u("starbursting"));break;case"qa":u("qa");break;default:n({title:"Coming Soon",description:`${s} framework will be available soon.`})}},ea=async()=>{if(!t){n({title:"Error",description:"No analysis to save",variant:"destructive"});return}const s=localStorage.getItem("omnicore_user_hash");if(!s){n({title:"Authentication Required",description:"Please ensure you have a user session",variant:"destructive"});return}Re(!0);try{const a=await fetch("/api/content-intelligence/save",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`,"X-User-Hash":s},body:JSON.stringify({analysis_id:t.id.toString(),generate_share_link:!0,note:ae||void 0,tags:re?re.split(",").map(i=>i.trim()):[]})});if(!a.ok)throw new Error("Failed to save analysis");const r=await a.json();Vs(r.share_url?`${window.location.origin}${r.share_url}`:null),Ht(!0),D({...t,is_saved:!0,share_token:r.share_token}),n({title:"Analysis Saved",description:"Your analysis has been saved permanently"})}catch(a){console.error("Save error:",a),n({title:"Error",description:"Failed to save analysis",variant:"destructive"})}finally{Re(!1)}},Ws=async s=>{const a=s||v;if(!a){n({title:"Error",description:"Please enter a URL",variant:"destructive"});return}s&&M(s),D(null),h([]),E(!0),k("extracting"),K(10);const r=/youtube\.com|youtu\.be|twitter\.com|x\.com|facebook\.com|instagram\.com|tiktok\.com|linkedin\.com|reddit\.com/i.test(a),i=r?a.match(/(youtube|twitter|x\.com|facebook|instagram|tiktok|linkedin|reddit)/i)?.[0]||"social media":null;V(r?`Extracting ${i} content (video/audio transcripts may take longer)...`:"Extracting content...");let m=null;try{const b=encodeURIComponent(a);ne({"12ft":`https://12ft.io/proxy?q=${b}`,wayback:`https://web.archive.org/web/*/${a}`,archive_is:`https://archive.is/${a}`}),K(30),k("analyzing_words"),V(r?`Analyzing ${i} content and engagement patterns...`:"Analyzing word frequency...");const S=[{progress:35,message:"Extracting entities..."},{progress:45,message:"Generating summary..."},{progress:55,message:"Analyzing topics..."},{progress:62,message:"Extracting key phrases..."},{progress:68,message:"Analyzing sentiment..."},{progress:75,message:"Detecting claims..."},{progress:85,message:"Analyzing claim credibility..."}];let y=0;m=setInterval(()=>{y<S.length&&(K(S[y].progress),V(S[y].message),y++)},2e3);const $=await fetch("/api/content-intelligence/analyze-url",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:a,mode:R,save_link:!0,link_note:ae||void 0,link_tags:re?re.split(",").map(T=>T.trim()):[]})});if(m&&clearInterval(m),!$.ok){if($.status===524)throw new Error('Analysis timed out. The content may be too large or complex. Try using "quick" mode or a shorter article.');const T=$.headers.get("content-type");if(T&&T.includes("application/json")){const P=await $.json();console.error("[DEBUG] Backend error details:",{error:P.error,details:P.details,errorName:P.errorName,technical_error:P.technical_error,stack:P.stack});const xe=P.details||P.error||`Analysis failed with status ${$.status}`;throw new Error(`${xe}${P.errorName?` (${P.errorName})`:""}`)}else throw new Error(`Analysis failed with status ${$.status}. The server may be overloaded or the request timed out.`)}K(70),k("extracting_entities"),V("Extracting entities...");const O=await $.json();K(100),k("complete"),V("Complete!"),D(O),jt(O),O.entities&&yt(O.entities),R==="full"&&O.id?(n({title:"Analysis Complete!",description:"Starting DIME and Starbursting analysis (Full mode)..."}),O.extracted_text&&rs().catch(T=>{console.error("[Full Mode] DIME analysis failed:",T)}),As(O.id).catch(T=>{console.error("[Full Mode] Starbursting failed:",T)})):n({title:"Success",description:"Analysis complete!"})}catch(b){m&&clearInterval(m),console.error("Analysis error:",b),k("error");let S="Unknown error",y="";if(b instanceof Error&&(b.message.includes("blocked access")?(S="Website Blocked Access",y="The website blocked automated access. Scroll down to see Bypass URLs that may help."):b.message.includes("timeout")||b.message.includes("took too long")?(S="Request Timeout",y="The website took too long to respond. Try a bypass URL or try again later."):b.message.includes("not found")?(S="Page Not Found",y="The URL may be incorrect or the page may have been removed."):(S="Analysis Failed",y=b.message)),n({title:S,description:y,variant:"destructive"}),!I||Object.keys(I).length===0){const $=encodeURIComponent(v);ne({"12ft":`https://12ft.io/proxy?q=${$}`,wayback:`https://web.archive.org/web/*/${v}`,archive_is:`https://archive.is/${v}`})}}finally{E(!1)}};c.useEffect(()=>{t?.id&&sa()},[t?.id]);const sa=async()=>{if(t?.id)try{const s=await fetch(`/api/content-intelligence/answer-question?analysis_id=${t.id}`);if(s.ok){const a=await s.json();h(a.history||[])}}catch(s){console.error("Failed to load Q&A history:",s)}},jt=s=>{try{const a=St(s,v),{citation:r,inTextCitation:i}=ka(a.fields,a.sourceType,"apa");ke(r),Os({citationData:a,citation:r,inTextCitation:i}),vs(!1)}catch(a){console.error("Citation generation error:",a)}},ta=async s=>{try{E(!0),k("analyzing_words"),V("Creating ACH analysis...");let a=s.id;if(!a){V("Saving analysis first...");const m=await fetch("/api/content-intelligence/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({analysis_id:s.id?.toString()||"temp",generate_share_link:!1})});if(!m.ok)throw new Error("Failed to save analysis before creating ACH");const b=await m.json();a=b.analysis_id||b.id,D({...s,id:a,is_saved:!0})}if(!a)throw new Error("Could not obtain analysis ID");V("Generating ACH hypotheses...");const r=await fetch("/api/ach/from-content-intelligence",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({analysis_id:a})});if(!r.ok){const m=await r.json().catch(()=>({}));throw new Error(m.details||m.error||"Failed to create ACH")}const i=await r.json();n({title:"ACH Analysis Created",description:`Created with ${i.hypotheses_count} hypotheses and linked evidence`}),j(`/dashboard/analysis-frameworks/ach/${i.ach_id}`)}catch(a){console.error("ACH creation error:",a),n({title:"Failed to Create ACH",description:a instanceof Error?a.message:"Could not create ACH analysis from this content",variant:"destructive"})}finally{E(!1),k("complete"),V("")}},aa=()=>{if(Le)try{const s={id:_a(),citation:Le.citation,inTextCitation:Le.inTextCitation,citationStyle:"apa",sourceType:Le.citationData.sourceType,fields:Le.citationData.fields,addedAt:new Date().toISOString(),tags:["content-intelligence"]};Ca(s),vs(!0),n({title:"Citation Saved!",description:"Added to your citation library. Open Citation Generator to view all saved citations."})}catch(s){console.error("Citation save error:",s),n({title:"Error",description:"Failed to save citation",variant:"destructive"})}},ra=async()=>{try{await navigator.clipboard.writeText(ze),bs(!0),n({title:"Copied!",description:"Citation copied to clipboard"}),setTimeout(()=>bs(!1),2e3)}catch{n({title:"Error",description:"Failed to copy citation",variant:"destructive"})}},Es=async(s,a)=>{try{const r=localStorage.getItem("omnicore_user_hash");if(!r){window.confirm(`You need to be logged in to save entities.

Would you like to login or create an account now?`)&&(localStorage.setItem("redirect_after_login",window.location.pathname+window.location.search),j("/login"));return}const i=a==="person"?"PERSON":a==="organization"?"ORGANIZATION":"OTHER",m=await fetch(`/api/actors/search?workspace_id=1&name=${encodeURIComponent(s)}&type=${i}`,{headers:{Authorization:`Bearer ${r}`}});if(!m.ok)console.warn(`Duplicate check failed for ${s}: ${m.status}`);else{const S=m.headers.get("content-type");if(!S||!S.includes("application/json"))console.warn(`Non-JSON response from duplicate check for ${s}`);else{const y=await m.json();if(y.exists)if(window.confirm(`"${s}" already exists in your entities.

Click OK to view the existing entity, or Cancel to update the name and save as a new entity.`)){j(`/dashboard/entities/actors/${y.actor.id}`);return}else{const O=window.prompt("Enter a different name for this entity:",s+" (2)");if(!O||O.trim()==="")return;s=O.trim()}}}const b=await fetch("/api/actors",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({name:s,type:i,workspace_id:"1",description:`Auto-extracted from: ${t?.title||v}`,tags:["content-intelligence",a],source_url:v})});if(b.ok)n({title:"Saved to Evidence",description:`${s} added to ${a==="person"?"Actors":a==="location"?"Places":"Evidence"}`}),t?.entities&&await yt(t.entities);else{const S=await b.json().catch(()=>({}));throw new Error(S.error||"Failed to save")}}catch(r){n({title:"Error",description:r instanceof Error?r.message:`Failed to save ${s}`,variant:"destructive"})}},ia=async()=>{if(!t?.entities)return;let s=0;const a=[...(t.entities.people||[]).map(r=>({name:r.name,type:"person"})),...(t.entities.organizations||[]).map(r=>({name:r.name,type:"organization"})),...(t.entities.locations||[]).map(r=>({name:r.name,type:"location"}))];for(const r of a)try{await Es(r.name,r.type),s++}catch(i){console.error(`Failed to save ${r.name}:`,i)}n({title:"Bulk Save Complete",description:`Saved ${s} of ${a.length} entities to evidence`})},na=async()=>{if(!t?.id)return;E(!0);const s=localStorage.getItem("omnicore_user_hash");try{const a=await fetch("/api/content-intelligence/auto-extract-entities",{method:"POST",headers:{"Content-Type":"application/json",...s&&{Authorization:`Bearer ${s}`}},body:JSON.stringify({analysis_id:t.id,workspace_id:"1",user_id:1})});if(!a.ok)throw new Error("Failed to auto-extract entities");const r=await a.json();n({title:"Auto-Extraction Complete!",description:`Created ${r.summary.new_actors} actors, matched ${r.summary.matched_actors} existing, and created ${r.summary.new_relationships} relationships.`}),ee.debug("Auto-extraction results:",r)}catch(a){ee.error("Auto-extract error:",a),n({title:"Auto-Extraction Failed",description:a instanceof Error?a.message:"Unknown error",variant:"destructive"})}finally{E(!1)}},yt=async s=>{if(!s)return;Ps(!0);const a=localStorage.getItem("omnicore_user_hash");if(!a){Ps(!1);return}const r=[...(s.people||[]).map(m=>({name:m.name,type:"PERSON"})),...(s.organizations||[]).map(m=>({name:m.name,type:"ORGANIZATION"})),...(s.locations||[]).map(m=>({name:m.name,type:"LOCATION"}))],i={};for(const m of r)try{const b=await fetch(`/api/actors/search?workspace_id=1&name=${encodeURIComponent(m.name)}&type=${m.type}`,{headers:{Authorization:`Bearer ${a}`}});if(b.ok){const S=b.headers.get("content-type");if(S&&S.includes("application/json")){const y=await b.json();y.exists&&y.actor&&(i[m.name]={id:y.actor.id,name:y.actor.name})}else console.warn(`Non-JSON response for ${m.name}:`,await b.text())}else console.warn(`Failed to check duplicate for ${m.name}: ${b.status}`)}catch(b){console.error(`Failed to check duplicate for ${m.name}:`,b)}Mt(i),Ps(!1)},As=async s=>{if(s){ee.info("Starting Starbursting background analysis for content ID:",s),Ms("processing"),it(null);try{const a=localStorage.getItem("omnicore_user_hash"),r=await fetch("/api/content-intelligence/starbursting",{method:"POST",headers:{"Content-Type":"application/json",...a&&{Authorization:`Bearer ${a}`}},body:JSON.stringify({analysis_ids:[s],use_ai_questions:!0})});if(!r.ok){const m=await r.json().catch(()=>({}));throw console.error("[Starbursting] API error:",m),new Error(m.details||m.error||"Failed to create Starbursting session")}const i=await r.json();if(console.log("[Starbursting] Full response:",i),console.log("[Starbursting] Response data:",{hasFrameworkData:!!i.framework_data,frameworkDataKeys:i.framework_data?Object.keys(i.framework_data):[],hasData:!!i.framework_data?.data,dataType:typeof i.framework_data?.data}),i.framework_data?.data&&console.log("[Starbursting] framework_data.data contents:",i.framework_data.data),i.framework_data?.data&&typeof i.framework_data.data=="string")try{i.framework_data.data=JSON.parse(i.framework_data.data),console.log("[Starbursting] Parsed framework data:",i.framework_data.data)}catch(m){console.error("[Starbursting] Failed to parse framework data:",m)}console.log("[Starbursting] Setting session state with data:",{hasFrameworkData:!!i.framework_data,hasFrameworkDataData:!!i.framework_data?.data,frameworkDataType:typeof i.framework_data,frameworkDataDataType:typeof i.framework_data?.data}),rt(i),Ms("complete")}catch(a){console.error("[Starbursting] Background processing error:",a),it(a instanceof Error?a.message:"Unknown error"),Ms("error")}}},la=async s=>{if(s){ee.info("Generating more questions for Starbursting session:",s),lt(!0);try{const a=localStorage.getItem("omnicore_user_hash"),r=await fetch(`/api/content-intelligence/starbursting/${s}/generate-questions`,{method:"POST",headers:{"Content-Type":"application/json",...a&&{Authorization:`Bearer ${a}`}},body:JSON.stringify({existing_questions:B?.framework_data?.data||{}})});if(!r.ok){const m=await r.json().catch(()=>({}));throw new Error(m.details||m.error||"Failed to generate more questions")}const i=await r.json();if(i.framework_data?.data&&typeof i.framework_data.data=="string")try{i.framework_data.data=JSON.parse(i.framework_data.data)}catch(m){console.error("[Generate More Questions] Failed to parse framework data:",m)}rt(i),n({title:"Questions Generated",description:"New questions have been added to your Starbursting analysis."})}catch(a){console.error("[Generate More Questions] Error:",a),n({title:"Failed to Generate Questions",description:a instanceof Error?a.message:"Unknown error",variant:"destructive"})}finally{lt(!1)}}},oa=async s=>{if(s){ws(!0);try{const r=await(await fetch("/api/content-intelligence/domain-country",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:s})})).json();r.success?Q(r):Q(null)}catch(a){console.error("Country lookup error:",a),Q(null)}finally{ws(!1)}}};c.useEffect(()=>{if(v&&v.startsWith("http")){const s=setTimeout(()=>{oa(v)},500);return()=>clearTimeout(s)}else Q(null)},[v]);const ca=async()=>{if(!v){n({title:"Error",description:"Please enter a URL first",variant:"destructive"});return}W(!0);try{const s=await fetch("/api/content-intelligence/virustotal-lookup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:v})}),a=await s.json();if(!s.ok&&!a.directLink)throw new Error(a.error||"VirusTotal lookup failed");a.stats||a.reputation!==void 0?(Is(a),ys(!0)):(window.open(a.directLink,"_blank","noopener,noreferrer"),n({title:"Opening VirusTotal",description:a.message||"View domain security report on VirusTotal"}))}catch(s){console.error("VirusTotal lookup error:",s);try{const a=new URL(v).hostname;window.open(`https://www.virustotal.com/gui/domain/${a}`,"_blank","noopener,noreferrer"),n({title:"Opening VirusTotal",description:"API unavailable, opening direct link"})}catch{n({title:"Error",description:"Invalid URL or VirusTotal unavailable",variant:"destructive"})}}finally{W(!1)}},bt=async()=>{if(!ye.trim()||!t?.id){n({title:"Error",description:"Please enter a question",variant:"destructive"});return}Ne(!0);try{const s=await fetch("/api/content-intelligence/answer-question",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({analysis_id:t.id,question:ye.trim()})});if(!s.ok){const r=await s.json();throw new Error(r.error||"Failed to answer question")}const a=await s.json();h(r=>[a,...r]),be(""),n({title:"Question answered",description:a.has_complete_answer?"Answer found with high confidence":"Partial answer found - some information may be missing"})}catch(s){console.error("Q&A error:",s),n({title:"Error",description:s instanceof Error?s.message:"Failed to answer question",variant:"destructive"})}finally{Ne(!1)}},is=async s=>{if(!v){n({title:"Error",description:"Please enter a URL",variant:"destructive"});return}et(!0),Zs(null);try{n({title:`Extracting ${s==="full"?"complete data":s}...`,description:"This may take a moment"});const a=await fetch("/api/content-intelligence/social-media-extract",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:v,platform:t?.social_platform,mode:s})});if(!a.ok){const i=await a.json();throw new Error(i.error||"Social media extraction failed")}const r=await a.json();if(!r.success)throw new Error(r.error||"Extraction failed");Zs(r),n({title:"Extraction Complete!",description:`Successfully extracted ${r.platform} content`}),setTimeout(()=>{document.getElementById("social-media-results")?.scrollIntoView({behavior:"smooth"})},100)}catch(a){console.error("Social media extraction error:",a),n({title:"Extraction Failed",description:a instanceof Error?a.message:"Failed to extract social media content",variant:"destructive"})}finally{et(!1)}},da=async()=>{if(!v){n({title:"Error",description:"Please enter a URL",variant:"destructive"});return}at(!0),st(null);try{n({title:"Extracting repository information...",description:"Fetching metadata, README, commits, and releases"});const s=await fetch("/api/content-intelligence/git-repository-extract",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:v})});if(!s.ok){const r=await s.json();throw new Error(r.error||"Git repository extraction failed")}const a=await s.json();if(!a.success)throw new Error(a.error||"Repository extraction failed");st(a),n({title:"Repository Extraction Complete!",description:`Successfully extracted ${a.platform.toUpperCase()} repository information`}),setTimeout(()=>{document.getElementById("git-repo-results")?.scrollIntoView({behavior:"smooth"})},100)}catch(s){console.error("Git repository extraction error:",s),n({title:"Extraction Failed",description:s instanceof Error?s.message:"Failed to extract repository information",variant:"destructive"})}finally{at(!1)}},ma=async(s,a)=>{try{n({title:"Starting download...",description:"Please wait"});const r=document.createElement("a");if(r.href=s,r.download=a||`download_${Date.now()}`,r.target="_blank",r.rel="noopener noreferrer",s.startsWith("http")&&!s.includes(window.location.host))try{const i=await fetch(s,{mode:"cors"});if(i.ok){const m=await i.blob(),b=URL.createObjectURL(m);r.href=b,document.body.appendChild(r),r.click(),document.body.removeChild(r),setTimeout(()=>URL.revokeObjectURL(b),100),n({title:"Download started!",description:"Check your downloads folder"});return}}catch(i){console.warn("CORS fetch failed, falling back to direct link:",i)}document.body.appendChild(r),r.click(),document.body.removeChild(r),n({title:"Download initiated",description:"If download doesn't start, check popup blocker settings"})}catch(r){console.error("Download error:",r),n({title:"Download failed",description:r instanceof Error?r.message:"Could not download file",variant:"destructive"})}},xa=s=>({youtube:"Video downloads (multiple qualities), transcripts, engagement metrics, thumbnails",instagram:"Post media (images/videos), captions, likes/comments, carousel support",tiktok:"Video downloads, metadata extraction, engagement metrics",twitter:"Tweet text, media URLs, embed codes, author information",facebook:"Post data, media links, engagement metrics",reddit:"Post content, comments, upvotes, media links"})[s.toLowerCase()]||"Basic metadata extraction";return e.jsxs("div",{className:"container mx-auto py-8 space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-2",children:[e.jsx(we,{className:"h-8 w-8"}),o("pages.contentIntelligence.title")]}),e.jsx("p",{className:"text-muted-foreground",children:o("pages.contentIntelligence.subtitle")})]}),e.jsx(f,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex gap-2",children:e.jsx(We,{placeholder:o("pages.contentIntelligence.urlPlaceholder"),value:v,onChange:s=>M(s.target.value),onKeyDown:s=>s.key==="Enter"&&Ws(),className:"flex-1"})}),e.jsxs("div",{className:"flex gap-2 items-center justify-between",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{variant:R==="quick"?"default":"outline",onClick:()=>L("quick"),size:"sm",children:o("pages.contentIntelligence.modes.quick")}),e.jsx(d,{variant:R==="normal"?"default":"outline",onClick:()=>L("normal"),size:"sm",children:o("pages.contentIntelligence.modes.normal")}),e.jsx(d,{variant:R==="full"?"default":"outline",onClick:()=>L("full"),size:"sm",children:o("pages.contentIntelligence.modes.full")})]}),e.jsx(d,{onClick:()=>Ws(),disabled:F,"data-analyze-button":!0,children:F?e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"h-4 w-4 mr-2 animate-spin"}),o("pages.contentIntelligence.analyzing")]}):e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),o("pages.contentIntelligence.analyzeContent")]})})]})]})}),F&&e.jsx(f,{className:"p-6 bg-gradient-to-r from-blue-50 via-indigo-50 to-purple-50 dark:from-blue-950/40 dark:via-indigo-950/40 dark:to-purple-950/40 border-2 border-blue-400 dark:border-blue-600",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(q,{className:"h-6 w-6 animate-spin text-blue-600 dark:text-blue-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg text-blue-900 dark:text-blue-100",children:pe}),e.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300 mt-1",children:o("pages.contentIntelligence.processingTime")})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-2xl font-bold text-blue-900 dark:text-blue-100",children:[ue,"%"]})})]}),e.jsx(Z,{value:ue,className:"h-2"})]})}),!F&&A&&e.jsx(f,{className:"p-4 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-950/20 dark:to-indigo-950/20 border-blue-300",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-3xl",children:A.flag}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"font-semibold text-blue-900 dark:text-blue-100",children:["Hosted in ",A.country]}),e.jsxs("div",{className:"text-sm text-blue-700 dark:text-blue-300 space-y-0.5",children:[e.jsxs("p",{children:["Domain: ",A.domain]}),A.ip&&e.jsxs("p",{children:["IP: ",A.ip]}),A.city&&A.region&&e.jsxs("p",{children:["Location: ",A.city,", ",A.region]}),A.org&&e.jsxs("p",{children:["Organization: ",A.org]})]})]})]})}),!F&&_&&e.jsx(f,{className:"p-4 bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(q,{className:"h-4 w-4 animate-spin"}),"Looking up domain country..."]})}),v&&t?.is_social_media&&t.social_platform&&e.jsx(f,{className:"p-6 bg-gradient-to-br from-purple-50 via-pink-50 to-orange-50 dark:from-purple-950/30 dark:via-pink-950/30 dark:to-orange-950/30 border-2 border-purple-300",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-purple-600 rounded-full shrink-0",children:e.jsx(Ks,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"text-xl font-bold text-purple-900 dark:text-purple-100 mb-1",children:[t.social_platform.toUpperCase()," Content Detected"]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mb-4",children:"Use specialized extraction tools for videos, images, transcripts, and more."}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[e.jsxs(d,{onClick:()=>is("metadata"),disabled:Je,size:"sm",variant:"default",className:"bg-purple-600 hover:bg-purple-700",children:[Je?e.jsx(q,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(Ge,{className:"h-4 w-4 mr-2"}),"Quick Info"]}),e.jsxs(d,{onClick:()=>is("download"),disabled:Je,size:"sm",variant:"outline",children:[e.jsx(Xs,{className:"h-4 w-4 mr-2"}),"Download Media"]}),e.jsxs(d,{onClick:()=>is("stream"),disabled:Je,size:"sm",variant:"outline",children:[e.jsx(Pt,{className:"h-4 w-4 mr-2"}),"Stream/Embed"]}),t.social_platform==="youtube"&&e.jsxs(d,{onClick:()=>is("transcript"),disabled:Je,size:"sm",variant:"outline",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Get Transcript"]}),e.jsxs(d,{onClick:()=>is("full"),disabled:Je,size:"sm",variant:"outline",children:[e.jsx(Ks,{className:"h-4 w-4 mr-2"}),"Full Extract"]})]}),e.jsx("div",{className:"p-3 bg-white/50 dark:bg-gray-800/50 rounded-lg",children:e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:[e.jsx("strong",{children:"Available:"})," ",xa(t.social_platform)]})})]})]})}),v&&/github\.com|gitlab\.com|bitbucket\.org/i.test(v)&&e.jsx(f,{className:"p-6 bg-gradient-to-br from-blue-50 via-indigo-50 to-cyan-50 dark:from-blue-950/30 dark:via-indigo-950/30 dark:to-cyan-950/30 border-2 border-blue-300",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-blue-600 rounded-full shrink-0",children:e.jsx(cs,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"text-xl font-bold text-blue-900 dark:text-blue-100 mb-1",children:[v.match(/github\.com/i)?"GitHub":v.match(/gitlab\.com/i)?"GitLab":"Bitbucket"," Repository Detected"]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mb-4",children:"Extract repository metadata, README, commit history, releases, and language statistics."}),e.jsxs(d,{onClick:da,disabled:tt,size:"sm",variant:"default",className:"bg-blue-600 hover:bg-blue-700",children:[tt?e.jsx(q,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(cs,{className:"h-4 w-4 mr-2"}),"Extract Repository Info"]}),e.jsx("div",{className:"p-3 bg-white/50 dark:bg-gray-800/50 rounded-lg mt-4",children:e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:[e.jsx("strong",{children:"Extracting:"})," Stars, forks, languages, README, latest commits, releases, contributors"]})})]})]})}),g&&e.jsxs(f,{id:"social-media-results",className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-bold mb-4 flex items-center gap-2",children:[e.jsx(Ks,{className:"h-5 w-5 text-purple-600"}),g.platform.toUpperCase()," Extraction Results"]}),g.mediaUrls?.video&&e.jsx("div",{className:"mb-4",children:e.jsxs("video",{controls:!0,className:"w-full max-h-96 rounded-lg bg-black",children:[e.jsx("source",{src:g.mediaUrls.video}),"Your browser does not support the video tag."]})}),g.mediaUrls?.images&&g.mediaUrls.images.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("h4",{className:"font-semibold mb-2",children:["Media (",g.mediaUrls.images.length," ",g.mediaUrls.images.length===1?"image":"images",")"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:g.mediaUrls.images.map((s,a)=>{const r=g.platform==="twitter"?`/api/content-intelligence/twitter-image-proxy?url=${encodeURIComponent(s)}`:s;return e.jsxs("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"group relative block overflow-hidden rounded-lg border border-gray-200 dark:border-gray-700 hover:border-blue-500 dark:hover:border-blue-400 transition-colors",children:[e.jsx("img",{src:r,alt:`Media ${a+1}`,className:"w-full h-48 object-cover transition-transform group-hover:scale-105",loading:"lazy"}),e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors flex items-center justify-center",children:e.jsx(Ce,{className:"h-6 w-6 text-white opacity-0 group-hover:opacity-100 transition-opacity"})})]},a)})})]}),g.downloadOptions&&g.downloadOptions.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Download Options"}),e.jsx("div",{className:"grid md:grid-cols-2 gap-2",children:g.downloadOptions.map((s,a)=>e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>ma(s.url,`${g.platform}_${s.quality}.${s.format}`),className:"justify-start",children:[e.jsx(Xs,{className:"h-4 w-4 mr-2"}),s.quality," (",s.format,")",s.size&&` - ${(s.size/1024/1024).toFixed(1)}MB`]},a))})]}),g.streamUrl&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Stream URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(We,{value:g.streamUrl,readOnly:!0}),e.jsx(d,{variant:"outline",size:"sm",onClick:()=>window.open(g.streamUrl,"_blank"),children:e.jsx(Ce,{className:"h-4 w-4"})})]})]}),g.embedCode&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Embed Code"}),e.jsx(he,{value:g.embedCode,readOnly:!0,rows:3,className:"font-mono text-xs"})]}),g.metadata&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Metadata"}),g.platform==="twitter"&&g.metadata.text&&e.jsxs("div",{className:"mb-4 p-4 bg-blue-50 dark:bg-blue-950 rounded-lg border border-blue-200 dark:border-blue-800",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h5",{className:"font-semibold text-blue-900 dark:text-blue-100",children:"Tweet Text"}),e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>{navigator.clipboard.writeText(g.metadata.text),n({title:"Copied!",description:"Tweet text copied to clipboard"})},children:e.jsx(Se,{className:"h-3 w-3"})})]}),e.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-wrap text-gray-800 dark:text-gray-200",children:g.metadata.text})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4 text-sm",children:[g.metadata.authorName&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Author"}),e.jsx("p",{className:"font-semibold",children:g.metadata.authorName}),g.metadata.authorHandle&&e.jsx("p",{className:"text-xs text-blue-600",children:g.metadata.authorHandle})]}),g.metadata.tweetId&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Tweet ID"}),e.jsx("p",{className:"font-mono text-xs",children:g.metadata.tweetId})]}),g.metadata.hasMedia!==void 0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Has Media"}),e.jsx("p",{className:"font-semibold",children:g.metadata.hasMedia?`Yes (${g.metadata.mediaCount||1} item${g.metadata.mediaCount>1?"s":""})`:"No"})]}),g.metadata.title&&!g.metadata.tweetId&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Title"}),e.jsx("p",{className:"font-semibold",children:g.metadata.title})]}),g.metadata.author&&!g.metadata.authorName&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Author"}),e.jsx("p",{className:"font-semibold",children:g.metadata.author})]}),g.metadata.viewCount!==void 0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Views"}),e.jsx("p",{className:"font-semibold",children:g.metadata.viewCount.toLocaleString()})]}),g.metadata.likeCount!==void 0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Likes"}),e.jsx("p",{className:"font-semibold",children:g.metadata.likeCount.toLocaleString()})]}),g.metadata.replyCount!==void 0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Replies"}),e.jsx("p",{className:"font-semibold",children:g.metadata.replyCount.toLocaleString()})]}),g.metadata.repostCount!==void 0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Reposts"}),e.jsx("p",{className:"font-semibold",children:g.metadata.repostCount.toLocaleString()})]}),g.metadata.commentCount!==void 0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Comments"}),e.jsx("p",{className:"font-semibold",children:g.metadata.commentCount.toLocaleString()})]}),g.metadata.extractedVia&&e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:"Extracted via"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:g.metadata.extractedVia})]})]})]}),g.transcript&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-semibold",children:"Transcript"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(z,{variant:"secondary",className:"text-xs",children:[g.transcript.split(" ").length," words"]}),e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>{navigator.clipboard.writeText(g.transcript||""),n({title:"Copied!",description:"Transcript copied to clipboard"})},children:e.jsx(Se,{className:"h-3 w-3"})})]})]}),e.jsx("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg max-h-96 overflow-y-auto border",children:e.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:g.transcript})})]}),t?.extracted_text&&e.jsx("div",{className:"mt-4",children:e.jsxs("details",{className:"group",children:[e.jsxs("summary",{className:"cursor-pointer font-semibold p-3 bg-blue-50 dark:bg-blue-950 rounded-lg hover:bg-blue-100 dark:hover:bg-blue-900 flex items-center justify-between",children:[e.jsx("span",{children:" View Full Analyzed Content"}),e.jsxs(z,{variant:"outline",className:"text-xs",children:[t.word_count.toLocaleString()," words"]})]}),e.jsxs("div",{className:"mt-2 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg max-h-96 overflow-y-auto border",children:[e.jsx("div",{className:"flex justify-end mb-2",children:e.jsxs(d,{variant:"ghost",size:"sm",onClick:()=>{navigator.clipboard.writeText(t.extracted_text),n({title:"Copied!",description:"Full content copied to clipboard"})},children:[e.jsx(Se,{className:"h-3 w-3 mr-1"}),"Copy"]})}),e.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:t.extracted_text})]})]})})]}),N&&N.repository&&e.jsxs(f,{id:"git-repo-results",className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-bold mb-4 flex items-center gap-2",children:[e.jsx(cs,{className:"h-5 w-5 text-blue-600"}),N.platform.toUpperCase()," Repository Information"]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"font-semibold text-base mb-3 flex items-center gap-2",children:[e.jsx(Ra,{className:"h-4 w-4"}),N.repository.fullName]}),N.repository.description&&e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mb-4 italic",children:N.repository.description}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm mb-4",children:[N.repository.stars!==void 0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(He,{className:"h-4 w-4 text-yellow-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:"Stars"}),e.jsx("p",{className:"font-semibold",children:N.repository.stars.toLocaleString()})]})]}),N.repository.forks!==void 0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(cs,{className:"h-4 w-4 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:"Forks"}),e.jsx("p",{className:"font-semibold",children:N.repository.forks.toLocaleString()})]})]}),N.repository.watchers!==void 0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Be,{className:"h-4 w-4 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:"Watchers"}),e.jsx("p",{className:"font-semibold",children:N.repository.watchers.toLocaleString()})]})]}),N.repository.openIssues!==void 0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ds,{className:"h-4 w-4 text-orange-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:"Open Issues"}),e.jsx("p",{className:"font-semibold",children:N.repository.openIssues.toLocaleString()})]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4 text-sm",children:[N.repository.language&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:"Primary Language"}),e.jsx("p",{className:"font-semibold",children:N.repository.language})]}),N.repository.license&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:"License"}),e.jsx("p",{className:"font-semibold",children:N.repository.license})]}),N.contributors!==void 0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:"Contributors"}),e.jsx("p",{className:"font-semibold",children:N.contributors.toLocaleString()})]})]})]}),N.repository.languages&&Object.keys(N.repository.languages).length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"font-semibold mb-2 text-sm",children:"Languages Used"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(N.repository.languages).sort(([,s],[,a])=>a-s).slice(0,10).map(([s,a])=>e.jsx(z,{variant:"secondary",className:"text-xs",children:s},s))})]}),N.latestCommit&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"font-semibold mb-2 text-sm flex items-center gap-2",children:[e.jsx(cs,{className:"h-4 w-4"}),"Latest Commit"]}),e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:N.latestCommit.message}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["by ",N.latestCommit.author,"  ",new Date(N.latestCommit.date).toLocaleDateString()]})]}),e.jsx(z,{variant:"outline",className:"font-mono text-xs ml-2",children:N.latestCommit.sha})]}),e.jsxs("a",{href:N.latestCommit.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:underline flex items-center gap-1",children:["View commit ",e.jsx(Ce,{className:"h-3 w-3"})]})]})]}),N.latestRelease&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"font-semibold mb-2 text-sm flex items-center gap-2",children:[e.jsx(Fa,{className:"h-4 w-4"}),"Latest Release"]}),e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border",children:[e.jsx("div",{className:"flex items-start justify-between mb-2",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:N.latestRelease.name}),e.jsx(z,{variant:"secondary",className:"text-xs mt-1",children:N.latestRelease.tag}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Released ",new Date(N.latestRelease.publishedAt).toLocaleDateString()]})]})}),N.latestRelease.description&&e.jsxs("p",{className:"text-xs text-gray-700 dark:text-gray-300 mt-2 mb-2",children:[N.latestRelease.description.substring(0,200),N.latestRelease.description.length>200?"...":""]}),e.jsxs("a",{href:N.latestRelease.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:underline flex items-center gap-1",children:["View release ",e.jsx(Ce,{className:"h-3 w-3"})]})]})]}),N.recentCommits&&N.recentCommits.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"font-semibold mb-2 text-sm",children:"Recent Commits"}),e.jsx("div",{className:"space-y-2",children:N.recentCommits.map((s,a)=>e.jsxs("div",{className:"p-2 bg-gray-50 dark:bg-gray-800 rounded border text-xs",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("p",{className:"font-medium flex-1",children:s.message}),e.jsx(z,{variant:"outline",className:"font-mono text-xs ml-2",children:s.sha})]}),e.jsxs("p",{className:"text-muted-foreground text-xs mt-1",children:[s.author,"  ",new Date(s.date).toLocaleDateString()]})]},a))})]}),N.readme&&e.jsx("div",{className:"mt-4",children:e.jsxs("details",{className:"group",children:[e.jsxs("summary",{className:"cursor-pointer font-semibold p-3 bg-blue-50 dark:bg-blue-950 rounded-lg hover:bg-blue-100 dark:hover:bg-blue-900 flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(we,{className:"h-4 w-4"}),"README Preview"]}),e.jsx(z,{variant:"outline",className:"text-xs",children:N.readme.truncated?`${N.readme.content.length} chars (truncated)`:"Full"})]}),e.jsxs("div",{className:"mt-2 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg max-h-96 overflow-y-auto border",children:[e.jsx("div",{className:"flex justify-end mb-2",children:e.jsxs(d,{variant:"ghost",size:"sm",onClick:()=>{navigator.clipboard.writeText(N.readme.content),n({title:"Copied!",description:"README content copied to clipboard"})},children:[e.jsx(Se,{className:"h-3 w-3 mr-1"}),"Copy"]})}),e.jsx("pre",{className:"text-xs leading-relaxed whitespace-pre-wrap font-mono",children:N.readme.content})]})]})})]}),v&&I["12ft"]&&e.jsxs(f,{className:"p-4",children:[e.jsx("h3",{className:"text-sm font-semibold mb-3",children:"Quick Actions (Click while processing)"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(d,{variant:"outline",size:"sm",onClick:ca,disabled:p,className:"bg-blue-50 dark:bg-blue-950 border-blue-300 hover:bg-blue-100",children:[p?e.jsx(q,{className:"h-3 w-3 mr-1 animate-spin"}):e.jsx($e,{className:"h-3 w-3 mr-1"}),"VirusTotal Security"]}),e.jsx(d,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs("a",{href:I["12ft"],target:"_blank",rel:"noopener noreferrer",children:[e.jsx(Ce,{className:"h-3 w-3 mr-1"}),"12ft.io Bypass"]})}),e.jsx(d,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs("a",{href:I.archive_is,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(Oa,{className:"h-3 w-3 mr-1"}),"Archive.is"]})}),e.jsx(d,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs("a",{href:I.wayback,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(Ls,{className:"h-3 w-3 mr-1"}),"Wayback Machine"]})})]})]}),t&&e.jsxs(sr,{activeTab:H,onTabChange:u,sections:Qt,onRunFramework:Zt,children:[H==="overview"&&e.jsxs(f,{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold break-words",children:t.title||"Untitled"}),t.author&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["By ",t.author]}),t.publish_date&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Published: ",t.publish_date]})]}),!t.is_saved&&e.jsxs("div",{className:"space-y-3 pb-2",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Add metadata before saving (optional)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(We,{placeholder:"Add note (optional)...",value:ae,onChange:s=>le(s.target.value),className:"flex-1"}),e.jsx(We,{placeholder:"Tags (comma-separated)...",value:re,onChange:s=>ge(s.target.value),className:"flex-1"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 pt-2 border-t",children:[e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>ta(t),disabled:F,children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),"Create ACH"]}),e.jsxs(d,{variant:"outline",size:"sm",onClick:rs,disabled:Ie||!t.extracted_text,children:[Ie?e.jsx(q,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(Te,{className:"h-4 w-4 mr-2"}),"DIME Analysis"]}),e.jsx(ba,{children:e.jsxs(Na,{children:[e.jsx(va,{asChild:!0,children:e.jsxs(d,{variant:t.is_saved?"outline":"default",size:"sm",onClick:ea,disabled:ks||t.is_saved,className:t.is_saved?"":"bg-green-600 hover:bg-green-700 text-white",children:[ks?e.jsx(q,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(Ve,{className:"h-4 w-4 mr-2"}),t.is_saved?"Saved":"Save Permanently"]})}),e.jsx(wa,{side:"bottom",className:"max-w-xs",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-semibold",children:"Save this analysis to:"}),e.jsxs("ul",{className:"text-sm space-y-0.5 ml-4 list-disc",children:[e.jsx("li",{children:"Keep it forever (no auto-deletion)"}),e.jsx("li",{children:"Access it anytime from your dashboard"}),e.jsx("li",{children:"Share with others via link"}),e.jsx("li",{children:"Build upon it in future investigations"})]}),!t.is_saved&&t.expires_at&&e.jsxs("p",{className:"text-xs text-amber-600 dark:text-amber-400 mt-2",children:[" Will be deleted in ",Math.ceil((new Date(t.expires_at).getTime()-Date.now())/(1e3*60*60*24))," days if not saved!"]})]})})]})}),e.jsxs(d,{variant:"default",size:"sm",onClick:Jt,children:[e.jsx(Pa,{className:"h-4 w-4 mr-2"}),"Export Report"]}),e.jsxs(d,{variant:"outline",size:"sm",onClick:Yt,disabled:ks,className:"bg-gradient-to-r from-blue-50 to-indigo-50 hover:from-blue-100 hover:to-indigo-100 dark:from-blue-950 dark:to-indigo-950 border-blue-200 dark:border-blue-800",children:[e.jsx(Se,{className:"h-4 w-4 mr-2"}),"Copy Summary"]}),!_s&&e.jsxs(d,{variant:"outline",size:"sm",onClick:Kt,disabled:ks,children:[e.jsx(Ft,{className:"h-4 w-4 mr-2"}),"Share Analysis"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[t.expires_at&&!t.is_saved&&e.jsxs(ms,{className:"bg-amber-50 border-amber-200 dark:bg-amber-950 dark:border-amber-800",children:[e.jsx(ds,{className:"h-4 w-4 text-amber-600"}),e.jsx(xs,{className:"text-amber-800 dark:text-amber-200",children:e.jsx("div",{className:"flex items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("strong",{children:"Temporary Analysis:"})," This will be automatically deleted in"," ",e.jsxs("strong",{children:[Math.ceil((new Date(t.expires_at).getTime()-Date.now())/(1e3*60*60*24))," days"]}),'. Click "Save Permanently" to keep it forever.']})})})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[t.is_saved&&e.jsxs(z,{variant:"secondary",className:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:[e.jsx(ss,{className:"h-3 w-3 mr-1"}),"Saved Permanently - Never Expires"]}),_s&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(z,{variant:"outline",className:"bg-blue-50 text-blue-700",children:[e.jsx(hs,{className:"h-3 w-3 mr-1"}),"Shareable"]}),e.jsxs(d,{variant:"ghost",size:"sm",onClick:()=>{navigator.clipboard.writeText(_s),n({title:"Link Copied",description:"Share URL copied to clipboard"})},children:[e.jsx(Se,{className:"h-4 w-4 mr-1"}),"Copy Link"]})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold",children:"Content"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{size:"sm",variant:as==="summary"?"default":"outline",onClick:()=>qs("summary"),children:"Summary"}),e.jsx(d,{size:"sm",variant:as==="fulltext"?"default":"outline",onClick:()=>qs("fulltext"),children:"Full Text"})]})]}),as==="summary"&&t.summary&&e.jsx("div",{className:"text-sm leading-relaxed",children:t.summary}),as==="fulltext"&&t.extracted_text&&e.jsxs("div",{children:[Ye&&e.jsxs("div",{className:"mb-3 flex items-center gap-2 p-2 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg",children:[e.jsxs("div",{className:"flex-1 text-sm",children:["Highlighting: ",e.jsx("span",{className:"font-medium",children:Ye})]}),e.jsxs(d,{size:"sm",variant:"ghost",onClick:Bt,className:"h-7",children:[e.jsx(ts,{className:"h-4 w-4 mr-1"}),"Clear"]})]}),e.jsxs("div",{id:"full-text-content",className:"max-h-[600px] overflow-y-auto",children:[e.jsx("div",{className:"text-sm leading-relaxed whitespace-pre-line bg-gray-50 dark:bg-gray-900 rounded-lg p-4",children:Ye?Gt(ut(t.extracted_text),Ye):ut(t.extracted_text)}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:[t.extracted_text.length.toLocaleString()," characters  ",t.word_count.toLocaleString()," words"]})]})]}),as==="fulltext"&&!t.extracted_text&&e.jsx("div",{className:"text-sm text-muted-foreground italic",children:"No full text available for this analysis."})]}),e.jsxs("div",{id:"citation-section",className:"border-t pt-4",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Citation"}),ze?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:e.jsx("p",{className:"text-sm font-serif",children:ze})}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[e.jsx(d,{variant:"outline",size:"sm",onClick:ra,children:Fs?e.jsxs(e.Fragment,{children:[e.jsx(ss,{className:"h-4 w-4 mr-2"}),"Copied!"]}):e.jsxs(e.Fragment,{children:[e.jsx(Se,{className:"h-4 w-4 mr-2"}),"Copy Citation"]})}),e.jsx(d,{variant:"outline",size:"sm",onClick:aa,disabled:Ns,children:Ns?e.jsxs(e.Fragment,{children:[e.jsx(ss,{className:"h-4 w-4 mr-2"}),"Saved!"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ve,{className:"h-4 w-4 mr-2"}),"Save to Library"]})}),e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>{const s=St(t,v),a=Ka(s);j(`/dashboard/tools/citations-generator?${a.toString()}`)},children:[e.jsx(Ct,{className:"h-4 w-4 mr-2"}),"Open in Citation Library"]})]})]}):e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Citation will be generated automatically after analysis completes"})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Quick Stats"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Word Count"}),e.jsx("p",{className:"font-semibold",children:t.word_count.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"People"}),e.jsx("p",{className:"font-semibold",children:t.entities?.people?.length||0})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Organizations"}),e.jsx("p",{className:"font-semibold",children:t.entities?.organizations?.length||0})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Locations"}),e.jsx("p",{className:"font-semibold",children:t.entities?.locations?.length||0})]})]})]})]}),H==="word-analysis"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs(f,{className:"p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Total Words"}),e.jsx("p",{className:"text-2xl font-bold",children:t.word_count.toLocaleString()})]}),e.jsxs(f,{className:"p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Unique Words"}),e.jsx("p",{className:"text-2xl font-bold",children:Object.keys(t.word_frequency||{}).length.toLocaleString()})]}),e.jsxs(f,{className:"p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Top Phrases"}),e.jsx("p",{className:"text-2xl font-bold",children:t.top_phrases?.length||0})]}),e.jsxs(f,{className:"p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Avg. Word Length"}),e.jsx("p",{className:"text-2xl font-bold",children:t.word_frequency?Math.round(Object.keys(t.word_frequency).reduce((s,a)=>s+a.length,0)/Object.keys(t.word_frequency).length):0})]})]}),e.jsxs(f,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 flex-wrap gap-2",children:[e.jsx("h3",{className:"font-semibold",children:"Word Cloud"}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{size:"sm",variant:de==="words"?"default":"outline",onClick:()=>Us("words"),children:"Words"}),e.jsx(d,{size:"sm",variant:de==="phrases"?"default":"outline",onClick:()=>Us("phrases"),children:"Phrases"}),e.jsx(d,{size:"sm",variant:de==="entities"?"default":"outline",onClick:()=>Us("entities"),children:"Entities"})]}),e.jsxs(Me,{children:[e.jsx(Ue,{asChild:!0,children:e.jsxs(d,{size:"sm",variant:"outline",children:[e.jsx(Ma,{className:"h-4 w-4 mr-2"}),"Export"]})}),e.jsxs(qe,{align:"end",children:[e.jsx(ja,{children:"Export Word Cloud"}),e.jsx(ns,{}),e.jsx(J,{onClick:()=>Ss("png",!1),children:"PNG (Image only)"}),e.jsx(J,{onClick:()=>Ss("png",!0),children:"PNG (With title & URL)"}),e.jsx(ns,{}),e.jsx(J,{onClick:()=>Ss("jpeg",!1),children:"JPEG (Image only)"}),e.jsx(J,{onClick:()=>Ss("jpeg",!0),children:"JPEG (With title & URL)"})]})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 dark:from-blue-950/20 dark:to-purple-950/20 rounded-lg p-8 min-h-[300px] flex flex-wrap items-center justify-center gap-4",id:"word-cloud-container",children:[de==="words"&&(()=>{const s=Object.entries(t.word_frequency||{}).filter(([r])=>!r.includes(" ")).sort(([,r],[,i])=>i-r).slice(0,10);if(s.length===0)return e.jsx("p",{className:"text-muted-foreground italic",children:"No single words found in analysis"});const a=Math.max(...s.map(([,r])=>r));return s.map(([r,i],m)=>{const y=20+i/a*36,$=["text-blue-600 dark:text-blue-400","text-purple-600 dark:text-purple-400","text-green-600 dark:text-green-400","text-orange-600 dark:text-orange-400","text-pink-600 dark:text-pink-400","text-indigo-600 dark:text-indigo-400"],O=$[m%$.length];return e.jsx("span",{className:`font-bold ${O} hover:scale-110 transition-transform cursor-default select-none`,style:{fontSize:`${y}px`,lineHeight:1.3},title:`${r}: ${i} times`,children:r},r)})})(),de==="phrases"&&t.top_phrases.filter(s=>s.phrase.includes(" ")).slice(0,10).map((s,a)=>{const r=Math.max(...t.top_phrases.filter($=>$.phrase.includes(" ")).map($=>$.count)),i=16,b=i+s.count/r*(48-i),S=["text-blue-600 dark:text-blue-400","text-purple-600 dark:text-purple-400","text-green-600 dark:text-green-400","text-orange-600 dark:text-orange-400","text-pink-600 dark:text-pink-400","text-indigo-600 dark:text-indigo-400"],y=S[a%S.length];return e.jsx("span",{className:`font-bold ${y} hover:scale-110 transition-transform cursor-default select-none text-center`,style:{fontSize:`${b}px`,lineHeight:1.3},title:`${s.phrase}: ${s.count} times`,children:s.phrase},a)}),de==="entities"&&(()=>{const a=[...(t.entities?.people||[]).map(i=>({...i,type:"person"})),...(t.entities?.organizations||[]).map(i=>({...i,type:"organization"})),...(t.entities?.locations||[]).map(i=>({...i,type:"location"}))].sort((i,m)=>m.count-i.count).slice(0,10),r=Math.max(...a.map(i=>i.count),1);return a.map(i=>{const S=18+i.count/r*34,y=i.type==="person"?"text-blue-600 dark:text-blue-400":i.type==="organization"?"text-green-600 dark:text-green-400":"text-orange-600 dark:text-orange-400",$=i.type==="person"?"Person":i.type==="organization"?"Organization":"Location";return e.jsx("span",{className:`font-bold ${y} hover:scale-110 transition-transform cursor-default select-none`,style:{fontSize:`${S}px`,lineHeight:1.3},title:`${i.name} (${$}): ${i.count} mentions`,children:i.name},`${i.type}-${i.name}`)})})()]}),de==="entities"?e.jsxs("div",{className:"flex items-center justify-center gap-4 mt-4 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-600 dark:bg-blue-400"}),e.jsx("span",{className:"text-muted-foreground",children:"People"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-600 dark:bg-green-400"}),e.jsx("span",{className:"text-muted-foreground",children:"Organizations"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-orange-600 dark:bg-orange-400"}),e.jsx("span",{className:"text-muted-foreground",children:"Locations"})]})]}):de==="phrases"?e.jsxs("div",{className:"space-y-2 mt-4",children:[e.jsxs("div",{className:"flex items-center justify-center flex-wrap gap-3 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-600 dark:bg-blue-400"}),e.jsx("span",{className:"text-muted-foreground",children:"Rank 1-2"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-purple-600 dark:bg-purple-400"}),e.jsx("span",{className:"text-muted-foreground",children:"Rank 3-4"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-600 dark:bg-green-400"}),e.jsx("span",{className:"text-muted-foreground",children:"Rank 5-6"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-orange-600 dark:bg-orange-400"}),e.jsx("span",{className:"text-muted-foreground",children:"Rank 7-8"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-pink-600 dark:bg-pink-400"}),e.jsx("span",{className:"text-muted-foreground",children:"Rank 9-10"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"Top 10 most common phrases (size = frequency)"})]}):e.jsx("p",{className:"text-xs text-muted-foreground mt-2 text-center",children:"Top 10 most frequent single words (size = frequency)"})]}),e.jsxs(f,{className:"p-6",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Top Phrases (2-10 words)"}),e.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:t.top_phrases.filter(s=>s.phrase.includes(" ")).slice(0,20).map((s,a)=>e.jsx("div",{className:"p-3 rounded-lg bg-gray-50 dark:bg-gray-800/50 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("span",{className:"text-lg font-bold text-muted-foreground/50 min-w-[32px]",children:["#",a+1]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[e.jsx("span",{className:"text-sm font-medium break-words",children:s.phrase}),e.jsxs("span",{className:"text-sm font-bold text-primary shrink-0",children:[s.count,""]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Z,{value:s.count/t.top_phrases[0].count*100,className:"h-1.5"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[s.count," ",s.count===1?"occurrence":"occurrences"]})]})]})]})},a))}),t.top_phrases.filter(s=>s.phrase.includes(" ")).length>20&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-4 text-center",children:["Showing top 20 of ",t.top_phrases.filter(s=>s.phrase.includes(" ")).length," phrases"]})]}),t.keyphrases&&t.keyphrases.length>0&&e.jsxs(f,{className:"p-6",children:[e.jsxs(Y,{className:"pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(se,{children:"Key Concepts & Terminology"}),e.jsxs(z,{variant:"secondary",children:[t.keyphrases.length," keyphrases"]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Important concepts extracted using TextRank-style analysis (centrality, domain relevance, importance)"})]}),e.jsx(X,{children:e.jsx("div",{className:"grid md:grid-cols-2 gap-3",children:t.keyphrases.sort((s,a)=>a.score-s.score).map((s,a)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg border bg-card hover:bg-accent/50 transition-colors",children:[e.jsx("div",{className:"shrink-0 w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center text-sm font-semibold text-primary",children:a+1}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-medium text-sm",children:s.phrase}),e.jsx(z,{variant:"outline",className:`text-xs ${s.category==="technology"?"border-blue-300 text-blue-700":s.category==="concept"?"border-purple-300 text-purple-700":s.category==="event"?"border-orange-300 text-orange-700":s.category==="location"?"border-green-300 text-green-700":"border-gray-300 text-gray-700"}`,children:s.category})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{value:s.score*100,className:"h-1.5 flex-1"}),e.jsxs("span",{className:"text-xs text-muted-foreground shrink-0",children:[(s.score*100).toFixed(0),"%"]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Relevance: ",s.relevance]})]})]},a))})})]}),t.topics&&t.topics.length>0&&e.jsxs(f,{className:"p-6",children:[e.jsxs(Y,{className:"pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(se,{children:"Topic Analysis (LDA)"}),e.jsxs(z,{variant:"secondary",children:[t.topics.length," topics"]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Main themes identified using Latent Dirichlet Allocation (coherence, coverage, keywords)"})]}),e.jsx(X,{className:"space-y-4",children:t.topics.sort((s,a)=>a.coverage-s.coverage).map((s,a)=>e.jsxs("div",{className:"p-4 rounded-lg border bg-gradient-to-r from-card to-accent/20",children:[e.jsx("div",{className:"flex items-start justify-between gap-4 mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-semibold text-base",children:s.name}),e.jsxs(z,{className:"bg-primary/10 text-primary border-primary/20",children:["Topic ",a+1]})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description})]})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Coherence"}),e.jsxs("span",{className:"text-xs font-semibold",children:[(s.coherence*100).toFixed(0),"%"]})]}),e.jsx(Z,{value:s.coherence*100,className:"h-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Coverage"}),e.jsxs("span",{className:"text-xs font-semibold",children:[(s.coverage*100).toFixed(0),"%"]})]}),e.jsx(Z,{value:s.coverage*100,className:"h-2 bg-green-100"})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-muted-foreground block mb-2",children:"Keywords:"}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:s.keywords.map((r,i)=>e.jsx(z,{variant:"secondary",className:"text-xs bg-primary/5 hover:bg-primary/10",children:r},i))})]})]},a))})]})]}),H==="sentiment"&&(t.sentiment_analysis?e.jsxs("div",{className:"space-y-6",children:[e.jsxs(f,{className:"p-6",children:[e.jsx(Y,{className:"pb-4",children:e.jsxs(se,{className:"flex items-center gap-2",children:[t.sentiment_analysis.overall==="positive"&&e.jsx(_t,{className:"h-6 w-6 text-green-600"}),t.sentiment_analysis.overall==="negative"&&e.jsx(Ua,{className:"h-6 w-6 text-red-600"}),(t.sentiment_analysis.overall==="neutral"||t.sentiment_analysis.overall==="mixed")&&e.jsx(qa,{className:"h-6 w-6 text-yellow-600"}),"Overall Sentiment: ",t.sentiment_analysis.overall.charAt(0).toUpperCase()+t.sentiment_analysis.overall.slice(1)]})}),e.jsxs(X,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Sentiment Score"}),e.jsx("span",{className:"font-semibold",children:t.sentiment_analysis.score.toFixed(2)})]}),e.jsx(Z,{value:(t.sentiment_analysis.score+1)*50,className:`h-3 ${t.sentiment_analysis.score>.3?"bg-green-200":t.sentiment_analysis.score<-.3?"bg-red-200":"bg-yellow-200"}`}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground mt-1",children:[e.jsx("span",{children:"Very Negative (-1.0)"}),e.jsx("span",{children:"Neutral (0)"}),e.jsx("span",{children:"Very Positive (+1.0)"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Confidence"}),e.jsxs("span",{className:"font-semibold",children:[(t.sentiment_analysis.confidence*100).toFixed(0),"%"]})]}),e.jsx(Z,{value:t.sentiment_analysis.confidence*100,className:"h-2 mt-2"})]})]})]}),t.sentiment_analysis.emotions&&e.jsxs(f,{className:"p-6",children:[e.jsx(Y,{className:"pb-4",children:e.jsx(se,{children:"Emotion Analysis"})}),e.jsx(X,{className:"space-y-3",children:Object.entries(t.sentiment_analysis.emotions).map(([s,a])=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-sm capitalize",children:s}),e.jsxs("span",{className:"text-sm font-semibold",children:[a,"%"]})]}),e.jsx(Z,{value:a,className:`h-2 ${s==="joy"?"bg-green-200":s==="anger"?"bg-red-200":s==="fear"?"bg-purple-200":s==="sadness"?"bg-blue-200":"bg-orange-200"}`})]},s))})]}),t.sentiment_analysis.keyInsights&&t.sentiment_analysis.keyInsights.length>0&&e.jsxs(f,{className:"p-6",children:[e.jsx(Y,{className:"pb-4",children:e.jsx(se,{children:"Key Insights"})}),e.jsx(X,{children:e.jsx("ul",{className:"space-y-2",children:t.sentiment_analysis.keyInsights.map((s,a)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(Ge,{className:"h-4 w-4 mt-0.5 text-blue-600 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:s})]},a))})})]}),t.sentiment_analysis.controversialClaims&&t.sentiment_analysis.controversialClaims.length>0&&e.jsxs(f,{className:"p-6 border-red-200",children:[e.jsx(Y,{className:"pb-4",children:e.jsxs(se,{className:"flex items-center gap-2 text-red-700",children:[e.jsx(ds,{className:"h-5 w-5"}),"Controversial Claims Detected"]})}),e.jsx(X,{className:"space-y-4",children:t.sentiment_analysis.controversialClaims.map((s,a)=>e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border border-red-200",children:[e.jsx("p",{className:"text-sm font-semibold mb-2 text-red-900",children:s.text}),e.jsxs("div",{className:"flex gap-4 text-xs text-red-700",children:[e.jsxs("span",{children:["Sentiment: ",s.sentiment]}),e.jsx("span",{children:""}),e.jsx("span",{children:s.reason})]})]},a))})]})]}):e.jsx(f,{className:"p-6",children:e.jsx("p",{className:"text-center text-muted-foreground",children:"Sentiment analysis not available for this content"})})),H==="entities"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-semibold",children:"Extracted Entities"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(d,{onClick:na,variant:"default",size:"sm",disabled:F,children:[e.jsx(Be,{className:"h-4 w-4 mr-2"}),F?"Processing...":"Auto-Create Actors & Relationships"]}),e.jsxs(d,{onClick:ia,variant:"outline",size:"sm",children:[e.jsx(Ve,{className:"h-4 w-4 mr-2"}),"Save All to Evidence"]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(f,{className:"p-4",children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx("span",{children:""}),e.jsxs("span",{children:["People (",t.entities?.people?.length||0,")"]})]}),e.jsxs("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:[(t.entities?.people||[]).slice(0,10).map((s,a)=>e.jsxs("div",{className:"text-sm flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsxs("span",{className:"text-muted-foreground ml-2",children:["(",s.count,")"]})]}),e.jsxs(Me,{children:[e.jsx(Ue,{asChild:!0,children:e.jsx(d,{size:"sm",variant:"ghost",className:"h-7 px-2",title:"Entity actions",children:e.jsx(es,{className:"h-3 w-3"})})}),e.jsxs(qe,{align:"end",children:[e.jsxs(J,{onClick:()=>Oe(s.name),children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),"Find in Text"]}),e.jsxs(J,{onClick:()=>Xe(s.name,"person"),disabled:me===s.name,children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),me===s.name?"Summarizing...":"Summarize"]}),e.jsx(ns,{}),e.jsxs(J,{onClick:()=>Es(s.name,"person"),children:[e.jsx(Ve,{className:"h-4 w-4 mr-2"}),"Save to Actors"]})]})]})]},a)),(!t.entities?.people||t.entities.people.length===0)&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"None found"})]})]}),e.jsxs(f,{className:"p-4",children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx("span",{children:""}),e.jsxs("span",{children:["Organizations (",t.entities?.organizations?.length||0,")"]})]}),e.jsxs("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:[(t.entities?.organizations||[]).slice(0,10).map((s,a)=>e.jsxs("div",{className:"text-sm flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsxs("span",{className:"text-muted-foreground ml-2",children:["(",s.count,")"]})]}),e.jsxs(Me,{children:[e.jsx(Ue,{asChild:!0,children:e.jsx(d,{size:"sm",variant:"ghost",className:"h-7 px-2",title:"Entity actions",children:e.jsx(es,{className:"h-3 w-3"})})}),e.jsxs(qe,{align:"end",children:[e.jsxs(J,{onClick:()=>Oe(s.name),children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),"Find in Text"]}),e.jsxs(J,{onClick:()=>Xe(s.name,"organization"),disabled:me===s.name,children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),me===s.name?"Summarizing...":"Summarize"]}),e.jsx(ns,{}),e.jsxs(J,{onClick:()=>Es(s.name,"organization"),children:[e.jsx(Ve,{className:"h-4 w-4 mr-2"}),"Save to Actors"]})]})]})]},a)),(!t.entities?.organizations||t.entities.organizations.length===0)&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"None found"})]})]}),e.jsxs(f,{className:"p-4",children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx("span",{children:""}),e.jsxs("span",{children:["Locations (",t.entities?.locations?.length||0,")"]})]}),e.jsxs("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:[(t.entities?.locations||[]).slice(0,10).map((s,a)=>e.jsxs("div",{className:"text-sm flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsxs("span",{className:"text-muted-foreground ml-2",children:["(",s.count,")"]})]}),e.jsxs(Me,{children:[e.jsx(Ue,{asChild:!0,children:e.jsx(d,{size:"sm",variant:"ghost",className:"h-7 px-2",title:"Entity actions",children:e.jsx(es,{className:"h-3 w-3"})})}),e.jsxs(qe,{align:"end",children:[e.jsxs(J,{onClick:()=>Oe(s.name),children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),"Find in Text"]}),e.jsxs(J,{onClick:()=>Xe(s.name,"location"),disabled:me===s.name,children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),me===s.name?"Summarizing...":"Summarize"]}),e.jsx(ns,{}),e.jsxs(J,{onClick:()=>Es(s.name,"location"),children:[e.jsx(Ve,{className:"h-4 w-4 mr-2"}),"Save to Places"]})]})]})]},a)),(!t.entities?.locations||t.entities.locations.length===0)&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"None found"})]})]}),e.jsxs(f,{className:"p-4",children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(Ls,{className:"h-4 w-4"}),e.jsxs("span",{children:["Dates (",t.entities?.dates?.length||0,")"]})]}),e.jsxs("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:[(t.entities?.dates||[]).slice(0,10).map((s,a)=>e.jsxs("div",{className:"text-sm flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsxs("span",{className:"text-muted-foreground ml-2",children:["(",s.count,")"]})]}),e.jsxs(Me,{children:[e.jsx(Ue,{asChild:!0,children:e.jsx(d,{size:"sm",variant:"ghost",className:"h-7 px-2",title:"Entity actions",children:e.jsx(es,{className:"h-3 w-3"})})}),e.jsxs(qe,{align:"end",children:[e.jsxs(J,{onClick:()=>Oe(s.name),children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),"Find in Text"]}),e.jsxs(J,{onClick:()=>Xe(s.name,"date"),disabled:me===s.name,children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),me===s.name?"Summarizing...":"Summarize"]})]})]})]},a)),(!t.entities?.dates||t.entities.dates.length===0)&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"None found"})]})]}),e.jsxs(f,{className:"p-4",children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx("span",{children:""}),e.jsxs("span",{children:["Money (",t.entities?.money?.length||0,")"]})]}),e.jsxs("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:[(t.entities?.money||[]).slice(0,10).map((s,a)=>e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsxs("span",{className:"text-muted-foreground ml-2",children:["(",s.count,")"]})]},a)),(!t.entities?.money||t.entities.money.length===0)&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"None found"})]})]}),e.jsxs(f,{className:"p-4",children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(He,{className:"h-4 w-4"}),e.jsxs("span",{children:["Events (",t.entities?.events?.length||0,")"]})]}),e.jsxs("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:[(t.entities?.events||[]).slice(0,10).map((s,a)=>e.jsxs("div",{className:"text-sm flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsxs("span",{className:"text-muted-foreground ml-2",children:["(",s.count,")"]})]}),e.jsxs(Me,{children:[e.jsx(Ue,{asChild:!0,children:e.jsx(d,{size:"sm",variant:"ghost",className:"h-7 px-2",title:"Entity actions",children:e.jsx(es,{className:"h-3 w-3"})})}),e.jsxs(qe,{align:"end",children:[e.jsxs(J,{onClick:()=>Oe(s.name),children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),"Find in Text"]}),e.jsxs(J,{onClick:()=>Xe(s.name,"event"),disabled:me===s.name,children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),me===s.name?"Summarizing...":"Summarize"]})]})]})]},a)),(!t.entities?.events||t.entities.events.length===0)&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"None found"})]})]}),e.jsxs(f,{className:"p-4",children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx("span",{children:""}),e.jsxs("span",{children:["Products (",t.entities?.products?.length||0,")"]})]}),e.jsxs("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:[(t.entities?.products||[]).slice(0,10).map((s,a)=>e.jsxs("div",{className:"text-sm flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsxs("span",{className:"text-muted-foreground ml-2",children:["(",s.count,")"]})]}),e.jsxs(Me,{children:[e.jsx(Ue,{asChild:!0,children:e.jsx(d,{size:"sm",variant:"ghost",className:"h-7 px-2",title:"Entity actions",children:e.jsx(es,{className:"h-3 w-3"})})}),e.jsxs(qe,{align:"end",children:[e.jsxs(J,{onClick:()=>Oe(s.name),children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),"Find in Text"]}),e.jsxs(J,{onClick:()=>Xe(s.name,"product"),disabled:me===s.name,children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),me===s.name?"Summarizing...":"Summarize"]})]})]})]},a)),(!t.entities?.products||t.entities.products.length===0)&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"None found"})]})]}),e.jsxs(f,{className:"p-4",children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx("span",{children:""}),e.jsxs("span",{children:["Percentages (",t.entities?.percentages?.length||0,")"]})]}),e.jsxs("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:[(t.entities?.percentages||[]).slice(0,10).map((s,a)=>e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsxs("span",{className:"text-muted-foreground ml-2",children:["(",s.count,")"]})]},a)),(!t.entities?.percentages||t.entities.percentages.length===0)&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"None found"})]})]}),e.jsxs(f,{className:"p-4",children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(Da,{className:"h-4 w-4"}),e.jsxs("span",{children:["Emails (",t.entities?.emails?.length||0,")"]})]}),e.jsxs("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:[(t.entities?.emails||[]).slice(0,10).map((s,a)=>e.jsxs("div",{className:"text-sm",children:[e.jsx("a",{href:`mailto:${s.email}`,className:"font-medium text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:s.email}),e.jsxs("span",{className:"text-muted-foreground ml-2",children:["(",s.count,")"]})]},a)),(!t.entities?.emails||t.entities.emails.length===0)&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"None found"})]})]})]})]}),H==="links"&&(()=>{const s=Array.isArray(t.links_analysis)?t.links_analysis:[];return s.length>0?e.jsx("div",{className:"space-y-4",children:e.jsxs(f,{children:[e.jsxs(Y,{children:[e.jsxs(se,{className:"flex items-center gap-2",children:[e.jsx(hs,{className:"h-5 w-5"}),"Link Analysis (",s.length," unique links)"]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"All links found in the article body (excluding navigation, headers, and footers). Helps identify sources, references, and related content."})]}),e.jsx(X,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Links"}),e.jsx("p",{className:"text-2xl font-bold",children:s.length})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"External Links"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:s.filter(a=>a.is_external).length})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Internal Links"}),e.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:s.filter(a=>!a.is_external).length})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Unique Domains"}),e.jsx("p",{className:"text-2xl font-bold",children:new Set(s.map(a=>a.domain)).size})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6 p-4 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 block",children:"Filter by Type"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(d,{variant:_e==="all"?"default":"outline",size:"sm",onClick:()=>l("all"),className:"flex-1",children:["All (",s.length,")"]}),e.jsxs(d,{variant:_e==="external"?"default":"outline",size:"sm",onClick:()=>l("external"),className:"flex-1",children:["External (",s.filter(a=>a.is_external).length,")"]}),e.jsxs(d,{variant:_e==="internal"?"default":"outline",size:"sm",onClick:()=>l("internal"),className:"flex-1",children:["Internal (",s.filter(a=>!a.is_external).length,")"]})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 block",children:"Sort by"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{variant:x==="references"?"default":"outline",size:"sm",onClick:()=>C("references"),className:"flex-1",children:"Most Referenced"}),e.jsx(d,{variant:x==="chronological"?"default":"outline",size:"sm",onClick:()=>C("chronological"),className:"flex-1",children:"Chronological"})]})]})]}),e.jsx("div",{className:"space-y-3",children:(()=>{let a=s;_e==="external"?a=a.filter(i=>i.is_external):_e==="internal"&&(a=a.filter(i=>!i.is_external));const r=[...a].sort((i,m)=>x==="chronological"?(i.first_occurrence_index||0)-(m.first_occurrence_index||0):m.count-i.count);return r.length>0?r.map((i,m)=>e.jsx("div",{className:"border-l-4 border-blue-500 dark:border-blue-400 pl-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:e.jsx("div",{className:"flex items-start justify-between gap-2",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsxs("a",{href:i.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium break-all flex items-center gap-1",children:[e.jsx(Ce,{className:"h-3 w-3 flex-shrink-0"}),i.url]})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-2",children:[e.jsx(z,{variant:"outline",className:"text-xs",children:i.domain}),e.jsx(z,{variant:i.is_external?"default":"secondary",className:"text-xs",children:i.is_external?"External":"Internal"}),e.jsxs("span",{className:"text-xs font-medium text-gray-700 dark:text-gray-300",children:["Referenced ",i.count," in article"]}),x==="chronological"&&e.jsxs(z,{variant:"outline",className:"text-xs",children:["Position #",(i.first_occurrence_index||0)+1]})]}),i.anchor_text.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("span",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400",children:["Anchor text:"," "]}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:i.anchor_text.map((b,S)=>e.jsxs(z,{variant:"outline",className:"text-xs bg-white dark:bg-gray-900",children:['"',b,'"']},S))})]})]})})},m)):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:["No ",_e==="all"?"":_e," links found"]})})()})]})})]})}):e.jsx(f,{className:"p-6",children:e.jsx("p",{className:"text-center text-muted-foreground",children:"No links were found in the article body"})})})(),H==="claims"&&(t?.claim_analysis||Hs?e.jsx(Za,{contentAnalysisId:t.id,claimAnalysis:t.claim_analysis||Hs}):e.jsx(f,{className:"p-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx($e,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground opacity-50"}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Claims Deception Analysis"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:"Extract factual claims and analyze them for potential deception using multiple detection methods: internal consistency, source credibility, evidence quality, logical coherence, temporal consistency, and specificity."}),e.jsxs(d,{onClick:ft,disabled:Ds||!t,size:"lg",children:[e.jsx($e,{className:"h-4 w-4 mr-2"}),Ds?"Analyzing Claims...":"Run Claims Analysis"]}),!t&&e.jsx("p",{className:"text-sm text-muted-foreground mt-4",children:"Analyze content first before running claims analysis"})]})})),H==="qa"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs(f,{className:"p-6",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Ask Questions About This Content"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Ask questions and get AI-powered answers with source citations from the analyzed content"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(he,{placeholder:"What would you like to know about this content?",value:ye,onChange:s=>be(s.target.value),className:"min-h-[60px]",onKeyDown:s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),bt())}}),e.jsx(d,{onClick:bt,disabled:G||!ye.trim(),className:"shrink-0",children:G?e.jsx(q,{className:"h-4 w-4 animate-spin"}):e.jsx(Ha,{className:"h-4 w-4"})})]})]}),ce.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold",children:"Q&A History"}),ce.map(s=>e.jsxs(f,{className:"p-6",children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(us,{className:"h-5 w-5 text-blue-600 shrink-0 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-lg",children:s.question}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[new Date(s.created_at).toLocaleString(),"  ",s.search_method," search"]})]})]})}),s.answer&&e.jsxs("div",{className:"ml-7 mb-4 p-4 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:s.answer}),s.confidence_score!==void 0&&e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Confidence:"}),e.jsx(Z,{value:s.confidence_score*100,className:"w-24 h-2"}),e.jsxs("span",{className:"text-xs font-medium",children:[Math.round(s.confidence_score*100),"%"]})]})]}),s.source_excerpts&&s.source_excerpts.length>0&&e.jsxs("div",{className:"ml-7 space-y-2",children:[e.jsx("p",{className:"text-xs font-semibold text-muted-foreground uppercase",children:"Source Excerpts:"}),s.source_excerpts.map((a,r)=>e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded border-l-2 border-blue-500",children:[e.jsxs("p",{className:"text-sm italic",children:['"',a.text,'"']}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Paragraph ",a.paragraph]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:""}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Relevance: ",Math.round(a.relevance*100),"%"]})]})]},r))]}),!s.has_complete_answer&&s.missing_data_notes&&e.jsxs("div",{className:"ml-7 mt-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg flex items-start gap-2",children:[e.jsx(ds,{className:"h-4 w-4 text-yellow-600 shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-300",children:"Incomplete Answer"}),e.jsx("p",{className:"text-xs text-yellow-700 dark:text-yellow-400 mt-1",children:s.missing_data_notes})]})]})]},s.id))]}),ce.length===0&&!G&&e.jsxs(f,{className:"p-8 text-center text-muted-foreground",children:[e.jsx(us,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No questions asked yet."}),e.jsx("p",{className:"text-sm mt-1",children:"Ask a question above to get started."})]})]}),H==="starbursting"&&e.jsxs(f,{className:"p-6",children:[e.jsx("h3",{className:"font-semibold mb-4",children:" Starbursting Analysis"}),Ke==="processing"&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(q,{className:"h-12 w-12 animate-spin text-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-lg font-medium",children:"Generating Starbursting Questions..."}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"This may take a moment. We're creating deep-dive 5W1H questions from your content."})]}),Ke==="complete"&&B&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-green-50 dark:bg-green-950 border border-green-200 dark:border-green-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ss,{className:"h-5 w-5 text-green-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-green-900 dark:text-green-100",children:"Starbursting Session Created!"}),e.jsx("p",{className:"text-sm text-green-700 dark:text-green-300 mt-1",children:B.central_topic}),e.jsxs("p",{className:"text-xs text-green-600 dark:text-green-400 mt-1",children:[B.sources_count," source",B.sources_count!==1?"s":""," analyzed"]})]})]})}),!B.framework_data?.data&&e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:["Debug: framework_data.data is ",B.framework_data?.data?"present":"missing",e.jsx("br",{}),"framework_data type: ",typeof B.framework_data,e.jsx("br",{}),"Has framework_data: ",B.framework_data?"yes":"no"]})}),B.framework_data?.data&&e.jsxs("div",{className:"space-y-4",children:[B.framework_data.data.who&&e.jsx(e.Fragment,{children:["who","what","when","where","why","how"].map(s=>{const a=B.framework_data.data[s]||[];if(a.length===0)return null;const r={who:{bg:"bg-purple-50 dark:bg-purple-900/20",badge:"bg-purple-100 text-purple-700 dark:bg-purple-900/50 dark:text-purple-300"},what:{bg:"bg-blue-50 dark:bg-blue-900/20",badge:"bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-300"},when:{bg:"bg-green-50 dark:bg-green-900/20",badge:"bg-green-100 text-green-700 dark:bg-green-900/50 dark:text-green-300"},where:{bg:"bg-yellow-50 dark:bg-yellow-900/20",badge:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/50 dark:text-yellow-300"},why:{bg:"bg-orange-50 dark:bg-orange-900/20",badge:"bg-orange-100 text-orange-700 dark:bg-orange-900/50 dark:text-orange-300"},how:{bg:"bg-pink-50 dark:bg-pink-900/20",badge:"bg-pink-100 text-pink-700 dark:bg-pink-900/50 dark:text-pink-300"}},i=r[s]||r.who;return e.jsxs(f,{className:`${i.bg} border-none`,children:[e.jsx(Y,{className:"pb-3",children:e.jsxs(se,{className:"flex items-center gap-2 text-lg",children:[e.jsx(z,{variant:"secondary",className:i.badge,children:s.toUpperCase()}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[a.filter(m=>m.answer&&m.answer.trim()!=="").length," answered / ",a.length," total"]})]})}),e.jsx(X,{children:e.jsx("ul",{className:"space-y-3",children:a.map((m,b)=>e.jsxs("li",{className:"space-y-1",children:[e.jsxs("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:[e.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[b+1,"."]})," Q: ",m.question]}),e.jsxs("div",{className:"text-gray-700 dark:text-gray-300 ml-5",children:["A: ",m.answer&&m.answer.trim()!==""?m.answer:e.jsx("span",{className:"italic text-gray-500 dark:text-gray-400",children:"No answer provided"})]})]},m.id||b))})})]},s)})}),B.framework_data.data.questions&&!B.framework_data.data.who&&e.jsxs(f,{children:[e.jsx(Y,{children:e.jsx(se,{className:"text-lg",children:"Generated Questions"})}),e.jsx(X,{children:e.jsx("ul",{className:"space-y-3",children:B.framework_data.data.questions.map((s,a)=>e.jsx("li",{className:"space-y-1",children:e.jsxs("div",{className:"flex items-start gap-2",children:[s.category&&e.jsx(z,{variant:"outline",className:"mt-0.5",children:s.category.toUpperCase()}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:[e.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[a+1,"."]})," Q: ",s.question]}),e.jsxs("div",{className:"text-gray-700 dark:text-gray-300 ml-5",children:["A: ",s.answer&&s.answer.trim()!==""?s.answer:e.jsx("span",{className:"italic text-gray-500 dark:text-gray-400",children:"No answer provided"})]})]})]})},s.id||a))})})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{variant:"outline",onClick:()=>la(B.session_id),className:"flex-1",disabled:nt,children:nt?e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"h-4 w-4 mr-2 animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Va,{className:"h-4 w-4 mr-2"}),"Generate More Questions"]})}),e.jsxs(d,{onClick:()=>j(`/dashboard/analysis-frameworks/starbursting/${B.session_id}/view`),className:"flex-1",children:[e.jsx(He,{className:"h-4 w-4 mr-2"}),"Open Full Analysis",e.jsx(Ce,{className:"h-4 w-4 ml-2"})]})]})]}),Ke==="error"&&e.jsx("div",{className:"bg-red-50 dark:bg-red-950 border border-red-200 dark:border-red-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ds,{className:"h-5 w-5 text-red-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-red-900 dark:text-red-100",children:"Failed to Create Starbursting Session"}),e.jsx("p",{className:"text-sm text-red-700 dark:text-red-300 mt-1",children:Ut}),e.jsx(d,{variant:"outline",size:"sm",onClick:()=>t?.id&&As(t.id),className:"mt-3",children:"Retry"})]})]})}),Ke==="idle"&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(He,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground opacity-50"}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Starbursting Analysis"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:"Generate deep-dive 5W1H questions (Who, What, When, Where, Why, How) to explore all angles of this content."}),t?e.jsxs(d,{onClick:()=>t.id&&As(t.id),size:"lg",children:[e.jsx(He,{className:"h-4 w-4 mr-2"}),"Create Starbursting Session"]}):e.jsx("p",{className:"text-sm text-muted-foreground mt-4",children:"Analyze content first to generate Starbursting questions"})]})]}),H==="dime"&&(t?.dime_analysis||U?e.jsxs("div",{className:"space-y-6",children:[(t?.dime_analysis||U)?.summary&&e.jsxs(f,{className:"p-6 bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-950 dark:to-indigo-950 border-blue-200",children:[e.jsx(Y,{className:"pb-4",children:e.jsxs(se,{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"h-5 w-5 text-blue-600"}),"DIME Framework Summary"]})}),e.jsx(X,{children:e.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed",children:(t?.dime_analysis||U).summary})})]}),(t?.dime_analysis||U)?.diplomatic&&e.jsxs(f,{className:"p-6 border-l-4 border-blue-500",children:[e.jsxs(Y,{className:"pb-4",children:[e.jsx(se,{className:"flex items-center gap-2 text-blue-700 dark:text-blue-400",children:" Diplomatic"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"International relations, negotiations, alliances, and diplomatic strategies"})]}),e.jsx(X,{className:"space-y-4",children:(t?.dime_analysis||U).diplomatic.map((s,a)=>e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-950/30 p-4 rounded-lg",children:[e.jsxs("div",{className:"font-semibold text-blue-900 dark:text-blue-100 mb-2",children:["Q",a+1,": ",s.question]}),e.jsxs("div",{className:"text-gray-700 dark:text-gray-300 text-sm leading-relaxed",children:[e.jsx("strong",{children:"A:"})," ",s.answer]})]},a))})]}),(t?.dime_analysis||U)?.information&&e.jsxs(f,{className:"p-6 border-l-4 border-purple-500",children:[e.jsxs(Y,{className:"pb-4",children:[e.jsx(se,{className:"flex items-center gap-2 text-purple-700 dark:text-purple-400",children:" Information"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Media narratives, public messaging, information operations, and communication strategies"})]}),e.jsx(X,{className:"space-y-4",children:(t?.dime_analysis||U).information.map((s,a)=>e.jsxs("div",{className:"bg-purple-50 dark:bg-purple-950/30 p-4 rounded-lg",children:[e.jsxs("div",{className:"font-semibold text-purple-900 dark:text-purple-100 mb-2",children:["Q",a+1,": ",s.question]}),e.jsxs("div",{className:"text-gray-700 dark:text-gray-300 text-sm leading-relaxed",children:[e.jsx("strong",{children:"A:"})," ",s.answer]})]},a))})]}),(t?.dime_analysis||U)?.military&&e.jsxs(f,{className:"p-6 border-l-4 border-red-500",children:[e.jsxs(Y,{className:"pb-4",children:[e.jsx(se,{className:"flex items-center gap-2 text-red-700 dark:text-red-400",children:" Military"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Defense capabilities, security concerns, armed forces, and military strategies"})]}),e.jsx(X,{className:"space-y-4",children:(t?.dime_analysis||U).military.map((s,a)=>e.jsxs("div",{className:"bg-red-50 dark:bg-red-950/30 p-4 rounded-lg",children:[e.jsxs("div",{className:"font-semibold text-red-900 dark:text-red-100 mb-2",children:["Q",a+1,": ",s.question]}),e.jsxs("div",{className:"text-gray-700 dark:text-gray-300 text-sm leading-relaxed",children:[e.jsx("strong",{children:"A:"})," ",s.answer]})]},a))})]}),(t?.dime_analysis||U)?.economic&&e.jsxs(f,{className:"p-6 border-l-4 border-green-500",children:[e.jsxs(Y,{className:"pb-4",children:[e.jsx(se,{className:"flex items-center gap-2 text-green-700 dark:text-green-400",children:" Economic"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Trade, sanctions, financial systems, economic policies, and fiscal implications"})]}),e.jsx(X,{className:"space-y-4",children:(t?.dime_analysis||U).economic.map((s,a)=>e.jsxs("div",{className:"bg-green-50 dark:bg-green-950/30 p-4 rounded-lg",children:[e.jsxs("div",{className:"font-semibold text-green-900 dark:text-green-100 mb-2",children:["Q",a+1,": ",s.question]}),e.jsxs("div",{className:"text-gray-700 dark:text-gray-300 text-sm leading-relaxed",children:[e.jsx("strong",{children:"A:"})," ",s.answer]})]},a))})]}),e.jsx(f,{className:"p-4 bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Need to refresh the analysis?"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Run DIME analysis again to update results"})]}),e.jsxs(d,{onClick:rs,disabled:Ie,variant:"outline",size:"sm",children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),Ie?"Analyzing...":"Re-run Analysis"]})]})})]}):e.jsx(f,{className:"p-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Te,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground opacity-50"}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"DIME Framework Analysis"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:"Analyze this content through the DIME framework lens: Diplomatic, Information, Military, and Economic dimensions."}),e.jsxs(d,{onClick:rs,disabled:Ie||!t,size:"lg",children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),Ie?"Analyzing...":"Run DIME Analysis"]}),!t&&e.jsx("p",{className:"text-sm text-muted-foreground mt-4",children:"Analyze content first before running DIME framework analysis"})]})}))]}),e.jsx("div",{id:"saved-links",className:"mt-8",children:e.jsxs(f,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx(Wa,{className:"h-5 w-5"}),o("pages.contentIntelligence.recentlySavedLinks")]}),e.jsx(d,{variant:"outline",size:"sm",disabled:!0,title:o("pages.contentIntelligence.fullLibraryComingSoon"),children:o("pages.contentIntelligence.viewAll")})]}),ie?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(q,{className:"h-6 w-6 animate-spin mx-auto mb-2"}),o("pages.contentIntelligence.loadingSavedLinks")]}):fe.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("p",{children:o("pages.contentIntelligence.noSavedLinks")}),e.jsx("p",{className:"text-sm mt-1",children:o("pages.contentIntelligence.noSavedLinksHint")})]}):e.jsx("div",{className:"space-y-3",children:fe.map(s=>e.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-800 transition",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-medium truncate",children:s.title||"Untitled"}),e.jsx("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline truncate block",children:s.url}),s.note&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.note}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[s.tags&&s.tags.length>0&&e.jsx("div",{className:"flex gap-1 flex-wrap",children:s.tags.map((a,r)=>e.jsx("span",{className:"text-xs px-2 py-0.5 bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded",children:a},r))}),e.jsx("span",{className:"text-xs text-muted-foreground",children:new Date(s.created_at).toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{variant:"outline",size:"sm",onClick:async()=>{if(M(s.url),s.note&&le(s.note),s.tags?.length&&ge(s.tags.join(", ")),s.is_processed&&s.analysis_id)try{E(!0);const a=await fetch("/api/content-intelligence/analyze-url",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:s.url,load_existing:!0,analysis_id:s.analysis_id})});if(a.ok){const r=await a.json();D(r.analysis),u("overview"),window.scrollTo({top:0,behavior:"smooth"}),n({title:"Success",description:"Loaded existing analysis"})}else throw new Error("Failed to load analysis")}catch(a){console.error("Load analysis error:",a),n({title:"Error",description:"Failed to load analysis. Click Analyze to create new one.",variant:"destructive"})}finally{E(!1)}else window.scrollTo({top:0,behavior:"smooth"}),Ws(s.url)},children:s.is_processed?o("pages.contentIntelligence.loadAnalysis"):o("pages.contentIntelligence.analyzeNow")}),s.is_processed&&s.analysis_id&&e.jsxs(e.Fragment,{children:[e.jsxs(d,{variant:"outline",size:"sm",onClick:async()=>{try{n({title:"Creating Starbursting session...",variant:"default"});const a=await fetch("/api/content-intelligence/starbursting",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({analysis_ids:[s.analysis_id],title:s.title||"Content Analysis"})});if(!a.ok)throw new Error("Failed to create Starbursting session");const r=await a.json();n({title:"Success",description:"Launching Starbursting analysis..."}),j(`/dashboard/analysis-frameworks/starbursting/${r.session_id}/view`)}catch(a){console.error("Starbursting launch error:",a),n({title:"Error",description:"Failed to launch Starbursting analysis",variant:"destructive"})}},title:"Launch Starbursting deep-dive analysis",children:[e.jsx(He,{className:"h-3 w-3 mr-1"}),"Starbursting"]}),e.jsx(d,{variant:"outline",size:"sm",onClick:async()=>{try{const a=await fetch("/api/content-intelligence/analyze-url"),r={id:s.analysis_id,user_id:1,url:s.url,url_normalized:s.url,content_hash:"",title:s.title,domain:s.domain||new URL(s.url).hostname,is_social_media:s.is_social_media,social_platform:s.social_platform,extracted_text:"",word_count:0,word_frequency:{},top_phrases:[],entities:{people:[],organizations:[],locations:[]},archive_urls:{},bypass_urls:{"12ft":""},processing_mode:"full",processing_duration_ms:0,created_at:s.created_at,updated_at:s.updated_at};jt(r)}catch{n({title:"Error",description:"Failed to create citation",variant:"destructive"})}},title:"Create citation from this link",children:e.jsx(Ct,{className:"h-4 w-4"})})]})]})]})},s.id))})]})}),e.jsx(ps,{open:Rs,onOpenChange:ys,children:e.jsxs(gs,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(fs,{children:[e.jsxs(js,{className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-5 w-5 text-blue-600"}),"VirusTotal Security Report"]}),e.jsx(Ts,{children:"Domain security analysis powered by VirusTotal"})]}),w&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:w.domain}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Last analyzed: ",new Date(w.lastAnalysisDate).toLocaleString()]})]}),e.jsx("div",{className:`p-4 rounded-lg ${w.riskLevel==="safe"?"bg-green-50 dark:bg-green-950 border border-green-300":w.riskLevel==="low"?"bg-blue-50 dark:bg-blue-950 border border-blue-300":w.riskLevel==="medium"?"bg-yellow-50 dark:bg-yellow-950 border border-yellow-300":w.riskLevel==="high"?"bg-orange-50 dark:bg-orange-950 border border-orange-300":"bg-red-50 dark:bg-red-950 border border-red-300"}`,children:e.jsx("p",{className:"text-sm font-medium",children:w.summary})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-semibold",children:"Safety Score"}),e.jsxs("span",{className:"text-2xl font-bold",children:[w.safetyScore,"/100"]})]}),e.jsx(Z,{value:w.safetyScore,className:"h-3"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Security Vendor Analysis"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-950 rounded-lg",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Harmless"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:w.stats.harmless})]}),e.jsxs("div",{className:"p-3 bg-red-50 dark:bg-red-950 rounded-lg",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Malicious"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:w.stats.malicious})]}),e.jsxs("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-950 rounded-lg",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Suspicious"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:w.stats.suspicious})]}),e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Undetected"}),e.jsx("p",{className:"text-2xl font-bold",children:w.stats.undetected})]})]})]}),w.votes&&(w.votes.harmless>0||w.votes.malicious>0)&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Community Votes"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),e.jsxs("span",{className:"text-sm",children:["Harmless: ",w.votes.harmless]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),e.jsxs("span",{className:"text-sm",children:["Malicious: ",w.votes.malicious]})]})]})]}),w.reputation!==0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Reputation Score"}),e.jsx("p",{className:"text-sm",children:w.reputation>0?e.jsxs("span",{className:"text-green-600 font-medium",children:["+",w.reputation," (Positive)"]}):e.jsxs("span",{className:"text-red-600 font-medium",children:[w.reputation," (Negative)"]})})]}),w.categories&&Object.keys(w.categories).length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Categories"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(w.categories).slice(0,5).map(([s,a])=>e.jsx("span",{className:"text-xs px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded",children:a},s))})]}),e.jsx("div",{className:"pt-4 border-t",children:e.jsxs(d,{variant:"outline",className:"w-full",onClick:()=>window.open(w.directLink,"_blank","noopener,noreferrer"),children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),"View Full Report on VirusTotal"]})})]})]})}),e.jsx(ps,{open:Wt,onOpenChange:Cs,children:e.jsxs(gs,{className:"max-w-2xl",children:[e.jsxs(fs,{children:[e.jsxs(js,{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"h-5 w-5"}),"Entity Summary: ",Fe?.entity]}),e.jsx(Ts,{children:"AI-generated summary based on the content"})]}),Fe&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-muted p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:e.jsx("div",{className:"h-8 w-8 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(Ee,{className:"h-4 w-4 text-primary"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:Fe.type.charAt(0).toUpperCase()+Fe.type.slice(1)}),e.jsx("p",{className:"text-sm leading-relaxed",children:Fe.summary})]})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>{Oe(Fe.entity),Cs(!1)},children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),"Find in Text"]}),e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>{navigator.clipboard.writeText(Fe.summary),n({title:"Copied",description:"Summary copied to clipboard"})},children:[e.jsx(Se,{className:"h-4 w-4 mr-2"}),"Copy Summary"]})]})]})]})})]})}export{jr as default};
