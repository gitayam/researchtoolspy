import{j as e}from"./ui-vendor-DBphXmDA.js";import{f as z,r as a}from"./react-vendor-CfYLSWvh.js";import{C as b,d as U,a as R,b as q,c as A}from"./card-BGAig-Dv.js";import{l as $,H as J,B as m,m as M,n as W,o as Y,p as G,I as i,q as K,S as Q,z as X,C as Z,E as ee,F as n,e as g}from"./index-QqleixXe.js";import{W as x,L as k,F as h,V as se,d as ae,ad as te,C as re,aj as ie,Y as ne}from"./icons-x9tcvtYN.js";import"./state-vendor-BXB5jEEt.js";function xe(){const u=z(),[l,S]=a.useState([]),[c,j]=a.useState(!0),[p,v]=a.useState(!1),[T,N]=a.useState(!1),[o,D]=a.useState(""),[f,I]=a.useState(""),[y,P]=a.useState(""),[C,E]=a.useState("medium"),[w,F]=a.useState(""),[d,L]=a.useState("");a.useEffect(()=>{O()},[]);const O=async()=>{try{j(!0);const s=await fetch("/api/investigation-packets/list",{credentials:"include"});if(!s.ok)throw new Error("Failed to load packets");const t=await s.json();t.success&&S(t.packets||[])}catch(s){console.error("Error loading packets:",s)}finally{j(!1)}},B=async()=>{if(!o.trim()){alert("Title is required");return}try{v(!0);const s=await fetch("/api/investigation-packets/create",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({title:o.trim(),description:f.trim()||void 0,investigation_type:y.trim()||void 0,priority:C,category:w.trim()||void 0,tags:d.trim()?d.split(",").map(r=>r.trim()).filter(Boolean):[]})});if(!s.ok){const r=await s.json();throw new Error(r.error||"Failed to create packet")}const t=await s.json();t.success&&t.packet&&u(`/investigations/${t.packet.id}`)}catch(s){console.error("Error creating packet:",s),alert(s instanceof Error?s.message:"Failed to create packet")}finally{v(!1)}},H=s=>{switch(s){case"critical":return"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400";case"high":return"bg-orange-100 text-orange-700 dark:bg-orange-900/20 dark:text-orange-400";case"medium":return"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/20 dark:text-yellow-400";case"low":return"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400";default:return"bg-gray-100 text-gray-700 dark:bg-gray-900/20 dark:text-gray-400"}},_=s=>{switch(s){case"active":return e.jsx(ne,{className:"h-4 w-4"});case"completed":return e.jsx(ie,{className:"h-4 w-4"});case"archived":return e.jsx(h,{className:"h-4 w-4"});default:return e.jsx(re,{className:"h-4 w-4"})}},V=s=>{switch(s){case"active":return"bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-400";case"completed":return"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400";case"archived":return"bg-gray-100 text-gray-700 dark:bg-gray-900/20 dark:text-gray-400";default:return"bg-gray-100 text-gray-700 dark:bg-gray-900/20 dark:text-gray-400"}};return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Investigation Packets"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Organize multi-source investigations with claims, evidence, and entities"})]}),e.jsxs($,{open:T,onOpenChange:N,children:[e.jsx(J,{asChild:!0,children:e.jsxs(m,{className:"gap-2",children:[e.jsx(x,{className:"h-4 w-4"}),"New Investigation"]})}),e.jsxs(M,{className:"max-w-2xl",children:[e.jsxs(W,{children:[e.jsx(Y,{children:"Create Investigation Packet"}),e.jsx(G,{children:"Start a new investigation to organize claims across multiple sources"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Title *"}),e.jsx(i,{value:o,onChange:s=>D(s.target.value),placeholder:"e.g., Red Hat CVE-2024-1234 Investigation"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Description"}),e.jsx(K,{value:f,onChange:s=>I(s.target.value),placeholder:"Brief overview of the investigation...",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Investigation Type"}),e.jsx(i,{value:y,onChange:s=>P(s.target.value),placeholder:"e.g., Breach Analysis"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Priority"}),e.jsxs(Q,{value:C,onValueChange:s=>E(s),children:[e.jsx(X,{children:e.jsx(Z,{})}),e.jsxs(ee,{children:[e.jsx(n,{value:"low",children:"Low"}),e.jsx(n,{value:"medium",children:"Medium"}),e.jsx(n,{value:"high",children:"High"}),e.jsx(n,{value:"critical",children:"Critical"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Category"}),e.jsx(i,{value:w,onChange:s=>F(s.target.value),placeholder:"e.g., Cybersecurity, Political, Financial"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Tags (comma-separated)"}),e.jsx(i,{value:d,onChange:s=>L(s.target.value),placeholder:"e.g., CVE-2024-1234, Red Hat, OpenSSL"})]}),e.jsx(m,{onClick:B,disabled:p,className:"w-full",children:p?e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"h-4 w-4 mr-2 animate-spin"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(x,{className:"h-4 w-4 mr-2"}),"Create Investigation"]})})]})]})]})]}),c&&e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(k,{className:"h-8 w-8 animate-spin text-muted-foreground"})}),!c&&l.length===0&&e.jsx(b,{children:e.jsx(U,{className:"py-12",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(h,{className:"h-12 w-12 mx-auto text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:"No investigations yet"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Create your first investigation packet to organize multi-source cases"})]}),e.jsxs(m,{onClick:()=>N(!0),className:"gap-2",children:[e.jsx(x,{className:"h-4 w-4"}),"Create Investigation"]})]})})}),!c&&l.length>0&&e.jsx("div",{className:"grid gap-4",children:l.map(s=>e.jsx(b,{className:"cursor-pointer hover:bg-accent transition-colors",onClick:()=>u(`/investigations/${s.id}`),children:e.jsxs(R,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs(q,{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-5 w-5"}),s.title]}),s.description&&e.jsx(A,{className:"mt-2",children:s.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(g,{className:H(s.priority),children:[e.jsx(se,{className:"h-3 w-3 mr-1"}),s.priority.toUpperCase()]}),e.jsxs(g,{className:V(s.status),children:[_(s.status),e.jsx("span",{className:"ml-1",children:s.status.toUpperCase()})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-4 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ae,{className:"h-4 w-4"}),s.content_count," ",s.content_count===1?"source":"sources"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(te,{className:"h-4 w-4"}),s.claim_count," ",s.claim_count===1?"claim":"claims"]}),e.jsxs("span",{className:"ml-auto",children:["Updated ",new Date(s.updated_at).toLocaleDateString()]})]}),s.tags.length>0&&e.jsx("div",{className:"flex gap-2 mt-3",children:s.tags.map((t,r)=>e.jsx(g,{variant:"outline",className:"text-xs",children:t},r))})]})},s.id))})]})}export{xe as InvestigationPacketsPage};
