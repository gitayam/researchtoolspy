import{j as t}from"./ui-vendor-DBphXmDA.js";import{f as E,j as _,r as C,L as H}from"./react-vendor-CfYLSWvh.js";import{o as y,s as v,p as P,b as L,$ as A,d as k,e as F,f as S,u as I}from"./state-vendor-BXB5jEEt.js";import{u as V,a as T,b as U,c as z,I as W,B as D}from"./index-QqleixXe.js";import{C as B,a as M,b as O,c as R,d as Z}from"./card-BGAig-Dv.js";import{c as g,i as $,f as b}from"./hash-auth-C-5ASbCe.js";import{C as q,J,L as K,s as G}from"./icons-x9tcvtYN.js";function j(s,n){try{var a=s()}catch(e){return n(e)}return a&&a.then?a.then(void 0,n):a}function Q(s,n){for(var a={};s.length;){var e=s[0],h=e.code,o=e.message,r=e.path.join(".");if(!a[r])if("unionErrors"in e){var i=e.unionErrors[0].errors[0];a[r]={message:i.message,type:i.code}}else a[r]={message:o,type:h};if("unionErrors"in e&&e.unionErrors.forEach(function(m){return m.errors.forEach(function(f){return s.push(f)})}),n){var l=a[r].types,u=l&&l[e.code];a[r]=k(r,n,a,h,u?[].concat(u,e.message):e.message)}s.shift()}return a}function X(s,n){for(var a={};s.length;){var e=s[0],h=e.code,o=e.message,r=e.path.join(".");if(!a[r])if(e.code==="invalid_union"&&e.errors.length>0){var i=e.errors[0][0];a[r]={message:i.message,type:i.code}}else a[r]={message:o,type:h};if(e.code==="invalid_union"&&e.errors.forEach(function(m){return m.forEach(function(f){return s.push(f)})}),n){var l=a[r].types,u=l&&l[e.code];a[r]=k(r,n,a,h,u?[].concat(u,e.message):e.message)}s.shift()}return a}function Y(s,n,a){if(a===void 0&&(a={}),(function(e){return"_def"in e&&typeof e._def=="object"&&"typeName"in e._def})(s))return function(e,h,o){try{return Promise.resolve(j(function(){return Promise.resolve(s[a.mode==="sync"?"parse":"parseAsync"](e,n)).then(function(r){return o.shouldUseNativeValidation&&y({},o),{errors:{},values:a.raw?Object.assign({},e):r}})},function(r){if((function(i){return Array.isArray(i?.issues)})(r))return{values:{},errors:v(Q(r.errors,!o.shouldUseNativeValidation&&o.criteriaMode==="all"),o)};throw r}))}catch(r){return Promise.reject(r)}};if((function(e){return"_zod"in e&&typeof e._zod=="object"})(s))return function(e,h,o){try{return Promise.resolve(j(function(){return Promise.resolve((a.mode==="sync"?P:L)(s,e,n)).then(function(r){return o.shouldUseNativeValidation&&y({},o),{errors:{},values:a.raw?Object.assign({},e):r}})},function(r){if((function(i){return i instanceof A})(r))return{values:{},errors:v(X(r.issues,!o.shouldUseNativeValidation&&o.criteriaMode==="all"),o)};throw r}))}catch(r){return Promise.reject(r)}};throw new Error("Invalid input: not a Zod schema")}function ce(){const{t:s}=V(),n=E(),[a]=_(),{loginWithHash:e,clearError:h}=T(),o=U(),r=z(),i=F({account_hash:S().min(1,s("auth.hashRequired")).refine(c=>{const d=g(c);return $(c)||/^[0-9a-f]{32}$/.test(d)},{message:s("auth.invalidHashFormat")})}),{register:l,handleSubmit:u,formState:{errors:m},setError:f,setValue:x,watch:ee}=I({resolver:Y(i)});C.useEffect(()=>{const c=a.get("hash");if(c){const d=b(c);x("account_hash",d)}},[a,x]);const N=async c=>{try{h();const d=g(c.account_hash);await e({account_hash:d});const p=a.get("redirect");n(p||"/dashboard")}catch(d){d?.status===401&&f("account_hash",{type:"manual",message:s("auth.invalidHash")})}},w=c=>{const d=g(c);return b(d)};return t.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800 p-4",children:t.jsxs(B,{className:"w-full max-w-md bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:[t.jsxs(M,{className:"space-y-1",children:[t.jsx(O,{className:"text-2xl font-bold text-center text-gray-900 dark:text-gray-100",children:s("auth.returnToWork")}),t.jsx(R,{className:"text-center text-gray-600 dark:text-gray-400",children:s("auth.returnToWorkDesc")})]}),t.jsx(Z,{children:t.jsxs("form",{onSubmit:u(N),className:"space-y-4",children:[r&&t.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 p-3 rounded-md",children:[t.jsx(q,{className:"h-4 w-4"}),typeof r=="string"?r:s("auth.loginError")]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("label",{htmlFor:"account_hash",className:"text-sm font-medium text-gray-700 dark:text-gray-300 flex items-center gap-2",children:[t.jsx(J,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"}),s("auth.bookmarkHash")]})}),t.jsx(W,{id:"account_hash",type:"text",placeholder:s("auth.hashPlaceholder"),...l("account_hash",{onChange:c=>{const d=w(c.target.value);c.target.value=d}}),className:`font-mono bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 border-gray-300 dark:border-gray-600 placeholder:text-gray-400 dark:placeholder:text-gray-500 ${m.account_hash?"border-red-500 dark:border-red-400":""}`,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false"}),m.account_hash&&t.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:m.account_hash.message}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:s("auth.hashHelperText")})]}),t.jsx(D,{type:"submit",className:"w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-bold py-6 text-lg shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-[1.02] active:scale-[0.98]",disabled:o,size:"lg",children:o?t.jsxs(t.Fragment,{children:[t.jsx(K,{className:"mr-2 h-5 w-5 animate-spin"}),s("auth.accessing")]}):t.jsxs(t.Fragment,{children:[t.jsx(G,{className:"mr-2 h-5 w-5"}),s("auth.accessWork")]})}),t.jsxs("div",{className:"text-center text-sm",children:[t.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[s("auth.noHash")," "]}),t.jsx(H,{to:"/register",className:"text-blue-600 dark:text-blue-400 hover:underline",children:s("auth.generateHash")})]})]})})]})})}export{ce as LoginPage};
