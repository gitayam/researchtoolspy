import{j as e}from"./ui-vendor-DBphXmDA.js";import{k as C,f as S,r as l}from"./react-vendor-CfYLSWvh.js";import{A,r as E,B as o,e as n}from"./index-QqleixXe.js";import{C as d,a as f,b as u,c as F,d as m}from"./card-BGAig-Dv.js";import{S as O}from"./separator-ozDNNLDu.js";import{_ as P,a5 as j,U as B,P as L,a1 as q}from"./icons-x9tcvtYN.js";import"./state-vendor-BXB5jEEt.js";function H(){const{token:i}=C(),c=S(),[a,g]=l.useState(null),[y,w]=l.useState(!0),[x,h]=l.useState(!1),[p,N]=l.useState(null);l.useEffect(()=>{i&&fetch(`/api/frameworks/public/${i}`).then(s=>{if(!s.ok)throw new Error("Framework not found");return s.json()}).then(g).catch(s=>N(s.message)).finally(()=>w(!1))},[i]);const v=async()=>{if(i){h(!0);try{const t=await(await fetch(`/api/frameworks/public/${i}/clone`,{method:"POST"})).json();if(t.saved_to==="workspace")c(t.redirect);else{const r=`draft_${a.framework_type}_new`;localStorage.setItem(r,JSON.stringify(t.framework)),c(`/frameworks/${a.framework_type}/create`),alert("Framework cloned! You're now working in guest mode (7 days). Sign in to save permanently.")}}catch(s){console.error("Failed to clone:",s),alert("Failed to clone framework")}finally{h(!1)}}},k=()=>{alert("Export functionality coming soon!")};if(y)return e.jsx("div",{className:"container mx-auto py-8",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("p",{className:"text-gray-500",children:"Loading public framework..."})})});if(p||!a)return e.jsxs("div",{className:"container mx-auto py-8",children:[e.jsx(A,{variant:"destructive",children:e.jsx(E,{children:p||"Framework not found"})}),e.jsxs(o,{onClick:()=>c("/"),className:"mt-4",variant:"outline",children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Go Home"]})]});const _=a.framework_type==="behavior"?"Behavior Analysis":a.framework_type==="comb-analysis"?"COM-B Analysis":a.framework_type.toUpperCase();return e.jsxs("div",{className:"container mx-auto py-8 max-w-6xl",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs(n,{variant:"secondary",className:"gap-1",children:[e.jsx(j,{className:"h-3 w-3"}),"Public"]}),e.jsx(n,{variant:"outline",children:_}),a.category&&e.jsx(n,{variant:"outline",className:"capitalize",children:a.category})]}),e.jsx("h1",{className:"text-3xl font-bold mt-2",children:a.title}),a.description&&e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:a.description}),e.jsxs("div",{className:"flex items-center gap-4 mt-3 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(j,{className:"h-4 w-4"}),a.view_count," views"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(B,{className:"h-4 w-4"}),a.clone_count," clones"]})]})]}),e.jsxs("div",{className:"flex gap-2 mb-6",children:[e.jsxs(o,{onClick:v,disabled:x,className:"gap-2",children:[e.jsx(L,{className:"h-4 w-4"}),x?"Cloning...":"Clone to My Workspace"]}),e.jsxs(o,{variant:"outline",onClick:k,className:"gap-2",children:[e.jsx(q,{className:"h-4 w-4"}),"Export"]})]}),e.jsx(O,{className:"mb-6"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(d,{children:[e.jsxs(f,{children:[e.jsx(u,{children:"Overview"}),e.jsx(F,{children:"Framework details and context"})]}),e.jsxs(m,{children:[a.data?.source_url&&e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:"Source"}),e.jsx("a",{href:a.data.source_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 dark:text-blue-400 hover:underline",children:a.data.source_url})]}),a.framework_type==="behavior"&&a.data?.location_context&&e.jsxs("div",{className:"space-y-3",children:[a.data.location_context.specific_locations?.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:"Locations"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.data.location_context.specific_locations.map((s,t)=>e.jsx(n,{variant:"secondary",children:s},t))})]}),a.data.behavior_settings?.settings?.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:"Settings"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.data.behavior_settings.settings.map((s,t)=>e.jsx(n,{variant:"outline",children:s},t))})]}),a.data.temporal_context?.frequency_pattern&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:"Frequency"}),e.jsx(n,{variant:"outline",className:"capitalize",children:a.data.temporal_context.frequency_pattern.replace("_"," ")})]})]})]})]}),Object.entries(a.data||{}).map(([s,t])=>!t||!Array.isArray(t)||t.length===0||["title","description","source_url","location_context","behavior_settings","temporal_context","eligibility","complexity","com_b_deficits","selected_interventions"].includes(s)?null:e.jsxs(d,{children:[e.jsx(f,{children:e.jsx(u,{className:"capitalize",children:s.replace(/_/g," ")})}),e.jsx(m,{children:e.jsx("ul",{className:"space-y-2",children:t.map((r,b)=>e.jsx("li",{className:"text-sm",children:typeof r=="string"?r:r.label||r.question||r.name||JSON.stringify(r)},b))})})]},s)),Object.keys(a.data||{}).filter(s=>Array.isArray(a.data[s])&&a.data[s].length>0).length===0&&e.jsx(d,{children:e.jsxs(m,{className:"py-12 text-center text-gray-500",children:[e.jsx("p",{children:"This framework doesn't have detailed content yet."}),e.jsx("p",{className:"text-sm mt-2",children:"Clone it to add your own analysis!"})]})})]}),e.jsx("div",{className:"mt-8 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:e.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:[e.jsx("strong",{children:"Want to use this framework?"}),' Click "Clone to My Workspace" to create your own copy.',!a.is_authenticated&&" Sign in to save permanently, or work in guest mode for 7 days."]})})]})}export{H as PublicFrameworkPage};
