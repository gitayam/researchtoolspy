import{j as e}from"./ui-vendor-DBphXmDA.js";import{f as A,r as n}from"./react-vendor-CfYLSWvh.js";import{u as $,B as p,e as w,I as N,q as B}from"./index-QqleixXe.js";import{C as y,a as I,b as k,c as C,d as T}from"./card-BGAig-Dv.js";import{_ as M,d as O,F as q,Z as z,W as S,L as H}from"./icons-x9tcvtYN.js";import"./state-vendor-BXB5jEEt.js";const G=[{id:"structured_research",name:"Structured Research",description:"Research with a defined question and methodology",icon:O,features:["Research question & plan","Hypothesis testing","Systematic evidence collection","Framework analyses"]},{id:"general_topic",name:"General Topic",description:"Open-ended exploration of a topic",icon:q,features:["Flexible exploration","Multiple perspectives","Evidence gathering","Can upgrade to structured later"]},{id:"rapid_analysis",name:"Rapid Analysis",description:"Quick framework application for immediate insights",icon:z,features:["Fast turnaround","Single framework focus","Targeted analysis","Immediate results"]}];function W(){const{t:a}=$(),h=A(),[o,g]=n.useState("type"),[r,D]=n.useState(null),[c,F]=n.useState(""),[x,P]=n.useState(""),[l,u]=n.useState([]),[d,v]=n.useState(""),[j,b]=n.useState(!1),_=s=>{D(s),g("details")},f=()=>{d.trim()&&!l.includes(d.trim())&&(u([...l,d.trim()]),v(""))},E=s=>{u(l.filter(t=>t!==s))},L=async()=>{if(!(!r||!c)){b(!0);try{const s=localStorage.getItem("omnicore_user_hash"),t=await fetch("/api/investigations",{method:"POST",headers:{"Content-Type":"application/json",...s&&{Authorization:`Bearer ${s}`}},body:JSON.stringify({title:c,description:x,type:r.id,tags:l})});if(t.ok){const i=await t.json();h(`/dashboard/investigations/${i.investigation.id}`)}else{const i=await t.json().catch(()=>({})),m=i.error||"Failed to create investigation",R=i.details?`

Details: ${i.details}`:"";alert(`${m}${R}`)}}catch(s){console.error("Error creating investigation:",s),alert("Network error: Unable to create investigation. Please check your connection and try again.")}finally{b(!1)}}};return e.jsxs("div",{className:"container mx-auto px-4 sm:px-6 py-4 sm:py-6 max-w-4xl",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs(p,{variant:"outline",onClick:()=>o==="type"?h("/dashboard/investigations"):g("type"),size:"sm",className:"mb-4",children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),a(o==="type"?"pages.newInvestigation.backToInvestigations":"pages.newInvestigation.back")]}),e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white",children:a("pages.newInvestigation.title")}),e.jsx("p",{className:"text-sm sm:text-base text-gray-600 dark:text-gray-400 mt-2",children:a(o==="type"?"pages.newInvestigation.chooseType":"pages.newInvestigation.provideDetails")}),!localStorage.getItem("omnicore_user_hash")&&e.jsx("div",{className:"mt-3 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:["ðŸ’¡ ",e.jsx("strong",{children:a("pages.newInvestigation.guestMode")})," ",a("pages.newInvestigation.guestModeDesc")]})})]}),o==="type"&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:G.map(s=>{const t=s.icon;return e.jsxs(y,{className:"hover:shadow-lg transition-shadow cursor-pointer hover:border-purple-300 dark:hover:border-purple-700",onClick:()=>_(s),children:[e.jsxs(I,{children:[e.jsx("div",{className:"flex items-center gap-3 mb-2",children:e.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900/20 rounded-lg",children:e.jsx(t,{className:"h-6 w-6 text-purple-600"})})}),e.jsx(k,{className:"text-lg",children:s.name}),e.jsx(C,{children:s.description})]}),e.jsx(T,{children:e.jsx("ul",{className:"space-y-2 text-sm",children:s.features.map((i,m)=>e.jsxs("li",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[e.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-purple-600"}),i]},m))})})]},s.id)})}),o==="details"&&r&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(y,{children:[e.jsxs(I,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(r.icon,{className:"h-5 w-5 text-purple-600"}),e.jsx(w,{variant:"secondary",children:r.name})]}),e.jsx(k,{children:a("pages.newInvestigation.investigationDetails")}),e.jsxs(C,{children:[a("pages.newInvestigation.provideDescription")," ",r.name.toLowerCase()]})]}),e.jsxs(T,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:[a("pages.newInvestigation.titleLabel")," *"]}),e.jsx(N,{value:c,onChange:s=>F(s.target.value),placeholder:a("pages.newInvestigation.titlePlaceholder"),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:a("pages.newInvestigation.descriptionLabel")}),e.jsx(B,{value:x,onChange:s=>P(s.target.value),placeholder:a("pages.newInvestigation.descriptionPlaceholder"),className:"w-full min-h-[100px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:a("pages.newInvestigation.tagsLabel")}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(N,{value:d,onChange:s=>v(s.target.value),onKeyPress:s=>s.key==="Enter"&&(s.preventDefault(),f()),placeholder:a("pages.newInvestigation.tagsPlaceholder"),className:"flex-1"}),e.jsx(p,{onClick:f,variant:"outline",size:"sm",children:e.jsx(S,{className:"h-4 w-4"})})]}),l.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:l.map(s=>e.jsxs(w,{variant:"secondary",className:"cursor-pointer hover:bg-red-100 dark:hover:bg-red-900/20",onClick:()=>E(s),children:[s," Ã—"]},s))})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(p,{variant:"outline",onClick:()=>g("type"),children:a("pages.newInvestigation.back")}),e.jsx(p,{onClick:L,disabled:!c||j,className:"bg-purple-600 hover:bg-purple-700",children:j?e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"h-4 w-4 mr-2 animate-spin"}),a("pages.newInvestigation.creating")]}):e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"h-4 w-4 mr-2"}),a("pages.newInvestigation.createInvestigation")]})})]})]})]})}export{W as default};
