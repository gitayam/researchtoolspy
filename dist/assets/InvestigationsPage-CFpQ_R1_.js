import{j as e}from"./ui-vendor-DBphXmDA.js";import{f as I,r as i}from"./react-vendor-CfYLSWvh.js";import{u as F,B as m,I as E,e as l}from"./index-QqleixXe.js";import{C as d,d as x,a as P,b as A,c as B}from"./card-BGAig-Dv.js";import{T as D,a as R,b as h,c as $}from"./tabs-If3dmLWi.js";import{W as b,a as q,L as H,F as N,d as y,Z as U}from"./icons-x9tcvtYN.js";import"./state-vendor-BXB5jEEt.js";function K(){const g=I(),{t:a}=F(),[f,w]=i.useState([]),[k,u]=i.useState(!0),[p,c]=i.useState(null),[r,C]=i.useState(""),[o,_]=i.useState("active");i.useEffect(()=>{j()},[o]);const j=async()=>{u(!0),c(null);try{const s=localStorage.getItem("omnicore_user_hash"),t=await fetch(`/api/investigations?status=${o}`,{headers:{...s&&{Authorization:`Bearer ${s}`}}});if(t.ok){const n=await t.json();w(n.investigations||[])}else if(t.status===401)c("Authentication required. Please log in to view your investigations.");else{const n=await t.json().catch(()=>({}));c(n.error||"Failed to load investigations")}}catch(s){console.error("Error loading investigations:",s),c("Network error: Unable to load investigations. Please check your connection.")}finally{u(!1)}},v=f.filter(s=>s.title.toLowerCase().includes(r.toLowerCase())||s.description?.toLowerCase().includes(r.toLowerCase())||s.tags.some(t=>t.toLowerCase().includes(r.toLowerCase()))),L=s=>{switch(s){case"structured_research":return e.jsx(y,{className:"h-4 w-4"});case"rapid_analysis":return e.jsx(U,{className:"h-4 w-4"});default:return e.jsx(N,{className:"h-4 w-4"})}},T=s=>{switch(s){case"structured_research":return"Structured Research";case"rapid_analysis":return"Rapid Analysis";default:return"General Topic"}},S=s=>{switch(s){case"active":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400";case"completed":return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400";case"archived":return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"container mx-auto px-4 sm:px-6 py-4 sm:py-6 max-w-7xl",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white",children:a("pages.investigations.title")}),e.jsx("p",{className:"text-sm sm:text-base text-gray-600 dark:text-gray-400 mt-2",children:a("pages.investigations.subtitle")})]}),e.jsxs(m,{onClick:()=>g("/dashboard/investigations/new"),className:"bg-purple-600 hover:bg-purple-700 w-full sm:w-auto",children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),a("pages.investigations.newInvestigation")]})]}),e.jsx(d,{className:"mb-6",children:e.jsx(x,{className:"pt-6",children:e.jsx("div",{className:"flex flex-col sm:flex-row gap-4",children:e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(E,{placeholder:a("pages.investigations.searchPlaceholder"),value:r,onChange:s=>C(s.target.value),className:"pl-10"})]})})})}),e.jsxs(D,{value:o,onValueChange:s=>_(s),children:[e.jsxs(R,{children:[e.jsx(h,{value:"active",children:a("pages.investigations.tabs.active")}),e.jsx(h,{value:"completed",children:a("pages.investigations.tabs.completed")}),e.jsx(h,{value:"archived",children:a("pages.investigations.tabs.archived")})]}),e.jsx($,{value:o,className:"mt-6",children:p?e.jsx(d,{children:e.jsx(x,{className:"py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-red-500 mb-4",children:"⚠️"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:a("pages.investigations.errorLoading")}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:p}),e.jsx(m,{onClick:()=>j(),variant:"outline",children:a("pages.investigations.tryAgain")})]})})}):k?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx(H,{className:"h-8 w-8 animate-spin text-purple-600"})}):v.length===0?e.jsx(d,{children:e.jsx(x,{className:"py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx(N,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:a("pages.investigations.noInvestigations")}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:a(r?"pages.investigations.adjustSearch":"pages.investigations.createFirst")}),!r&&e.jsxs(m,{onClick:()=>g("/dashboard/investigations/new"),className:"bg-purple-600 hover:bg-purple-700",children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),a("pages.investigations.createInvestigation")]})]})})}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:v.map(s=>e.jsxs(d,{className:"hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>g(`/dashboard/investigations/${s.id}`),children:[e.jsx(P,{children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[L(s.type),e.jsx(l,{variant:"outline",className:"text-xs",children:T(s.type)}),e.jsx(l,{className:S(s.status),children:s.status})]}),e.jsx(A,{className:"text-xl mb-2",children:s.title}),s.description&&e.jsx(B,{className:"line-clamp-2",children:s.description}),s.research_question_topic&&e.jsx("div",{className:"mt-2",children:e.jsxs(l,{variant:"secondary",className:"text-xs",children:[e.jsx(y,{className:"h-3 w-3 mr-1"}),a("pages.investigations.researchQuestion")]})})]})})}),e.jsxs(x,{children:[e.jsxs("div",{className:"grid grid-cols-4 gap-2 mb-3",children:[e.jsxs("div",{className:"text-center p-2 bg-gray-50 dark:bg-gray-800 rounded",children:[e.jsx("div",{className:"text-xl font-bold text-purple-600",children:s.evidence_count}),e.jsx("div",{className:"text-xs text-gray-500",children:a("pages.investigations.stats.evidence")})]}),e.jsxs("div",{className:"text-center p-2 bg-gray-50 dark:bg-gray-800 rounded",children:[e.jsx("div",{className:"text-xl font-bold text-blue-600",children:s.actor_count}),e.jsx("div",{className:"text-xs text-gray-500",children:a("pages.investigations.stats.actors")})]}),e.jsxs("div",{className:"text-center p-2 bg-gray-50 dark:bg-gray-800 rounded",children:[e.jsx("div",{className:"text-xl font-bold text-green-600",children:s.source_count}),e.jsx("div",{className:"text-xs text-gray-500",children:a("pages.investigations.stats.sources")})]}),e.jsxs("div",{className:"text-center p-2 bg-gray-50 dark:bg-gray-800 rounded",children:[e.jsx("div",{className:"text-xl font-bold text-orange-600",children:s.framework_count}),e.jsx("div",{className:"text-xs text-gray-500",children:a("pages.investigations.stats.analyses")})]})]}),s.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mb-3",children:[s.tags.slice(0,3).map((t,n)=>e.jsx(l,{variant:"secondary",className:"text-xs",children:t},n)),s.tags.length>3&&e.jsxs(l,{variant:"secondary",className:"text-xs",children:["+",s.tags.length-3," more"]})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Updated ",new Date(s.updated_at).toLocaleDateString()," by ",s.created_by_username]})]})]},s.id))})})]})]})}export{K as default};
