import{E as z}from"./FileSaver.min-Dgi0c_i4.js";import"./index-mX7ZjAZN.js";import"./index-QqleixXe.js";import"./ui-vendor-DBphXmDA.js";import"./react-vendor-CfYLSWvh.js";import"./state-vendor-BXB5jEEt.js";import"./icons-x9tcvtYN.js";import"./card-BGAig-Dv.js";import"./tabs-If3dmLWi.js";import"./checkbox-DueJeeKx.js";import"./purify.es-aGzT-_H7.js";import"./switch-BxNvahPI.js";import"./separator-ozDNNLDu.js";import"./slider-B52ikc1m.js";import"./tooltip-_NEsV_z7.js";import"./progress-Cg1bbsHw.js";import"./citation-library-DsFrzEV3.js";import"./radio-group-Dj8G6QwH.js";import"./viz-libs-B9RIjOsc.js";function O(t){const i={title:`Executive Summary: ${t.frameworkTitle}`,sections:[],keyMetrics:[]};i.sections.push({heading:"Analysis Overview",content:`This ${t.frameworkType} analysis was conducted on ${N(t.analysisDate)}${t.analyst?` by ${t.analyst}`:""}. ${t.purpose}`}),i.keyMetrics.push({label:"Analysis Elements",value:t.totalElements,context:"Total data points analyzed"},{label:"Completeness",value:`${t.completeness}%`,context:L(t.completeness)}),t.confidence!==void 0&&i.keyMetrics.push({label:"Analytical Confidence",value:`${t.confidence}%`,context:R(t.confidence)}),t.keyFindings.length>0&&i.sections.push({heading:"Key Findings",content:t.keyFindings.slice(0,5),priority:"high"}),t.recommendations.length>0&&i.sections.push({heading:"Recommendations",content:t.recommendations.slice(0,5),priority:"high"});const l=E(t.frameworkType,t.frameworkData);return l&&i.sections.push({heading:`${t.frameworkType} Insights`,content:l,priority:"medium"}),t.methodology&&i.sections.push({heading:"Methodology",content:t.methodology,priority:"low"}),t.limitations&&t.limitations.length>0&&i.sections.push({heading:"Limitations & Caveats",content:t.limitations,priority:"medium"}),i}function E(t,i){if(!i)return null;switch(t.toUpperCase()){case"SWOT":return I(i);case"ACH":return W(i);case"PMESII-PT":return M(i);case"COG":return P(i);case"PEST":return A(i);case"DIME":return D(i);case"STAKEHOLDER":return V(i);default:return null}}function I(t){const i=[],l=t.strengths?.length||0,o=t.weaknesses?.length||0,a=t.opportunities?.length||0,s=t.threats?.length||0;if(l+o+a+s===0)return[];const c=l+o,d=a+s;c>d*1.5?i.push("Analysis shows strong internal focus, consider expanding environmental scanning"):d>c*1.5?i.push("Analysis heavily weighted toward external factors, internal capabilities may need deeper examination"):i.push("Analysis demonstrates balanced coverage of internal and external factors");const x=l+a,e=o+s;return x>e*1.3?i.push("Overall positive outlook with strengths and opportunities outweighing challenges"):e>x*1.3&&i.push("Significant challenges identified, defensive strategies recommended"),l>0&&a>0&&i.push(`${l} strengths identified that could be leveraged against ${a} opportunities (SO strategies)`),o>0&&s>0&&i.push(`${o} weaknesses and ${s} threats require defensive strategies (WT strategies)`),i}function W(t){const i=[],l=t.hypotheses?.length||0,o=t.evidence?.length||0;return l===0||o===0?[]:(i.push(`Analysis evaluated ${l} competing hypotheses against ${o} pieces of evidence`),t.mostLikely&&i.push(`Most likely hypothesis: "${t.mostLikely.name}" with ${t.mostLikely.likelihood}% likelihood`),t.diagnosticEvidence&&i.push(`${t.diagnosticEvidence.count} highly diagnostic evidence items identified for hypothesis discrimination`),t.inconsistencies&&i.push(`${t.inconsistencies} evidence-hypothesis inconsistencies requiring further investigation`),i)}function M(t){const i=[],o=["political","military","economic","social","information","infrastructure","physical","time"].map(r=>({name:r,count:t[r]?.length||0})).filter(r=>r.count>0);if(o.length===0)return[];const a=o.reduce((r,c)=>r+c.count,0);i.push(`Analysis covers ${o.length} of 8 PMESII-PT domains with ${a} total factors`);const s=[...o].sort((r,c)=>c.count-r.count);return i.push(`Primary focus on ${s[0].name.toUpperCase()} domain (${s[0].count} factors)`),s.length>=3&&s[s.length-1].count<s[0].count*.3&&i.push(`${s[s.length-1].name.toUpperCase()} domain may require additional analysis`),t.interconnections&&i.push(`${t.interconnections.length} cross-domain interconnections identified, highlighting systemic complexity`),i}function P(t){const i=[];t.cog&&i.push(`Center of Gravity identified: ${t.cog}`);const l=t.criticalCapabilities?.length||0,o=t.criticalRequirements?.length||0,a=t.criticalVulnerabilities?.length||0;return l>0&&i.push(`${l} critical capabilities identified`),o>0&&i.push(`${o} critical requirements supporting the COG`),a>0&&i.push(`${a} critical vulnerabilities that could be exploited`),a>0&&o>0&&i.push(`Vulnerability-to-requirement ratio: ${(a/o).toFixed(2)} (higher indicates more exploitable weaknesses)`),i}function A(t){const i=[],l=t.political?.length||0,o=t.economic?.length||0,a=t.social?.length||0,s=t.technological?.length||0,r=l+o+a+s;if(r===0)return[];i.push(`Environmental scan identified ${r} factors across PEST dimensions`);const c=[{name:"Political",count:l},{name:"Economic",count:o},{name:"Social",count:a},{name:"Technological",count:s}].sort((d,x)=>x.count-d.count);return i.push(`Primary environmental driver: ${c[0].name} (${c[0].count} factors)`),c[c.length-1].count<r*.1&&i.push(`${c[c.length-1].name} factors may be underrepresented in analysis`),i}function D(t){const i=[],l=t.diplomatic?.length||0,o=t.informational?.length||0,a=t.military?.length||0,s=t.economic?.length||0,r=l+o+a+s;if(r===0)return[];i.push(`National power analysis identified ${r} elements across DIME framework`);const c=[{name:"Diplomatic",count:l},{name:"Informational",count:o},{name:"Military",count:a},{name:"Economic",count:s}].sort((e,n)=>n.count-e.count);i.push(`Dominant instrument of power: ${c[0].name} (${c[0].count} elements)`);const d=r/4;return c.every(e=>Math.abs(e.count-d)<d*.5)?i.push("Power distribution is relatively balanced across all instruments"):i.push("Power distribution shows significant asymmetry, consider multi-instrument integration"),i}function V(t){const i=[],l=t.stakeholders?.length||0;if(l===0)return[];if(i.push(`${l} stakeholders identified and mapped`),t.powerInterestMatrix){const o=t.powerInterestMatrix.manageClosely?.length||0,a=t.powerInterestMatrix.keepSatisfied?.length||0,s=t.powerInterestMatrix.keepInformed?.length||0;t.powerInterestMatrix.monitor?.length,i.push(`${o} stakeholders require close management (high power, high interest)`),a>o&&i.push("Significant high-power/low-interest stakeholders may need engagement to increase interest"),s>0&&i.push(`${s} stakeholders with high interest could be leveraged as advocates`)}return i}function N(t){return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"long",day:"numeric"}).format(t)}function L(t){return t>=90?"Highly comprehensive analysis":t>=70?"Substantial coverage":t>=50?"Moderate coverage, consider expanding":"Limited coverage, additional analysis recommended"}function R(t){return t>=80?"High confidence assessment":t>=60?"Moderate confidence":t>=40?"Low confidence, validate findings":"Very low confidence, requires significant additional analysis"}function U(t,i=600,l=400){const o=i/2,a=l/2,s=30,r={strengths:"#22c55e",opportunities:"#3b82f6",weaknesses:"#f59e0b",threats:"#ef4444"},c=(d,x,e,n)=>{let p=e+25;return d.slice(0,5).map(($,y)=>{const S=C($),T=S.length>40?S.substring(0,37)+"...":S,g=`<text x="${x+10}" y="${p}" font-size="11" fill="#1e293b">â€¢ ${T}</text>`;return p+=18,g}).join("")};return`
    <svg width="${i}" height="${l+s}" xmlns="http://www.w3.org/2000/svg">
      <!-- Title -->
      <text x="${i/2}" y="20" text-anchor="middle" font-size="16" font-weight="bold" fill="#1e293b">
        SWOT Analysis Matrix
      </text>

      <!-- Grid Lines -->
      <line x1="0" y1="${s}" x2="0" y2="${l+s}" stroke="#1e293b" stroke-width="2"/>
      <line x1="${i}" y1="${s}" x2="${i}" y2="${l+s}" stroke="#1e293b" stroke-width="2"/>
      <line x1="0" y1="${s}" x2="${i}" y2="${s}" stroke="#1e293b" stroke-width="2"/>
      <line x1="0" y1="${l+s}" x2="${i}" y2="${l+s}" stroke="#1e293b" stroke-width="2"/>
      <line x1="${o}" y1="${s}" x2="${o}" y2="${l+s}" stroke="#1e293b" stroke-width="2"/>
      <line x1="0" y1="${a+s}" x2="${i}" y2="${a+s}" stroke="#1e293b" stroke-width="2"/>

      <!-- Strengths (Top Left) -->
      <rect x="0" y="${s}" width="${o}" height="${a}" fill="${r.strengths}" opacity="0.1"/>
      <text x="${o/2}" y="${s+20}" text-anchor="middle" font-size="14" font-weight="bold" fill="${r.strengths}">
        STRENGTHS
      </text>
      <text x="${o/2}" y="${s+35}" text-anchor="middle" font-size="10" fill="#64748b">
        Internal â€¢ Positive
      </text>
      ${c(t.strengths,5,s)}

      <!-- Opportunities (Top Right) -->
      <rect x="${o}" y="${s}" width="${o}" height="${a}" fill="${r.opportunities}" opacity="0.1"/>
      <text x="${o+o/2}" y="${s+20}" text-anchor="middle" font-size="14" font-weight="bold" fill="${r.opportunities}">
        OPPORTUNITIES
      </text>
      <text x="${o+o/2}" y="${s+35}" text-anchor="middle" font-size="10" fill="#64748b">
        External â€¢ Positive
      </text>
      ${c(t.opportunities,o+5,s)}

      <!-- Weaknesses (Bottom Left) -->
      <rect x="0" y="${a+s}" width="${o}" height="${a}" fill="${r.weaknesses}" opacity="0.1"/>
      <text x="${o/2}" y="${a+s+20}" text-anchor="middle" font-size="14" font-weight="bold" fill="${r.weaknesses}">
        WEAKNESSES
      </text>
      <text x="${o/2}" y="${a+s+35}" text-anchor="middle" font-size="10" fill="#64748b">
        Internal â€¢ Negative
      </text>
      ${c(t.weaknesses,5,a+s)}

      <!-- Threats (Bottom Right) -->
      <rect x="${o}" y="${a+s}" width="${o}" height="${a}" fill="${r.threats}" opacity="0.1"/>
      <text x="${o+o/2}" y="${a+s+20}" text-anchor="middle" font-size="14" font-weight="bold" fill="${r.threats}">
        THREATS
      </text>
      <text x="${o+o/2}" y="${a+s+35}" text-anchor="middle" font-size="10" fill="#64748b">
        External â€¢ Negative
      </text>
      ${c(t.threats,o+5,a+s)}
    </svg>
  `}function k(t){const i=t.strengths.length+t.weaknesses.length,l=t.opportunities.length+t.threats.length,o=t.strengths.length+t.opportunities.length,a=t.weaknesses.length+t.threats.length,s=i+l;let r="balanced";i>l*1.5?r="internal-focused":l>i*1.5&&(r="external-focused");let c="neutral";return o>a*1.3?c="positive":a>o*1.3&&(c="negative"),{totalItems:s,internalVsExternal:{internal:i,external:l},positiveVsNegative:{positive:o,negative:a},balance:r,sentiment:c}}function w(t){return{SO:[`Leverage identified strengths to capitalize on ${t.opportunities.length} opportunities`,"Pursue growth strategies in areas where strengths align with market opportunities"],ST:[`Use organizational strengths to mitigate ${t.threats.length} identified threats`,"Diversify capabilities to reduce vulnerability to external threats"],WO:[`Address ${t.weaknesses.length} weaknesses to better exploit opportunities`,"Develop capabilities in weak areas where opportunities exist"],WT:["Implement defensive strategies to minimize weaknesses and avoid threats","Consider strategic partnerships to address critical vulnerabilities"]}}function C(t){return typeof t=="string"?t:t.text}function _(t){if(typeof t=="string")return 1;switch(t.confidence){case"high":return 1;case"medium":return .7;case"low":return .4;default:return .5}}function q(t){return typeof t=="string"?0:(t.evidence_ids?.length||0)*.15}function G(t){if(!t.options||t.options.length===0)return null;const i=(c,d)=>{const x=c.filter(n=>typeof n=="string"||!n.appliesTo||n.appliesTo.length===0?!0:n.appliesTo.includes(d)),e=x.reduce((n,p)=>{const $=_(p),y=q(p);return n+$+y},0);return{count:x.length,score:e}},l=t.options.map(c=>{const d=i(t.strengths,c),x=i(t.weaknesses,c),e=i(t.opportunities,c),n=i(t.threats,c),p=d.score+e.score,$=x.score+n.score,y=p*2-$*1.5,S=[...t.strengths,...t.weaknesses,...t.opportunities,...t.threats].filter(m=>typeof m=="string"||!m.appliesTo||m.appliesTo.length===0?!0:m.appliesTo.includes(c)),T=S.reduce((m,v)=>typeof v=="string"?m:m+(v.evidence_ids?.length||0),0),h=S.filter(m=>typeof m=="string"?!1:m.confidence==="high").length*.3+T*.1;let f;y>5&&p>$*2?f="highly_recommended":y>2&&p>$?f="recommended":y>-2?f="viable":f="not_recommended";const u=[];return d.count>0&&u.push(`${d.count} strengths identified (score: ${d.score.toFixed(1)})`),e.count>0&&u.push(`${e.count} opportunities available (score: ${e.score.toFixed(1)})`),x.count>0&&u.push(`${x.count} weaknesses to address (score: ${x.score.toFixed(1)})`),n.count>0&&u.push(`${n.count} threats to mitigate (score: ${n.score.toFixed(1)})`),p>$*1.5?u.push("Strong positive outlook"):$>p&&u.push("Challenging factors outweigh positives"),T>5&&u.push(`Well-evidenced with ${T} supporting items`),{option:c,strengthScore:d.score,weaknessScore:x.score,opportunityScore:e.score,threatScore:n.score,totalPositive:p,totalNegative:$,netScore:y,confidenceScore:h,evidenceCount:T,recommendation:f,reasoning:u}});l.sort((c,d)=>d.netScore-c.netScore);const o=l.map(c=>({option:c.option,strengths:Math.round(c.strengthScore*10)/10,weaknesses:Math.round(c.weaknessScore*10)/10,opportunities:Math.round(c.opportunityScore*10)/10,threats:Math.round(c.threatScore*10)/10,score:Math.round(c.netScore*10)/10})),a=[],s=l[0],r=l[1];return s.recommendation==="highly_recommended"?a.push(`${s.option} is the clear leader with strong positive factors and minimal risks`):s.recommendation==="recommended"?a.push(`${s.option} emerges as the best option with favorable characteristics`):s.recommendation==="viable"?a.push(`${s.option} is viable but requires careful risk management`):a.push("No option is strongly recommended - all have significant challenges"),r&&Math.abs(s.netScore-r.netScore)<1?a.push(`Close competition with ${r.option} (difference: ${Math.abs(s.netScore-r.netScore).toFixed(1)})`):r&&a.push(`${s.option} leads by ${(s.netScore-r.netScore).toFixed(1)} points`),s.strengthScore>(r?.strengthScore||0)*1.5&&a.push(`${s.option} has significantly stronger capabilities`),s.opportunityScore>(r?.opportunityScore||0)*1.5&&a.push(`${s.option} has better growth opportunities`),r&&s.threatScore<r.threatScore*.7&&a.push(`${s.option} faces fewer external risks`),{goal:t.goal,topChoice:s.option,scores:l,comparisonMatrix:o,reasoning:a}}async function he(t){const{title:i,description:l,sourceUrl:o,analyst:a,classification:s,swotData:r,includeVisualizations:c=!0,includeTOWS:d=!0,includeExecutiveSummary:x=!0}=t,e=new z;let n=20;const p=(g=20)=>{n>280-g&&(e.addPage(),n=20)},$={primary:[30,58,138],strengths:[34,197,94],weaknesses:[245,158,11],opportunities:[59,130,246],threats:[239,68,68]};if(e.setFillColor(...$.primary),e.rect(0,0,210,297,"F"),e.setTextColor(255,255,255),e.setFontSize(36),e.setFont("helvetica","bold"),e.text("SWOT ANALYSIS",105,100,{align:"center"}),e.setFontSize(24),e.setFont("helvetica","normal"),e.text(i,105,120,{align:"center",maxWidth:170}),r.goal&&(e.setFontSize(14),e.setFont("helvetica","italic"),e.text(`Goal: ${r.goal}`,105,145,{align:"center",maxWidth:170})),r.options&&r.options.length>0){e.setFontSize(12),e.setFont("helvetica","normal");const g=r.options.length<=3?`Options: ${r.options.join(" | ")}`:`Comparing ${r.options.length} Options`;e.text(g,105,r.goal?160:145,{align:"center",maxWidth:170})}if(e.setFontSize(12),e.text(new Date().toLocaleDateString(),105,250,{align:"center"}),a&&e.text(`Analyst: ${a}`,105,257,{align:"center"}),s&&(e.setFontSize(10),e.text(s.toUpperCase(),105,280,{align:"center"})),x){e.addPage(),n=20;const g=k(r),h={frameworkType:"SWOT",frameworkTitle:"SWOT Analysis",analysisDate:new Date,analyst:a,totalElements:g.totalItems,completeness:Math.min(100,g.totalItems/20*100),purpose:l||"Strategic analysis of internal strengths and weaknesses, and external opportunities and threats.",keyFindings:[`${g.totalItems} total factors identified across all four quadrants`,`Analysis is ${g.balance==="balanced"?"well-balanced":g.balance} with ${g.internalVsExternal.internal} internal and ${g.internalVsExternal.external} external factors`,`Overall sentiment is ${g.sentiment} (${g.positiveVsNegative.positive} positive vs ${g.positiveVsNegative.negative} negative factors)`,r.strengths.length>0?`${r.strengths.length} strengths identified that can be leveraged for strategic advantage`:"Limited strengths identified - capability building recommended",r.threats.length>0?`${r.threats.length} threats require mitigation strategies`:"Minimal external threats identified"],recommendations:[],frameworkData:r},f=O(h);e.setTextColor(0,0,0),e.setFontSize(20),e.setFont("helvetica","bold"),e.text("Executive Summary",20,n),n+=15,e.setFontSize(12),e.setFont("helvetica","bold"),e.text("Key Metrics",20,n),n+=8,e.setFontSize(10),e.setFont("helvetica","normal"),f.keyMetrics.forEach(u=>{p(15),e.setFont("helvetica","bold"),e.text(`${u.label}:`,25,n),e.setFont("helvetica","normal"),e.text(`${u.value}`,75,n),u.context&&(e.setTextColor(100,100,100),e.text(`(${u.context})`,95,n),e.setTextColor(0,0,0)),n+=6}),n+=5,f.sections.forEach(u=>{u.heading==="Key Findings"&&(p(25),e.setFontSize(12),e.setFont("helvetica","bold"),e.text(u.heading,20,n),n+=8,e.setFontSize(10),e.setFont("helvetica","normal"),(Array.isArray(u.content)?u.content:[u.content]).forEach((v,b)=>{p(15);const F=e.splitTextToSize(`${b+1}. ${v}`,165);e.text(F,25,n),n+=F.length*5+3}),n+=5)})}const y=G(r);if(y){p(45),e.setFontSize(16),e.setFont("helvetica","bold"),e.setTextColor(0,0,0),e.text("Decision Recommendation",20,n),n+=10,y.goal&&(e.setFontSize(11),e.setFont("helvetica","italic"),e.setTextColor(100,100,100),e.text(`Goal: ${y.goal}`,20,n),n+=8),p(35),e.setFillColor(34,197,94),e.rect(15,n-5,180,25,"F"),e.setFontSize(14),e.setFont("helvetica","bold"),e.setTextColor(255,255,255),e.text(`Recommended: ${y.topChoice}`,20,n+3),n+=12;const g=y.scores[0];e.setFontSize(10),e.setFont("helvetica","normal"),e.text(`Score: ${g.netScore.toFixed(1)} | ${g.recommendation.replace("_"," ").toUpperCase()}`,20,n+3),n+=18,e.setTextColor(0,0,0),p(20),e.setFontSize(11),e.setFont("helvetica","bold"),e.text("Key Reasoning:",20,n),n+=7,e.setFontSize(10),e.setFont("helvetica","normal"),y.reasoning.forEach(h=>{p(12);const f=e.splitTextToSize(`â€¢ ${h}`,165);e.text(f,25,n),n+=f.length*5+3}),n+=5,p(30),e.setFontSize(12),e.setFont("helvetica","bold"),e.text("Options Comparison Matrix",20,n),n+=8,e.setFillColor(240,240,240),e.rect(20,n-3,170,8,"F"),e.setFontSize(9),e.setFont("helvetica","bold"),e.text("Option",22,n+2),e.text("Str",70,n+2),e.text("Weak",90,n+2),e.text("Opp",115,n+2),e.text("Threat",135,n+2),e.text("Score",165,n+2),n+=10,e.setFont("helvetica","normal"),y.comparisonMatrix.forEach((h,f)=>{p(8),f===0?(e.setFillColor(34,197,94,.2),e.rect(20,n-3,170,8,"F")):f%2===0&&(e.setFillColor(250,250,250),e.rect(20,n-3,170,8,"F")),e.setFontSize(9);const u=h.option.length>20?h.option.substring(0,17)+"...":h.option;e.text(u,22,n+2),e.text(h.strengths.toString(),72,n+2),e.text(h.weaknesses.toString(),92,n+2),e.text(h.opportunities.toString(),117,n+2),e.text(h.threats.toString(),137,n+2),e.setFont("helvetica","bold");const m=h.score>5?[34,197,94]:h.score>2?[59,130,246]:h.score>0?[245,158,11]:[239,68,68];e.setTextColor(...m),e.text(h.score.toFixed(1),167,n+2),e.setTextColor(0,0,0),e.setFont("helvetica","normal"),n+=8}),n+=10,e.setFontSize(11),e.setFont("helvetica","bold"),e.text("Detailed Option Analysis",20,n),n+=8,y.scores.forEach((h,f)=>{p(30),e.setFontSize(11),e.setFont("helvetica","bold");const u=f===0?"ðŸ¥‡":f===1?"ðŸ¥ˆ":f===2?"ðŸ¥‰":`${f+1}.`;e.text(`${u} ${h.option}`,20,n),n+=7,e.setFontSize(9),e.setFont("helvetica","normal"),h.reasoning.forEach(m=>{p(10);const v=e.splitTextToSize(`  â€¢ ${m}`,165);e.text(v,22,n),n+=v.length*4.5+2}),n+=4}),n+=10}if(c){e.addPage(),n=20,e.setFontSize(18),e.setFont("helvetica","bold"),e.setTextColor(0,0,0),e.text("SWOT Matrix",105,n,{align:"center"}),n+=15;const g=U(r,170,170),h=new Blob([g],{type:"image/svg+xml"});URL.createObjectURL(h),e.setFontSize(10),e.setTextColor(100,100,100),e.text("(Matrix visualization)",105,n+85,{align:"center"}),n+=180}if(e.addPage(),n=20,e.setFontSize(18),e.setFont("helvetica","bold"),e.setTextColor(0,0,0),e.text("Detailed Analysis",105,n,{align:"center"}),n+=15,[{key:"strengths",label:"Strengths",data:r.strengths,color:$.strengths,desc:"Internal Positive Factors"},{key:"weaknesses",label:"Weaknesses",data:r.weaknesses,color:$.weaknesses,desc:"Internal Negative Factors"},{key:"opportunities",label:"Opportunities",data:r.opportunities,color:$.opportunities,desc:"External Positive Factors"},{key:"threats",label:"Threats",data:r.threats,color:$.threats,desc:"External Negative Factors"}].forEach(g=>{g.data.length>0&&(p(30),e.setFillColor(...g.color),e.rect(15,n-6,180,12,"F"),e.setFontSize(14),e.setFont("helvetica","bold"),e.setTextColor(255,255,255),e.text(g.label,20,n),n+=12,e.setFontSize(9),e.setTextColor(100,100,100),e.text(g.desc,20,n),n+=8,e.setFontSize(11),e.setFont("helvetica","normal"),e.setTextColor(0,0,0),g.data.slice(0,10).forEach((h,f)=>{p(20);const u=`${f+1}. ${C(h)}`,m=e.splitTextToSize(u,165);if(e.setFontSize(11),e.setFont("helvetica","normal"),e.setTextColor(0,0,0),e.text(m,25,n),n+=m.length*6+2,typeof h!="string"){const v=[];if(h.confidence&&v.push(`Confidence: ${h.confidence}`),h.evidence_ids&&h.evidence_ids.length>0&&v.push(`${h.evidence_ids.length} evidence item${h.evidence_ids.length>1?"s":""}`),h.tags&&h.tags.length>0&&v.push(`Tags: ${h.tags.join(", ")}`),r.options&&r.options.length>1&&h.appliesTo&&h.appliesTo.length>0){const b=h.appliesTo.length===r.options.length?"Applies to: All options":`Applies to: ${h.appliesTo.join(", ")}`;v.push(b)}if(v.length>0){e.setFontSize(9),e.setFont("helvetica","italic"),e.setTextColor(100,100,100);const b=`   [${v.join(" | ")}]`,F=e.splitTextToSize(b,160);e.text(F,27,n),n+=F.length*4.5+1,e.setTextColor(0,0,0)}}n+=3}),g.data.length>10&&(e.setFontSize(9),e.setTextColor(100,100,100),e.text(`... and ${g.data.length-10} more`,25,n),n+=6,e.setTextColor(0,0,0)),n+=8)}),d){e.addPage(),n=20,e.setFontSize(18),e.setFont("helvetica","bold"),e.setTextColor(0,0,0),e.text("TOWS Strategic Recommendations",105,n,{align:"center"}),n+=10,e.setFontSize(10),e.setFont("helvetica","italic"),e.setTextColor(100,100,100),e.text("Threats-Opportunities-Weaknesses-Strengths Matrix",105,n,{align:"center"}),n+=15;const g=w(r);[{key:"SO",label:"SO Strategies (Growth)",desc:"Use Strengths to exploit Opportunities",data:g.SO,color:[34,197,94]},{key:"ST",label:"ST Strategies (Diversification)",desc:"Use Strengths to mitigate Threats",data:g.ST,color:[245,158,11]},{key:"WO",label:"WO Strategies (Development)",desc:"Address Weaknesses to exploit Opportunities",data:g.WO,color:[59,130,246]},{key:"WT",label:"WT Strategies (Defensive)",desc:"Minimize Weaknesses and avoid Threats",data:g.WT,color:[239,68,68]}].forEach(f=>{p(25),e.setFontSize(14),e.setFont("helvetica","bold"),e.setTextColor(...f.color),e.text(f.label,20,n),n+=7,e.setFontSize(9),e.setFont("helvetica","italic"),e.setTextColor(100,100,100),e.text(f.desc,20,n),n+=8,e.setFontSize(10),e.setFont("helvetica","normal"),e.setTextColor(0,0,0),f.data.forEach((u,m)=>{p(12);const v=e.splitTextToSize(`${m+1}. ${u}`,165);e.text(v,25,n),n+=v.length*5+3}),n+=8})}e.addPage(),n=20,e.setFontSize(16),e.setFont("helvetica","bold"),e.setTextColor(0,0,0),e.text("Methodology",20,n),n+=12,e.setFontSize(10),e.setFont("helvetica","normal"),["SWOT Analysis is a strategic planning framework that evaluates:","","â€¢ Strengths: Internal attributes and resources that support successful outcomes","â€¢ Weaknesses: Internal factors that could hinder success","â€¢ Opportunities: External factors that could be exploited for advantage","â€¢ Threats: External challenges that could cause trouble","","TOWS Matrix extends SWOT by generating actionable strategies:","","â€¢ SO (Strengths-Opportunities): Growth strategies leveraging internal capabilities","â€¢ ST (Strengths-Threats): Diversification strategies using strengths defensively","â€¢ WO (Weaknesses-Opportunities): Development strategies to build capabilities","â€¢ WT (Weaknesses-Threats): Defensive strategies to minimize risk","","This analysis was generated using the Research Analysis Platform."].forEach(g=>{if(p(8),g==="")n+=4;else{const h=e.splitTextToSize(g,170);e.text(h,20,n),n+=h.length*5+2}}),e.save(`${i.replace(/[^a-z0-9]/gi,"_")}_SWOT_Analysis.pdf`)}function ge(t){const i=k(t),l=w(t),o=[];return o.push(`**Strategic Position:** ${i.totalItems} factors identified with a ${i.sentiment} outlook`),i.balance==="internal-focused"?o.push(`**Focus:** Analysis is heavily internal (${i.internalVsExternal.internal} internal vs ${i.internalVsExternal.external} external). Consider expanding environmental scanning.`):i.balance==="external-focused"?o.push(`**Focus:** Analysis is heavily external (${i.internalVsExternal.external} external vs ${i.internalVsExternal.internal} internal). Consider deeper internal capability assessment.`):o.push(`**Focus:** Well-balanced analysis (${i.internalVsExternal.internal} internal, ${i.internalVsExternal.external} external factors)`),i.sentiment==="positive"?o.push(`**Outlook:** Positive strategic position with ${i.positiveVsNegative.positive} positive factors outweighing ${i.positiveVsNegative.negative} challenges`):i.sentiment==="negative"?o.push(`**Outlook:** Challenging environment with ${i.positiveVsNegative.negative} negative factors. Defensive strategies recommended.`):o.push(`**Outlook:** Neutral balance between positive (${i.positiveVsNegative.positive}) and negative (${i.positiveVsNegative.negative}) factors`),t.strengths.length>0&&t.opportunities.length>0&&o.push(`**Growth Potential:** ${t.strengths.length} strengths can be leveraged against ${t.opportunities.length} opportunities`),t.weaknesses.length>0&&t.threats.length>0&&o.push(`**Risk Mitigation:** ${t.weaknesses.length} weaknesses and ${t.threats.length} threats require defensive strategies`),l.SO.length>0&&o.push(`**Top SO Strategy:** ${l.SO[0]}`),o}export{k as analyzeSWOTData,U as createSWOTMatrixSVG,G as generateDecisionRecommendation,he as generateEnhancedSWOTPDF,O as generateExecutiveSummary,ge as generateSWOTInsightsSummary,w as generateTOWSStrategies,_ as getConfidenceWeight,q as getEvidenceBonus,C as itemToString};
