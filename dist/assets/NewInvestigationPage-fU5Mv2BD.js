import{j as e}from"./ui-vendor-DBphXmDA.js";import{f as A,r}from"./react-vendor-CfYLSWvh.js";import{B as d,e as b,I as N,q as O}from"./index-DGGXJgUa.js";import{C as y,a as k,b as w,c as C,d as T}from"./card-BQo7RV_Z.js";import{_ as R,d as $,F as L,Z as q,W as S,L as z}from"./icons-x9tcvtYN.js";import"./state-vendor-BXB5jEEt.js";const G=[{id:"structured_research",name:"Structured Research",description:"Research with a defined question and methodology",icon:$,features:["Research question & plan","Hypothesis testing","Systematic evidence collection","Framework analyses"]},{id:"general_topic",name:"General Topic",description:"Open-ended exploration of a topic",icon:L,features:["Flexible exploration","Multiple perspectives","Evidence gathering","Can upgrade to structured later"]},{id:"rapid_analysis",name:"Rapid Analysis",description:"Quick framework application for immediate insights",icon:q,features:["Fast turnaround","Single framework focus","Targeted analysis","Immediate results"]}];function Q(){const h=A(),[l,m]=r.useState("type"),[i,I]=r.useState(null),[o,D]=r.useState(""),[x,F]=r.useState(""),[n,u]=r.useState([]),[c,g]=r.useState(""),[v,j]=r.useState(!1),_=s=>{I(s),m("details")},f=()=>{c.trim()&&!n.includes(c.trim())&&(u([...n,c.trim()]),g(""))},E=s=>{u(n.filter(a=>a!==s))},P=async()=>{if(!(!i||!o)){j(!0);try{const s=localStorage.getItem("omnicore_user_hash"),a=await fetch("/api/investigations",{method:"POST",headers:{"Content-Type":"application/json",...s&&{Authorization:`Bearer ${s}`}},body:JSON.stringify({title:o,description:x,type:i.id,tags:n})});if(a.ok){const t=await a.json();h(`/dashboard/investigations/${t.investigation.id}`)}else{const t=await a.json().catch(()=>({})),p=t.error||"Failed to create investigation",B=t.details?`

Details: ${t.details}`:"";alert(`${p}${B}`)}}catch(s){console.error("Error creating investigation:",s),alert("Network error: Unable to create investigation. Please check your connection and try again.")}finally{j(!1)}}};return e.jsxs("div",{className:"container mx-auto px-4 sm:px-6 py-4 sm:py-6 max-w-4xl",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs(d,{variant:"outline",onClick:()=>l==="type"?h("/dashboard/investigations"):m("type"),size:"sm",className:"mb-4",children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),l==="type"?"Back to Investigations":"Back"]}),e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white",children:"Create New Investigation"}),e.jsx("p",{className:"text-sm sm:text-base text-gray-600 dark:text-gray-400 mt-2",children:l==="type"?"Choose your investigation type":"Provide investigation details"}),!localStorage.getItem("omnicore_user_hash")&&e.jsx("div",{className:"mt-3 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:["ðŸ’¡ ",e.jsx("strong",{children:"Guest Mode:"})," You're creating an investigation without logging in. You can still collaborate and share it with others."]})})]}),l==="type"&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:G.map(s=>{const a=s.icon;return e.jsxs(y,{className:"hover:shadow-lg transition-shadow cursor-pointer hover:border-purple-300 dark:hover:border-purple-700",onClick:()=>_(s),children:[e.jsxs(k,{children:[e.jsx("div",{className:"flex items-center gap-3 mb-2",children:e.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900/20 rounded-lg",children:e.jsx(a,{className:"h-6 w-6 text-purple-600"})})}),e.jsx(w,{className:"text-lg",children:s.name}),e.jsx(C,{children:s.description})]}),e.jsx(T,{children:e.jsx("ul",{className:"space-y-2 text-sm",children:s.features.map((t,p)=>e.jsxs("li",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[e.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-purple-600"}),t]},p))})})]},s.id)})}),l==="details"&&i&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(y,{children:[e.jsxs(k,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(i.icon,{className:"h-5 w-5 text-purple-600"}),e.jsx(b,{variant:"secondary",children:i.name})]}),e.jsx(w,{children:"Investigation Details"}),e.jsxs(C,{children:["Provide a title and description for your ",i.name.toLowerCase()]})]}),e.jsxs(T,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Title *"}),e.jsx(N,{value:o,onChange:s=>D(s.target.value),placeholder:"Enter a descriptive title for your investigation",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Description (Optional)"}),e.jsx(O,{value:x,onChange:s=>F(s.target.value),placeholder:"Describe the purpose and scope of this investigation",className:"w-full min-h-[100px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Tags (Optional)"}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(N,{value:c,onChange:s=>g(s.target.value),onKeyPress:s=>s.key==="Enter"&&(s.preventDefault(),f()),placeholder:"Add tags...",className:"flex-1"}),e.jsx(d,{onClick:f,variant:"outline",size:"sm",children:e.jsx(S,{className:"h-4 w-4"})})]}),n.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:n.map(s=>e.jsxs(b,{variant:"secondary",className:"cursor-pointer hover:bg-red-100 dark:hover:bg-red-900/20",onClick:()=>E(s),children:[s," Ã—"]},s))})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(d,{variant:"outline",onClick:()=>m("type"),children:"Back"}),e.jsx(d,{onClick:P,disabled:!o||v,className:"bg-purple-600 hover:bg-purple-700",children:v?e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"h-4 w-4 mr-2 animate-spin"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"h-4 w-4 mr-2"}),"Create Investigation"]})})]})]})]})}export{Q as default};
