import{j as e}from"./ui-vendor-DBphXmDA.js";import{f as S,r}from"./react-vendor-CfYLSWvh.js";import{B as m,I,e as l}from"./index-DGGXJgUa.js";import{C as o,d,a as A,b as E,c as F}from"./card-BQo7RV_Z.js";import{T as B,a as D,b as g,c as P}from"./tabs-Dznm0vhG.js";import{W as N,a as R,L as $,F as y,d as b,Z as q}from"./icons-x9tcvtYN.js";import"./state-vendor-BXB5jEEt.js";function V(){const x=S(),[v,f]=r.useState([]),[w,h]=r.useState(!0),[u,c]=r.useState(null),[a,k]=r.useState(""),[n,C]=r.useState("active");r.useEffect(()=>{j()},[n]);const j=async()=>{h(!0),c(null);try{const s=localStorage.getItem("omnicore_user_hash"),t=await fetch(`/api/investigations?status=${n}`,{headers:{...s&&{Authorization:`Bearer ${s}`}}});if(t.ok){const i=await t.json();f(i.investigations||[])}else if(t.status===401)c("Authentication required. Please log in to view your investigations.");else{const i=await t.json().catch(()=>({}));c(i.error||"Failed to load investigations")}}catch(s){console.error("Error loading investigations:",s),c("Network error: Unable to load investigations. Please check your connection.")}finally{h(!1)}},p=v.filter(s=>s.title.toLowerCase().includes(a.toLowerCase())||s.description?.toLowerCase().includes(a.toLowerCase())||s.tags.some(t=>t.toLowerCase().includes(a.toLowerCase()))),T=s=>{switch(s){case"structured_research":return e.jsx(b,{className:"h-4 w-4"});case"rapid_analysis":return e.jsx(q,{className:"h-4 w-4"});default:return e.jsx(y,{className:"h-4 w-4"})}},_=s=>{switch(s){case"structured_research":return"Structured Research";case"rapid_analysis":return"Rapid Analysis";default:return"General Topic"}},L=s=>{switch(s){case"active":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400";case"completed":return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400";case"archived":return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"container mx-auto px-4 sm:px-6 py-4 sm:py-6 max-w-7xl",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white",children:"Investigations"}),e.jsx("p",{className:"text-sm sm:text-base text-gray-600 dark:text-gray-400 mt-2",children:"Organize your research with investigation-centric workflows"})]}),e.jsxs(m,{onClick:()=>x("/dashboard/investigations/new"),className:"bg-purple-600 hover:bg-purple-700 w-full sm:w-auto",children:[e.jsx(N,{className:"h-4 w-4 mr-2"}),"New Investigation"]})]}),e.jsx(o,{className:"mb-6",children:e.jsx(d,{className:"pt-6",children:e.jsx("div",{className:"flex flex-col sm:flex-row gap-4",children:e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(R,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(I,{placeholder:"Search investigations...",value:a,onChange:s=>k(s.target.value),className:"pl-10"})]})})})}),e.jsxs(B,{value:n,onValueChange:s=>C(s),children:[e.jsxs(D,{children:[e.jsx(g,{value:"active",children:"Active"}),e.jsx(g,{value:"completed",children:"Completed"}),e.jsx(g,{value:"archived",children:"Archived"})]}),e.jsx(P,{value:n,className:"mt-6",children:u?e.jsx(o,{children:e.jsx(d,{className:"py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-red-500 mb-4",children:"⚠️"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Error Loading Investigations"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:u}),e.jsx(m,{onClick:()=>j(),variant:"outline",children:"Try Again"})]})})}):w?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx($,{className:"h-8 w-8 animate-spin text-purple-600"})}):p.length===0?e.jsx(o,{children:e.jsx(d,{className:"py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx(y,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"No investigations found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:a?"Try adjusting your search":"Create your first investigation to get started"}),!a&&e.jsxs(m,{onClick:()=>x("/dashboard/investigations/new"),className:"bg-purple-600 hover:bg-purple-700",children:[e.jsx(N,{className:"h-4 w-4 mr-2"}),"Create Investigation"]})]})})}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:p.map(s=>e.jsxs(o,{className:"hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>x(`/dashboard/investigations/${s.id}`),children:[e.jsx(A,{children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[T(s.type),e.jsx(l,{variant:"outline",className:"text-xs",children:_(s.type)}),e.jsx(l,{className:L(s.status),children:s.status})]}),e.jsx(E,{className:"text-xl mb-2",children:s.title}),s.description&&e.jsx(F,{className:"line-clamp-2",children:s.description}),s.research_question_topic&&e.jsx("div",{className:"mt-2",children:e.jsxs(l,{variant:"secondary",className:"text-xs",children:[e.jsx(b,{className:"h-3 w-3 mr-1"}),"Research Question"]})})]})})}),e.jsxs(d,{children:[e.jsxs("div",{className:"grid grid-cols-4 gap-2 mb-3",children:[e.jsxs("div",{className:"text-center p-2 bg-gray-50 dark:bg-gray-800 rounded",children:[e.jsx("div",{className:"text-xl font-bold text-purple-600",children:s.evidence_count}),e.jsx("div",{className:"text-xs text-gray-500",children:"Evidence"})]}),e.jsxs("div",{className:"text-center p-2 bg-gray-50 dark:bg-gray-800 rounded",children:[e.jsx("div",{className:"text-xl font-bold text-blue-600",children:s.actor_count}),e.jsx("div",{className:"text-xs text-gray-500",children:"Actors"})]}),e.jsxs("div",{className:"text-center p-2 bg-gray-50 dark:bg-gray-800 rounded",children:[e.jsx("div",{className:"text-xl font-bold text-green-600",children:s.source_count}),e.jsx("div",{className:"text-xs text-gray-500",children:"Sources"})]}),e.jsxs("div",{className:"text-center p-2 bg-gray-50 dark:bg-gray-800 rounded",children:[e.jsx("div",{className:"text-xl font-bold text-orange-600",children:s.framework_count}),e.jsx("div",{className:"text-xs text-gray-500",children:"Analyses"})]})]}),s.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mb-3",children:[s.tags.slice(0,3).map((t,i)=>e.jsx(l,{variant:"secondary",className:"text-xs",children:t},i)),s.tags.length>3&&e.jsxs(l,{variant:"secondary",className:"text-xs",children:["+",s.tags.length-3," more"]})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Updated ",new Date(s.updated_at).toLocaleDateString()," by ",s.created_by_username]})]})]},s.id))})})]})]})}export{V as default};
