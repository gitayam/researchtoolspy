import{j as e}from"./ui-vendor-DBphXmDA.js";import{k as w,f as C,r as o}from"./react-vendor-CfYLSWvh.js";import{B as d,e as x}from"./index-DGGXJgUa.js";import{C as t,d as n}from"./card-BQo7RV_Z.js";import{A}from"./ACHMatrix-DYpuOWoE.js";import{_ as E,a5 as P,P as m,a1 as S}from"./icons-x9tcvtYN.js";import"./state-vendor-BXB5jEEt.js";function O(){const{token:r}=w(),h=C(),[s,b]=o.useState(null),[N,y]=o.useState(!0),[c,g]=o.useState(!1),[j,f]=o.useState(null);o.useEffect(()=>{v()},[r]);const v=async()=>{if(r)try{y(!0);const a=await fetch(`/api/ach/public/${r}`);if(!a.ok)throw new Error("Analysis not found or not public");const l=await a.json();b(l)}catch(a){console.error("Failed to load analysis:",a),f(a instanceof Error?a.message:"Failed to load analysis")}finally{y(!1)}},p=async()=>{if(r){g(!0);try{const a=await fetch(`/api/ach/public/${r}/clone`,{method:"POST"});if(!a.ok)throw new Error("Failed to clone analysis");const l=await a.json();h(`/dashboard/analysis-frameworks/ach-dashboard/${l.id}`)}catch(a){console.error("Failed to clone analysis:",a),alert("Failed to clone analysis. Please make sure you are logged in.")}finally{g(!1)}}},k=()=>{if(!s)return;const a=JSON.stringify(s,null,2),l=new Blob([a],{type:"application/json"}),u=URL.createObjectURL(l),i=document.createElement("a");i.href=u,i.download=`${s.title.replace(/\s+/g,"_")}_ACH_Analysis.json`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(u)};return N?e.jsx("div",{className:"container mx-auto py-12",children:e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading analysis..."})})}):j||!s?e.jsx("div",{className:"container mx-auto py-12",children:e.jsx(t,{children:e.jsxs(n,{className:"p-12 text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Analysis Not Found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:j||"This analysis is not public or does not exist."}),e.jsxs(d,{onClick:()=>h("/public/ach"),children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Browse Public Analyses"]})]})})}):e.jsxs("div",{className:"container mx-auto py-8",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(x,{variant:"outline",className:"text-xs",children:"Public ACH Analysis"}),s.domain&&e.jsx(x,{variant:"secondary",className:"text-xs",children:s.domain}),s.tags?.map(a=>e.jsx(x,{variant:"outline",className:"text-xs",children:a},a))]}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:s.title}),e.jsxs("p",{className:"text-lg text-gray-700 dark:text-gray-300 mb-3",children:[e.jsx("strong",{children:"Key Question:"})," ",s.question]}),s.description&&e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-3",children:s.description}),e.jsxs("div",{className:"flex gap-4 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(P,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.view_count||0," views"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(m,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.clone_count||0," clones"]})]}),s.analyst&&e.jsxs("div",{children:[e.jsx("strong",{children:"Analyst:"})," ",s.analyst]}),s.organization&&e.jsxs("div",{children:[e.jsx("strong",{children:"Organization:"})," ",s.organization]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(d,{variant:"outline",onClick:k,children:[e.jsx(S,{className:"h-4 w-4 mr-2"}),"Export"]}),e.jsxs(d,{onClick:p,disabled:c,children:[e.jsx(m,{className:"h-4 w-4 mr-2"}),c?"Cloning...":"Clone & Analyze"]})]})]})}),e.jsx(t,{className:"mb-6 bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800",children:e.jsx(n,{className:"p-4",children:e.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:[e.jsx("strong",{children:"ðŸ“‹ Public Analysis:"}),' This ACH analysis has been shared publicly. You can view the hypotheses and evidence below. Click "Clone & Analyze" to copy this analysis to your workspace where you can score the evidence independently.']})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsx(t,{children:e.jsxs(n,{className:"p-4",children:[e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Hypotheses"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:s.hypotheses?.length||0})]})}),e.jsx(t,{children:e.jsxs(n,{className:"p-4",children:[e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Evidence Items"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:s.evidence?.length||0})]})}),e.jsx(t,{children:e.jsxs(n,{className:"p-4",children:[e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Scoring Scale"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white capitalize",children:s.scale_type})]})})]}),e.jsx(A,{analysis:s,onUpdateScore:async()=>{},onAddEvidence:()=>{},onRemoveEvidence:async()=>{}}),e.jsx(t,{className:"mt-6 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 border-blue-200 dark:border-blue-800",children:e.jsxs(n,{className:"p-6 text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Ready to Analyze This Research Problem?"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Clone this analysis to your workspace to independently score the evidence and generate your own conclusions using the ACH methodology."}),e.jsxs(d,{onClick:p,disabled:c,size:"lg",children:[e.jsx(m,{className:"h-4 w-4 mr-2"}),c?"Cloning...":"Clone to My Workspace"]})]})})]})}export{O as PublicACHPage};
