import{j as e}from"./ui-vendor-DBphXmDA.js";import{r}from"./react-vendor-CfYLSWvh.js";import{l as $,m as X,n as Q,o as Z,p as ee,y as u,I as A,q as se,S as T,z as k,C as F,E as O,F as y,B as N,s as te,t as ae,e as re,D as le,g as ie,h as ce,k as _,j as ne}from"./index-DGGXJgUa.js";import{C as f,d as I}from"./card-BQo7RV_Z.js";import{X as de,av as oe,W as Y,d as G,aj as z,Y as H,az as K,a as xe,a0 as he,aM as ue,$ as me,P as je,A as pe,q as ge,c as ye,ad as Ne,aN as Ee,aO as be,l as fe,aw as ve,aP as De,I as we,G as Ce,C as Se}from"./icons-x9tcvtYN.js";import"./state-vendor-BXB5jEEt.js";const i={DOCUMENT:"DOCUMENT",WEB_PAGE:"WEB_PAGE",IMAGE:"IMAGE",VIDEO:"VIDEO",AUDIO:"AUDIO",SOCIAL_MEDIA:"SOCIAL_MEDIA",EMAIL:"EMAIL",DATABASE:"DATABASE",API:"API",GOVERNMENT:"GOVERNMENT"},c={PENDING:"PENDING",VERIFIED:"VERIFIED",REJECTED:"REJECTED",NEEDS_REVIEW:"NEEDS_REVIEW"},Ie={VERY_HIGH:"VERY_HIGH",HIGH:"HIGH",MEDIUM:"MEDIUM",LOW:"LOW",VERY_LOW:"VERY_LOW",UNKNOWN:"UNKNOWN"},Ae=["Document","Web Page","Image","Video","Audio","Social Media","Email","Database","API","Government Data"],Te=["A - Completely Reliable","B - Usually Reliable","C - Fairly Reliable","D - Not Usually Reliable","E - Unreliable","F - Cannot be Judged"],ke=["1 - Confirmed","2 - Probably True","3 - Possibly True","4 - Doubtful","5 - Improbable","6 - Cannot be Judged"];function Fe({open:d,onClose:v,onSave:q,initialData:o,mode:l}){const[D,m]=r.useState(!1),[w,U]=r.useState(o?.title||""),[j,M]=r.useState(o?.description||""),[E,C]=r.useState(o?.source||""),[h,S]=r.useState(o?.type||""),[R,W]=r.useState(o?.url||""),[x,V]=r.useState(o?.tags||[]),[p,P]=r.useState(""),[L,b]=r.useState(o?.reliability||""),[s,a]=r.useState(o?.credibility||""),n=async t=>{if(t.preventDefault(),!w.trim()||!E.trim()||!h){alert("Please fill in all required fields");return}m(!0);try{await q({title:w.trim(),description:j.trim(),source:E.trim(),type:h,url:R.trim()||void 0,tags:x,reliability:L,credibility:s}),v()}catch(J){console.error("Failed to save dataset:",J),alert("Failed to save dataset. Please try again.")}finally{m(!1)}},g=()=>{p.trim()&&!x.includes(p.trim())&&(V([...x,p.trim()]),P(""))},B=t=>{V(x.filter(J=>J!==t))};return e.jsx($,{open:d,onOpenChange:v,children:e.jsxs(X,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Q,{children:[e.jsx(Z,{children:l==="create"?"Add New Dataset":"Edit Dataset"}),e.jsx(ee,{children:l==="create"?"Add a new piece of dataset to your collection":"Update the dataset details"})]}),e.jsxs("form",{onSubmit:n,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(u,{htmlFor:"title",children:"Title *"}),e.jsx(A,{id:"title",placeholder:"Dataset title...",value:w,onChange:t=>U(t.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"description",children:"Description"}),e.jsx(se,{id:"description",placeholder:"Describe the dataset...",value:j,onChange:t=>M(t.target.value),rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(u,{htmlFor:"type",children:"Dataset Type *"}),e.jsxs(T,{value:h,onValueChange:S,required:!0,children:[e.jsx(k,{children:e.jsx(F,{placeholder:"Select type"})}),e.jsx(O,{children:Ae.map(t=>e.jsx(y,{value:t.toLowerCase().replace(" ","_"),children:t},t))})]})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"source",children:"Source *"}),e.jsx(A,{id:"source",placeholder:"Source name...",value:E,onChange:t=>C(t.target.value),required:!0})]})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"url",children:"URL"}),e.jsx(A,{id:"url",type:"url",placeholder:"https://...",value:R,onChange:t=>W(t.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(u,{htmlFor:"reliability",children:"Source Reliability"}),e.jsxs(T,{value:L,onValueChange:b,children:[e.jsx(k,{children:e.jsx(F,{placeholder:"Select reliability"})}),e.jsx(O,{children:Te.map(t=>e.jsx(y,{value:t.charAt(0),children:t},t))})]})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"credibility",children:"Information Credibility"}),e.jsxs(T,{value:s,onValueChange:a,children:[e.jsx(k,{children:e.jsx(F,{placeholder:"Select credibility"})}),e.jsx(O,{children:ke.map(t=>e.jsx(y,{value:t.charAt(0),children:t},t))})]})]})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"tags",children:"Tags"}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(A,{id:"tags",placeholder:"Add a tag...",value:p,onChange:t=>P(t.target.value),onKeyPress:t=>t.key==="Enter"&&(t.preventDefault(),g())}),e.jsx(N,{type:"button",onClick:g,size:"sm",children:"Add"})]}),x.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:x.map(t=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-md bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200 text-sm",children:[t,e.jsx("button",{type:"button",onClick:()=>B(t),className:"hover:text-blue-600 dark:hover:text-blue-400",children:e.jsx(de,{className:"h-3 w-3"})})]},t))})]}),e.jsxs(te,{children:[e.jsx(N,{type:"button",variant:"outline",onClick:v,children:"Cancel"}),e.jsx(N,{type:"submit",disabled:D,children:D?"Saving...":l==="create"?"Add Dataset":"Save Changes"})]})]})]})})}const Oe=[];function Ge(){const[d,v]=r.useState(Oe),[q,o]=r.useState(null),[l,D]=r.useState({}),[m,w]=r.useState(""),[U,j]=r.useState(!1),[M,E]=r.useState("create"),[C,h]=r.useState(null),S=async()=>{try{const s=await fetch("/api/dataset");if(s.ok){const a=await s.json();v(a.dataset||[])}}catch(s){console.error("Failed to load dataset:",s)}};r.useEffect(()=>{S()},[]);const R=async s=>{try{const a={title:s.title,description:s.description,type:s.type,source_type:s.type,source_name:s.source,source_url:s.url||null,reliability:s.reliability||"F",credibility:s.credibility||"6",tags:JSON.stringify(s.tags||[]),status:"pending"};if(M==="edit"&&C?.id){if(!(await fetch(`/api/dataset?id=${C.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok)throw new Error("Failed to update dataset")}else if(!(await fetch("/api/dataset",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok)throw new Error("Failed to create dataset");await S(),j(!1),h(null)}catch(a){throw console.error("Error saving dataset:",a),a}},W=async s=>{if(confirm("Are you sure you want to delete this dataset?"))try{(await fetch(`/api/dataset?id=${s}`,{method:"DELETE"})).ok&&await S()}catch(a){console.error("Failed to delete dataset:",a),alert("Failed to delete dataset")}},x=()=>{E("create"),h(null),j(!0)},V=s=>{E("edit"),h(s),j(!0)},p=d.filter(s=>{const a=s.title.toLowerCase().includes(m.toLowerCase())||s.description?.toLowerCase().includes(m.toLowerCase())||s.tags.some(t=>t.toLowerCase().includes(m.toLowerCase())),n=!l.type||s.type===l.type,g=!l.status||s.status===l.status,B=!l.credibility||s.source.credibility===l.credibility;return a&&n&&g&&B}),P=s=>{switch(s){case i.DOCUMENT:return G;case i.WEB_PAGE:return Ce;case i.IMAGE:return we;case i.VIDEO:return De;case i.AUDIO:return ve;case i.SOCIAL_MEDIA:return fe;case i.EMAIL:return be;case i.DATABASE:return Ee;case i.API:return Ne;case i.GOVERNMENT:return ye;default:return G}},L=s=>{switch(s){case c.VERIFIED:return z;case c.PENDING:return H;case c.REJECTED:return K;case c.NEEDS_REVIEW:return Se;default:return H}},b={total:d.length,verified:d.filter(s=>s.status===c.VERIFIED).length,pending:d.filter(s=>s.status===c.PENDING).length,rejected:d.filter(s=>s.status===c.REJECTED).length,by_type:Object.values(i).reduce((s,a)=>(s[a]=d.filter(n=>n.type===a).length,s),{}),by_credibility:Object.values(Ie).reduce((s,a)=>(s[a]=d.filter(n=>n.source.credibility===a).length,s),{})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Dataset Collector"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Manage and organize dataset for your research analysis"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(N,{variant:"outline",onClick:()=>{console.log("Import button clicked"),alert("Import feature coming soon!")},children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Import"]}),e.jsxs(N,{onClick:x,children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Add Dataset"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(f,{children:e.jsx(I,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Dataset"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:b.total})]}),e.jsx(G,{className:"h-8 w-8 text-blue-500"})]})})}),e.jsx(f,{children:e.jsx(I,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Verified"}),e.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:b.verified})]}),e.jsx(z,{className:"h-8 w-8 text-green-500"})]})})}),e.jsx(f,{children:e.jsx(I,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Pending"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600 dark:text-yellow-400",children:b.pending})]}),e.jsx(H,{className:"h-8 w-8 text-yellow-500"})]})})}),e.jsx(f,{children:e.jsx(I,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Rejected"}),e.jsx("p",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:b.rejected})]}),e.jsx(K,{className:"h-8 w-8 text-red-500"})]})})})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(xe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(A,{placeholder:"Search dataset...",className:"pl-10",value:m,onChange:s=>w(s.target.value)})]}),e.jsxs(T,{value:l.type||"all",onValueChange:s=>D({...l,type:s==="all"?void 0:s}),children:[e.jsx(k,{className:"w-48",children:e.jsx(F,{placeholder:"Filter by type"})}),e.jsxs(O,{children:[e.jsx(y,{value:"all",children:"All Types"}),Object.values(i).map(s=>e.jsx(y,{value:s,children:s.replace("_"," ")},s))]})]}),e.jsxs(T,{value:l.status||"all",onValueChange:s=>D({...l,status:s==="all"?void 0:s}),children:[e.jsx(k,{className:"w-48",children:e.jsx(F,{placeholder:"Filter by status"})}),e.jsxs(O,{children:[e.jsx(y,{value:"all",children:"All Statuses"}),Object.values(c).map(s=>e.jsx(y,{value:s,children:s.replace("_"," ")},s))]})]})]}),e.jsx("div",{className:"space-y-4",children:p.length===0?e.jsxs(f,{className:"p-12 text-center",children:[e.jsx(G,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-600 dark:text-gray-400 mb-2",children:"No Dataset Found"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-500 mb-4",children:d.length===0?"Start building your dataset collection by adding your first piece of dataset.":"Try adjusting your search criteria or filters."}),e.jsxs(N,{onClick:x,children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Add Your First Dataset"]})]}):p.map(s=>{const a=P(s.type),n=L(s.status);return e.jsx(f,{className:"hover:shadow-md transition-shadow",children:e.jsx(I,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gray-100 dark:bg-gray-800",children:e.jsx(a,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg text-gray-900 dark:text-white",children:s.title}),e.jsx(n,{className:ae("h-4 w-4",s.status===c.VERIFIED&&"text-green-500",s.status===c.PENDING&&"text-yellow-500",s.status===c.REJECTED&&"text-red-500",s.status===c.NEEDS_REVIEW&&"text-orange-500")})]}),s.description&&e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-3",children:s.description}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-500 mb-3",children:[e.jsxs("span",{children:["Source: ",s.source.name]}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:["Updated ",new Date(s.updated_at).toLocaleDateString()]})]}),e.jsx("div",{className:"flex gap-2",children:s.tags.map(g=>e.jsxs(re,{variant:"secondary",className:"text-xs",children:[e.jsx(he,{className:"h-3 w-3 mr-1"}),g]},g))})]})]}),e.jsxs(le,{children:[e.jsx(ie,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"icon",children:e.jsx(ue,{className:"h-4 w-4"})})}),e.jsxs(ce,{align:"end",children:[e.jsxs(_,{onClick:()=>V(s),children:[e.jsx(me,{className:"h-4 w-4 mr-2"}),"Edit"]}),e.jsxs(_,{children:[e.jsx(je,{className:"h-4 w-4 mr-2"}),"Duplicate"]}),e.jsxs(_,{children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),"Archive"]}),e.jsx(ne,{}),e.jsxs(_,{className:"text-red-600",onClick:()=>W(s.id),children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]})})},s.id)})}),e.jsx(Fe,{open:U,onClose:()=>{j(!1),h(null)},onSave:R,initialData:C,mode:M})]})}export{Ge as DatasetPage};
