import{j as e}from"./ui-vendor-DBphXmDA.js";import{r as d}from"./react-vendor-CfYLSWvh.js";import{C as j,a as p,b,d as N}from"./card-BQo7RV_Z.js";import{y as r,I as R,S as _,z as D,C as L,E as O,F as m,B as h,e as f}from"./index-DGGXJgUa.js";import{G as U,a1 as F,D as T}from"./icons-x9tcvtYN.js";import"./state-vendor-BXB5jEEt.js";function W(){const[n,w]=d.useState(""),[i,k]=d.useState("metadata"),[c,y]=d.useState(!1),[t,u]=d.useState(null),[g,x]=d.useState(null),v=async()=>{if(!n){x("Please enter a URL");return}y(!0),x(null),u(null);try{const s=await(await fetch("/api/web-scraper",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:n,extract_mode:i,create_dataset:!1})})).json();if(!s.success)throw new Error(s.error||"Failed to scrape URL");u(s.data)}catch(a){x(a.message||"Failed to scrape URL")}finally{y(!1)}},S=async()=>{if(t)try{const a=await fetch("/api/datasets",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:t.title||t.domain,description:t.description||`Content from ${t.domain}`,source:t.url,type:"web_article",source_name:t.domain,source_url:t.url,author:t.author,reliability_rating:t.reliability_score&&t.reliability_score>=7?"high":t.reliability_score&&t.reliability_score>=5?"medium":"low",tags:t.metadata?.keywords||[],metadata:JSON.stringify(t.metadata),access_date:new Date().toISOString().split("T")[0]})});if(a.ok){const{dataset:s}=await a.json();alert(`Dataset created successfully! ID: ${s.id}`)}else throw new Error("Failed to create dataset")}catch(a){alert("Error creating dataset: "+a.message)}},C=()=>{if(!t)return;const a=JSON.stringify(t,null,2),s=new Blob([a],{type:"application/json"}),l=URL.createObjectURL(s),o=document.createElement("a");o.href=l,o.download=`scraped-data-${Date.now()}.json`,o.click(),URL.revokeObjectURL(l)},E=a=>{if(!a)return null;let s="secondary",l="Unknown";return a>=8?(s="default",l="High Reliability"):a>=6?(s="secondary",l="Medium Reliability"):(s="destructive",l="Low Reliability"),e.jsxs(f,{variant:s,children:[l," (",a,"/10)"]})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Web Scraper & Research Extractor"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Extract structured data from web pages for research analysis"})]}),e.jsxs(j,{children:[e.jsx(p,{children:e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-5 w-5"}),"URL Extraction"]})}),e.jsxs(N,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"url",children:"URL to Scrape *"}),e.jsx(R,{id:"url",type:"url",placeholder:"https://example.com/article",value:n,onChange:a=>w(a.target.value),disabled:c})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"extract-mode",children:"Extraction Mode"}),e.jsxs(_,{value:i,onValueChange:a=>k(a),disabled:c,children:[e.jsx(D,{id:"extract-mode",children:e.jsx(L,{})}),e.jsxs(O,{children:[e.jsx(m,{value:"metadata",children:"Metadata Only (Fast)"}),e.jsx(m,{value:"summary",children:"Summary + Metadata"}),e.jsx(m,{value:"full",children:"Full Content Analysis"})]})]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[i==="metadata"&&"Extracts title, description, author, keywords",i==="summary"&&"Includes metadata plus content summary",i==="full"&&"Full text extraction and analysis"]})]}),g&&e.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 rounded-lg text-sm",children:g}),e.jsx(h,{onClick:v,disabled:c,className:"w-full",children:c?"Extracting...":"Extract & Analyze"})]})]}),t&&e.jsxs(j,{children:[e.jsx(p,{children:e.jsx(b,{children:"Extracted Data"})}),e.jsxs(N,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Title"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:t.title||"N/A"})]}),e.jsxs("div",{children:[e.jsx(r,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Domain"}),e.jsx("p",{className:"text-gray-900 dark:text-white",children:t.domain})]}),t.author&&e.jsxs("div",{children:[e.jsx(r,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Author"}),e.jsx("p",{className:"text-gray-900 dark:text-white",children:t.author})]}),t.published_date&&e.jsxs("div",{children:[e.jsx(r,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Published"}),e.jsx("p",{className:"text-gray-900 dark:text-white",children:t.published_date})]}),t.reliability_score&&e.jsxs("div",{children:[e.jsx(r,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Reliability Score"}),e.jsx("div",{className:"mt-1",children:E(t.reliability_score)})]}),e.jsxs("div",{children:[e.jsx(r,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Extracted At"}),e.jsx("p",{className:"text-gray-900 dark:text-white text-sm",children:new Date(t.extracted_at).toLocaleString()})]})]}),t.description&&e.jsxs("div",{children:[e.jsx(r,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Description"}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:t.description})]}),t.metadata?.keywords&&t.metadata.keywords.length>0&&e.jsxs("div",{children:[e.jsx(r,{className:"text-xs text-gray-500 dark:text-gray-400 mb-2 block",children:"Keywords"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.metadata.keywords.map((a,s)=>e.jsx(f,{variant:"secondary",children:a},s))})]}),t.content&&e.jsxs("div",{children:[e.jsx(r,{className:"text-xs text-gray-500 dark:text-gray-400",children:"Content Preview"}),e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-900 rounded-lg mt-1",children:[e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap",children:t.content.summary||t.content.text.substring(0,500)+"..."}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:["Word count: ",t.content.word_count]})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[e.jsxs(h,{onClick:C,variant:"outline",className:"flex-1",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Export JSON"]}),e.jsxs(h,{onClick:S,className:"flex-1",children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),"Create Dataset"]})]})]})]})]})}export{W as WebScraperPage};
