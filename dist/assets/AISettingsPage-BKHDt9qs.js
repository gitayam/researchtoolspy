import{j as e}from"./ui-vendor-DBphXmDA.js";import{r as c}from"./react-vendor-CfYLSWvh.js";import{C as n,d as r,a as d,b as o,c as j}from"./card-BGAig-Dv.js";import{y as l,e as N,S,z as A,C as M,E as I,F as x,B as b}from"./index-QqleixXe.js";import{S as E}from"./switch-BxNvahPI.js";import{C as P,S as T,a7 as L,f as R,Z as O,w as G,bn as U}from"./icons-x9tcvtYN.js";import"./state-vendor-BXB5jEEt.js";new Date().toISOString();const y={"gpt-5":{input:1.25,output:10},"gpt-5-mini":{input:.25,output:2},"gpt-5-nano":{input:.05,output:.4}};function H(){const[s,i]=c.useState(null),[v,w]=c.useState(!0),[p,h]=c.useState(!1),[f,m]=c.useState(null),[C,u]=c.useState(null);c.useEffect(()=>{k()},[]);const k=async()=>{try{w(!0);const a=await fetch("/api/ai/config");if(!a.ok)throw new Error("Failed to load configuration");const t=await a.json();i(t)}catch(a){m(a instanceof Error?a.message:"Failed to load configuration")}finally{w(!1)}},F=async()=>{if(s)try{h(!0),m(null),u(null);const a=await fetch("/api/ai/config",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok){const t=await a.json();throw new Error(t.message||"Failed to save configuration")}u("Configuration saved successfully"),setTimeout(()=>u(null),3e3)}catch(a){m(a instanceof Error?a.message:"Failed to save configuration")}finally{h(!1)}},D=async()=>{if(confirm("Reset all AI settings to defaults? This cannot be undone."))try{h(!0),m(null);const a=await fetch("/api/ai/config",{method:"POST"});if(!a.ok)throw new Error("Failed to reset configuration");const t=await a.json();i(t.config),u("Configuration reset to defaults"),setTimeout(()=>u(null),3e3)}catch(a){m(a instanceof Error?a.message:"Failed to reset configuration")}finally{h(!1)}};return v?e.jsx("div",{className:"container mx-auto py-8 px-4 max-w-7xl",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-600 dark:text-gray-400",children:"Loading AI configuration..."})})}):s?e.jsxs("div",{className:"container mx-auto py-8 px-4 max-w-7xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(T,{className:"h-8 w-8 text-purple-600"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:"AI Settings"})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Configure GPT-5 models and AI-powered analysis features"})]}),f&&e.jsx(n,{className:"mb-6 border-red-200 bg-red-50 dark:bg-red-900/20",children:e.jsx(r,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-2 text-red-800 dark:text-red-200",children:[e.jsx(P,{className:"h-5 w-5"}),e.jsx("span",{children:f})]})})}),C&&e.jsx(n,{className:"mb-6 border-green-200 bg-green-50 dark:bg-green-900/20",children:e.jsx(r,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-2 text-green-800 dark:text-green-200",children:[e.jsx(L,{className:"h-5 w-5"}),e.jsx("span",{children:C})]})})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(n,{children:[e.jsx(d,{children:e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(R,{className:"h-5 w-5"}),"AI Status"]})}),e.jsxs(r,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(l,{children:"AI Features"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enable AI-powered assistance"})]}),e.jsx(N,{variant:s.enabled?"default":"secondary",children:s.enabled?"Enabled":"Disabled"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(l,{children:"OpenAI API Key"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Required for AI features"})]}),e.jsx(N,{variant:s.hasApiKey?"default":"destructive",children:s.hasApiKey?"Configured":"Not Set"})]}),!s.hasApiKey&&e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-3",children:e.jsxs("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:[e.jsx("strong",{children:"Note:"})," API key must be set as environment variable OPENAI_API_KEY in Cloudflare dashboard."]})})]})]}),e.jsxs(n,{children:[e.jsxs(d,{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-5 w-5"}),"Model Configuration"]}),e.jsx(j,{children:"Select default model and configure use case mappings"})]}),e.jsxs(r,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"defaultModel",children:"Default Model"}),e.jsxs(S,{value:s.defaultModel||"gpt-5-mini",onValueChange:a=>i({...s,defaultModel:a}),children:[e.jsx(A,{id:"defaultModel",children:e.jsx(M,{})}),e.jsxs(I,{children:[e.jsx(x,{value:"gpt-5",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("span",{children:"GPT-5"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Deep Analysis"})]})}),e.jsx(x,{value:"gpt-5-mini",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("span",{children:"GPT-5 Mini"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Balanced (Recommended)"})]})}),e.jsx(x,{value:"gpt-5-nano",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("span",{children:"GPT-5 Nano"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Fast & Cheap"})]})})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Used when no specific use case model is selected"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(l,{children:"Use Case Model Assignments"}),Object.entries(s.useCases).map(([a,t])=>e.jsxs("div",{className:"flex items-center justify-between py-2 border-b last:border-0",children:[e.jsx("span",{className:"text-sm capitalize",children:a.replace(/([A-Z])/g," $1").trim()}),e.jsxs(S,{value:t,onValueChange:g=>i({...s,useCases:{...s.useCases,[a]:g}}),children:[e.jsx(A,{className:"w-32",children:e.jsx(M,{})}),e.jsxs(I,{children:[e.jsx(x,{value:"gpt-5",children:"GPT-5"}),e.jsx(x,{value:"gpt-5-mini",children:"Mini"}),e.jsx(x,{value:"gpt-5-nano",children:"Nano"})]})]})]},a))]})]})]}),e.jsxs(n,{children:[e.jsxs(d,{children:[e.jsx(o,{children:"Features"}),e.jsx(j,{children:"Enable or disable specific AI capabilities"})]}),e.jsx(r,{className:"space-y-4",children:Object.entries(s.features).map(([a,t])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:a,className:"capitalize",children:a.replace(/([A-Z])/g," $1").replace("enable","").trim()}),e.jsx("p",{className:"text-sm text-muted-foreground",children:$(a)})]}),e.jsx(E,{id:a,checked:t,onCheckedChange:g=>i({...s,features:{...s.features,[a]:g}})})]},a))})]}),e.jsxs(n,{children:[e.jsxs(d,{children:[e.jsx(o,{children:"Rate Limits"}),e.jsx(j,{children:"Control API usage to manage costs"})]}),e.jsxs(r,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Requests Per Minute"}),e.jsx("p",{className:"text-2xl font-bold",children:s.rateLimits.requestsPerMinute}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Maximum API requests per minute"})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Tokens Per Day"}),e.jsx("p",{className:"text-2xl font-bold",children:s.rateLimits.tokensPerDay.toLocaleString()}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Daily token limit across all requests"})]}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3",children:e.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:[e.jsx("strong",{children:"Estimated Daily Cost:"})," $",s.defaultModel&&y[s.defaultModel]?(s.rateLimits.tokensPerDay/1e6*y[s.defaultModel].output).toFixed(2):"0.00",s.defaultModel&&` (max, at ${s.defaultModel} output rates)`]})})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(n,{children:[e.jsx(d,{children:e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-5 w-5"}),"Usage Today"]})}),e.jsxs(r,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Tokens Used"}),e.jsx("p",{className:"text-2xl font-bold",children:s.costs?.totalTokensUsed?.toLocaleString()||0}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("div",{className:"flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${Math.min((s.costs?.totalTokensUsed||0)/s.rateLimits.tokensPerDay*100,100)}%`}})}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[((s.costs?.totalTokensUsed||0)/s.rateLimits.tokensPerDay*100).toFixed(1),"%"]})]})]}),e.jsxs("div",{children:[e.jsxs(l,{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-4 w-4"}),"Estimated Cost"]}),e.jsxs("p",{className:"text-2xl font-bold",children:["$",(s.costs?.estimatedCost||0).toFixed(4)]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Resets: ",s.costs?.lastReset?new Date(s.costs.lastReset).toLocaleDateString():"N/A"]})]})]})]}),e.jsxs(n,{children:[e.jsxs(d,{children:[e.jsx(o,{children:"Model Pricing"}),e.jsx(j,{children:"Cost per 1M tokens"})]}),e.jsx(r,{className:"space-y-3",children:Object.entries(y).map(([a,t])=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{className:"text-sm",children:a}),s.defaultModel&&s.defaultModel===a&&e.jsx(N,{variant:"secondary",className:"text-xs",children:"Default"})]}),e.jsxs("div",{className:"text-xs text-muted-foreground space-y-0.5",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Input:"}),e.jsxs("span",{children:["$",t.input,"/1M"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Output:"}),e.jsxs("span",{children:["$",t.output,"/1M"]})]})]})]},a))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{onClick:F,disabled:p||!s.hasApiKey,className:"w-full",children:p?"Saving...":"Save Configuration"}),e.jsx(b,{onClick:D,variant:"outline",disabled:p,className:"w-full",children:"Reset to Defaults"}),e.jsx(b,{onClick:k,variant:"ghost",disabled:v,className:"w-full",children:"Refresh"})]})]})]})]}):e.jsx("div",{className:"container mx-auto py-8 px-4 max-w-7xl",children:e.jsx(n,{className:"border-red-200 bg-red-50 dark:bg-red-900/20",children:e.jsx(r,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-2 text-red-800 dark:text-red-200",children:[e.jsx(P,{className:"h-5 w-5"}),e.jsx("span",{children:f||"Failed to load AI configuration"})]})})})})}function $(s){return{enableSummarization:"Generate executive summaries and BLUF statements",enableQuestionGeneration:"Create analytical questions to improve analysis",enableFieldSuggestions:"AI-powered content suggestions for form fields",enableGuidance:"Contextual guidance and prompts",enableAutoFormat:"Automatically format and enhance content"}[s]||""}export{H as AISettingsPage};
