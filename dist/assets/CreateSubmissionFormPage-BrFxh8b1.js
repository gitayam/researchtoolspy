import{j as e}from"./ui-vendor-DBphXmDA.js";import{f as I,r as d}from"./react-vendor-CfYLSWvh.js";import{C as m,a as h,b as x,c as u,d as b}from"./card-BGAig-Dv.js";import{B as n,y as i,I as p,e as P,q as L}from"./index-QqleixXe.js";import{C as c}from"./checkbox-DueJeeKx.js";import{_ as k,aj as S,P as F,ad as R,f as T,n as D,C as _}from"./icons-x9tcvtYN.js";import"./state-vendor-BXB5jEEt.js";const E=[{id:"source_url",label:"Source URL",description:"URL of the content",default:!0},{id:"archived_url",label:"Archived URL",description:"Pre-archived backup URL (optional)",default:!1},{id:"content_type",label:"Content Type",description:"Article, video, social post, etc.",default:!0},{id:"content_description",label:"Content Description",description:"How this relates to research",default:!0},{id:"login_required",label:"Login Required Toggle",description:"Whether content needs login",default:!1},{id:"keywords",label:"Keywords",description:"Tags for searching",default:!0},{id:"submitter_comments",label:"Additional Comments",description:"Free text notes",default:!0},{id:"submitter_name",label:"Submitter Name",description:"Optional identification",default:!1},{id:"submitter_contact",label:"Contact Info",description:"Email or other contact",default:!1}];function $(){const j=I(),[r,t]=d.useState({formName:"",formDescription:"",enabledFields:["source_url","content_type","content_description","keywords","submitter_comments"],requireUrl:!0,requireContentType:!0,allowAnonymous:!0,autoArchive:!0,collectSubmitterInfo:!1,requireSubmissionPassword:!1,submissionPassword:""}),[f,g]=d.useState(!1),[N,y]=d.useState(null),[o,q]=d.useState(null),[A,v]=d.useState(!1),w=s=>{t(a=>({...a,enabledFields:a.enabledFields.includes(s)?a.enabledFields.filter(l=>l!==s):[...a.enabledFields,s]}))},U=async s=>{s.preventDefault(),g(!0),y(null);try{if(!r.formName)throw new Error("Form name is required");if(r.enabledFields.length===0)throw new Error("At least one field must be enabled");const a=await fetch("/api/research/forms/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({formName:r.formName,formDescription:r.formDescription||void 0,targetInvestigationIds:[],targetResearchQuestionIds:[],enabledFields:r.enabledFields,requireUrl:r.requireUrl,requireContentType:r.requireContentType,allowAnonymous:r.allowAnonymous,autoArchive:r.autoArchive,collectSubmitterInfo:r.collectSubmitterInfo,requireSubmissionPassword:r.requireSubmissionPassword,submissionPassword:r.submissionPassword||void 0})}),l=await a.json();if(!a.ok)throw new Error(l.error||"Failed to create form");q({id:l.form.id,hashId:l.form.hashId,submissionUrl:`${window.location.origin}${l.form.submissionUrl}`})}catch(a){console.error("Failed to create form:",a),y(a instanceof Error?a.message:"Failed to create form")}finally{g(!1)}},C=s=>{navigator.clipboard.writeText(s),v(!0),setTimeout(()=>v(!1),2e3)};return o?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs(n,{variant:"ghost",size:"sm",onClick:()=>j("/dashboard/research/forms"),className:"mb-6",children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"Back to Forms"]}),e.jsxs(m,{className:"border-green-200 dark:border-green-800",children:[e.jsxs(h,{children:[e.jsxs(x,{className:"flex items-center text-green-600 dark:text-green-400",children:[e.jsx(S,{className:"h-6 w-6 mr-2"}),"Form Created Successfully"]}),e.jsx(u,{children:"Your submission form is ready. Share the URL below to collect evidence."})]}),e.jsxs(b,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Public Submission URL"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(p,{value:o.submissionUrl,readOnly:!0,className:"font-mono text-sm"}),e.jsx(n,{variant:"outline",size:"sm",onClick:()=>C(o.submissionUrl),children:A?e.jsx(S,{className:"h-4 w-4"}):e.jsx(F,{className:"h-4 w-4"})})]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Share this URL to allow anonymous evidence submission"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Form Hash ID"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(P,{variant:"outline",className:"font-mono text-lg px-4 py-2",children:o.hashId}),e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>C(o.hashId),children:e.jsx(F,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsxs(n,{onClick:()=>window.open(o.submissionUrl,"_blank"),className:"flex-1",children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Open Submission Form"]}),e.jsx(n,{variant:"outline",onClick:()=>j("/dashboard/research/forms"),className:"flex-1",children:"View All Forms"})]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:e.jsx("strong",{children:"Next steps:"})}),e.jsxs("ul",{className:"text-sm text-blue-600 dark:text-blue-400 mt-2 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Share the submission URL with your sources or team"}),e.jsx("li",{children:"Monitor incoming submissions in the review panel"}),e.jsx("li",{children:"Process submissions into your evidence collection"})]})]})]})]})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs(n,{variant:"ghost",size:"sm",onClick:()=>j("/dashboard/research/forms"),className:"mb-4",children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"Back"]}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Create Submission Form"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Create an anonymous form to collect evidence from sources"})]}),e.jsxs("form",{onSubmit:U,className:"space-y-6",children:[e.jsxs(m,{children:[e.jsxs(h,{children:[e.jsx(x,{children:"Basic Information"}),e.jsx(u,{children:"Name and describe your submission form"})]}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"formName",children:["Form Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(p,{id:"formName",placeholder:"Evidence Submission - Project Alpha",value:r.formName,onChange:s=>t({...r,formName:s.target.value}),required:!0}),e.jsx("p",{className:"text-sm text-gray-500",children:"Internal name for your reference"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"formDescription",children:"Form Description"}),e.jsx(L,{id:"formDescription",placeholder:"Submit evidence related to our investigation. All submissions are confidential and will be reviewed by our team.",value:r.formDescription,onChange:s=>t({...r,formDescription:s.target.value}),rows:3}),e.jsx("p",{className:"text-sm text-gray-500",children:"This description will be shown to submitters"})]})]})]}),e.jsxs(m,{children:[e.jsxs(h,{children:[e.jsx(x,{children:"Form Fields"}),e.jsx(u,{children:"Select which fields to include in the form"})]}),e.jsx(b,{children:e.jsx("div",{className:"space-y-3",children:E.map(s=>e.jsxs("div",{className:"flex items-start space-x-3 p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 cursor-pointer",onClick:()=>w(s.id),children:[e.jsx(c,{id:s.id,checked:r.enabledFields.includes(s.id),onCheckedChange:()=>w(s.id)}),e.jsxs("div",{className:"flex-1",children:[e.jsx(i,{htmlFor:s.id,className:"cursor-pointer font-medium",children:s.label}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:s.description})]})]},s.id))})})]}),e.jsxs(m,{children:[e.jsxs(h,{children:[e.jsxs(x,{className:"flex items-center",children:[e.jsx(T,{className:"h-5 w-5 mr-2"}),"Configuration"]}),e.jsx(u,{children:"Configure form behavior and requirements"})]}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(i,{className:"font-medium",children:"Require Source URL"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Make the URL field mandatory"})]}),e.jsx(c,{checked:r.requireUrl,onCheckedChange:s=>t({...r,requireUrl:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(i,{className:"font-medium",children:"Require Content Type"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Make content type selection mandatory"})]}),e.jsx(c,{checked:r.requireContentType,onCheckedChange:s=>t({...r,requireContentType:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(i,{className:"font-medium",children:"Auto-Archive URLs"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Automatically archive submitted URLs via Wayback Machine"})]}),e.jsx(c,{checked:r.autoArchive,onCheckedChange:s=>t({...r,autoArchive:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(i,{className:"font-medium",children:"Collect Submitter Info"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Store IP address and user agent"})]}),e.jsx(c,{checked:r.collectSubmitterInfo,onCheckedChange:s=>t({...r,collectSubmitterInfo:s})})]})]})]}),e.jsxs(m,{children:[e.jsxs(h,{children:[e.jsxs(x,{className:"flex items-center",children:[e.jsx(D,{className:"h-5 w-5 mr-2"}),"Security"]}),e.jsx(u,{children:"Optional password protection for the form"})]}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(i,{className:"font-medium",children:"Require Password"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Submitters must enter a password to access the form"})]}),e.jsx(c,{checked:r.requireSubmissionPassword,onCheckedChange:s=>t({...r,requireSubmissionPassword:s})})]}),r.requireSubmissionPassword&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"password",children:"Submission Password"}),e.jsx(p,{id:"password",type:"password",placeholder:"Enter password for form access",value:r.submissionPassword,onChange:s=>t({...r,submissionPassword:s.target.value})}),e.jsx("p",{className:"text-sm text-gray-500",children:"Share this password with authorized submitters"})]})]})]}),N&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(_,{className:"h-5 w-5 text-red-500 mr-2"}),e.jsx("span",{className:"text-red-700 dark:text-red-400",children:N})]})}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(n,{type:"button",variant:"outline",onClick:()=>j("/dashboard/research/forms"),children:"Cancel"}),e.jsx(n,{type:"submit",disabled:f,children:f?"Creating Form...":"Create Form"})]})]})]})})}export{$ as default};
