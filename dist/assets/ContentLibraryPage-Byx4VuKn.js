import{j as e}from"./ui-vendor-DBphXmDA.js";import{f as S,r as l}from"./react-vendor-CfYLSWvh.js";import{C as d}from"./card-BGAig-Dv.js";import{d as z,I,B as f,e as i}from"./index-QqleixXe.js";import{d as j,a as N,bg as _,L as D,be as E,E as F,ai as B,U,br as T,am as A,x as w,V as P,N as R,c as H,B as V}from"./icons-x9tcvtYN.js";import"./state-vendor-BXB5jEEt.js";function J(){const m=S(),{toast:h}=z(),[x,b]=l.useState([]),[y,p]=l.useState(!0),[o,v]=l.useState(""),[c,C]=l.useState("");l.useEffect(()=>{u()},[]);const u=async()=>{p(!0);try{const s=localStorage.getItem("omnicore_user_hash"),a={"X-Workspace-ID":localStorage.getItem("omnicore_workspace_id")||"1"};s&&s!=="guest"&&(a["X-User-Hash"]=s);const t=await fetch("/api/content-library",{headers:a});if(t.ok){const r=await t.json();b(r.content||[])}else h({title:"Error",description:"Failed to load content library",variant:"destructive"})}catch(s){console.error("Failed to load content:",s),h({title:"Error",description:"Failed to load content library",variant:"destructive"})}finally{p(!1)}},k=s=>{const n=[],a=s.entities||{},t=a.people&&a.people.length>0,r=a.organizations&&a.organizations.length>0;return(a.locations&&a.locations.length>0||r)&&n.push({name:"PMESII-PT",icon:P,path:"/dashboard/analysis-frameworks/pmesii-pt",reason:"Environmental analysis of political, military, economic factors"}),(t||r)&&n.push({name:"Center of Gravity",icon:w,path:"/dashboard/analysis-frameworks/cog",reason:"Identify critical capabilities and vulnerabilities"}),(a.people?.length||0)+(a.organizations?.length||0)>=3&&n.push({name:"Network Analysis",icon:R,path:"/dashboard/network",reason:"Visualize relationships between entities"}),(s.summary?.toLowerCase().includes("claim")||s.summary?.toLowerCase().includes("alleges"))&&n.push({name:"Deception Detection",icon:H,path:"/dashboard/analysis-frameworks/deception",reason:"Analyze credibility and identify potential deception"}),n.length===0&&n.push({name:"SWOT",icon:V,path:"/dashboard/analysis-frameworks/swot-dashboard",reason:"General purpose strategic analysis"}),n.slice(0,3)},g=x.filter(s=>{const n=!o||s.title?.toLowerCase().includes(o.toLowerCase())||s.summary?.toLowerCase().includes(o.toLowerCase())||s.url.toLowerCase().includes(o.toLowerCase()),a=!c||s.domain===c;return n&&a}),L=Array.from(new Set(x.map(s=>s.domain).filter(Boolean)));return e.jsxs("div",{className:"container mx-auto py-8 space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-2",children:[e.jsx(j,{className:"h-8 w-8"}),"Content Library"]}),e.jsx("p",{className:"text-muted-foreground",children:"View analyzed content and get framework suggestions"})]}),e.jsx(d,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(N,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(I,{placeholder:"Search content...",value:o,onChange:s=>v(s.target.value),className:"pl-10"})]}),e.jsxs("select",{value:c,onChange:s=>C(s.target.value),className:"px-3 py-2 border rounded-md bg-background",children:[e.jsx("option",{value:"",children:"All Domains"}),L.map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsxs(f,{variant:"outline",size:"sm",onClick:u,children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})}),y?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(D,{className:"h-8 w-8 animate-spin text-blue-600"})}):g.length===0?e.jsxs(d,{className:"p-12 text-center",children:[e.jsx(j,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Content Yet"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Start analyzing URLs from the landing page or Content Research tool"}),e.jsxs(f,{onClick:()=>m("/dashboard/tools/content-intelligence"),children:[e.jsx(N,{className:"h-4 w-4 mr-2"}),"Analyze Content"]})]}):e.jsx("div",{className:"grid gap-6",children:g.map(s=>{const n=k(s),a=s.entities||{};return e.jsx(d,{className:"p-6 hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-start justify-between gap-4 mb-2",children:[e.jsx("h3",{className:"text-xl font-semibold line-clamp-2",children:s.title||"Untitled"}),s.from_cache&&e.jsxs(i,{variant:"secondary",className:"shrink-0",children:[e.jsx(E,{className:"h-3 w-3 mr-1"}),"Cached"]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 hover:text-blue-600 truncate max-w-md",children:[e.jsx(F,{className:"h-3 w-3 shrink-0"}),s.domain||new URL(s.url).hostname]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(B,{className:"h-3 w-3"}),new Date(s.created_at).toLocaleDateString()]}),s.word_count&&e.jsxs("span",{children:[s.word_count.toLocaleString()," words"]})]})]}),s.summary&&e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-3",children:s.summary}),a.people?.length||a.organizations?.length||a.locations?.length?e.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.people?.slice(0,3).map((t,r)=>e.jsxs(i,{variant:"outline",className:"text-xs",children:[e.jsx(U,{className:"h-3 w-3 mr-1"}),t]},r)),a.organizations?.slice(0,3).map((t,r)=>e.jsxs(i,{variant:"outline",className:"text-xs",children:[e.jsx(T,{className:"h-3 w-3 mr-1"}),t]},r)),a.locations?.slice(0,3).map((t,r)=>e.jsxs(i,{variant:"outline",className:"text-xs",children:[e.jsx(A,{className:"h-3 w-3 mr-1"}),t]},r))]}):null,e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("div",{className:"text-sm font-medium mb-3 flex items-center gap-2",children:[e.jsx(w,{className:"h-4 w-4 text-blue-600"}),"Suggested Frameworks"]}),e.jsx("div",{className:"grid sm:grid-cols-3 gap-3",children:n.map((t,r)=>e.jsxs("button",{onClick:()=>{localStorage.setItem("source_content_id",s.id.toString()),m(t.path)},className:"text-left p-3 rounded-lg border hover:border-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(t.icon,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"font-medium text-sm",children:t.name})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t.reason})]},r))})]})]})},s.id)})})]})}export{J as ContentLibraryPage};
