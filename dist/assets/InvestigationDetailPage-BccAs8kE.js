import{j as e}from"./ui-vendor-DBphXmDA.js";import{k as I,f as L,r as d}from"./react-vendor-CfYLSWvh.js";import{C as t,a as f,b,d as r,c as S}from"./card-BQo7RV_Z.js";import{A as B,r as F,B as l,e as u}from"./index-DGGXJgUa.js";import{T as P,a as R,b as x,c as o}from"./tabs-Dznm0vhG.js";import{L as q,C as U,_ as y,ai as z,e as G,U as m,x as H,D as p,ad as w,am as M,B as v,F as O,Z,d as $}from"./icons-x9tcvtYN.js";import"./state-vendor-BXB5jEEt.js";function ee(){const{id:h}=I(),i=L(),[s,k]=d.useState(null),[_,g]=d.useState(!0),[N,n]=d.useState(null);d.useEffect(()=>{h&&C()},[h]);const C=async()=>{try{g(!0),n(null);const a=localStorage.getItem("omnicore_user_hash"),c=await fetch(`/api/investigations/${h}`,{headers:{...a&&{Authorization:`Bearer ${a}`}}});if(!c.ok){if(c.status===404)n("Investigation not found");else if(c.status===403)n("Access denied: You do not have permission to view this investigation");else{const D=await c.json().catch(()=>({}));n(D.error||"Failed to load investigation")}return}const j=await c.json();j.success&&j.investigation?k(j.investigation):n("Invalid response from server")}catch(a){console.error("Error loading investigation:",a),n("Network error: Unable to load investigation")}finally{g(!1)}},A=a=>{switch(a){case"structured_research":return e.jsx($,{className:"h-5 w-5"});case"rapid_analysis":return e.jsx(Z,{className:"h-5 w-5"});default:return e.jsx(O,{className:"h-5 w-5"})}},T=a=>{switch(a){case"structured_research":return"Structured Research";case"rapid_analysis":return"Rapid Analysis";default:return"General Topic"}},E=a=>{switch(a){case"active":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400";case"completed":return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400";case"archived":return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400";default:return"bg-gray-100 text-gray-800"}};return _?e.jsx("div",{className:"container mx-auto p-6",children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(q,{className:"h-8 w-8 animate-spin text-purple-600"})})}):N||!s?e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsxs(B,{variant:"destructive",className:"mb-4",children:[e.jsx(U,{className:"h-4 w-4"}),e.jsx(F,{children:N||"Investigation not found"})]}),e.jsxs(l,{onClick:()=>i("/dashboard/investigations"),variant:"outline",children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"Back to Investigations"]})]}):e.jsxs("div",{className:"container mx-auto px-4 sm:px-6 py-4 sm:py-6 space-y-4 sm:space-y-6 max-w-7xl",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs(l,{onClick:()=>i("/dashboard/investigations"),variant:"outline",size:"sm",children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"Back"]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-2",children:[A(s.type),e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white",children:s.title})]}),s.description&&e.jsx("p",{className:"text-sm sm:text-base text-gray-600 dark:text-gray-400",children:s.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{variant:"outline",children:T(s.type)}),e.jsx(u,{className:E(s.status),children:s.status})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 sm:gap-6 text-xs sm:text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(z,{className:"h-4 w-4"}),"Created ",new Date(s.created_at).toLocaleDateString()]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(G,{className:"h-4 w-4"}),"Updated ",new Date(s.updated_at).toLocaleDateString()]}),s.created_by_username&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(m,{className:"h-4 w-4"}),"by ",s.created_by_username]})]}),s.research_question_topic&&e.jsxs(t,{className:"bg-purple-50 dark:bg-purple-900/10 border-purple-200 dark:border-purple-800",children:[e.jsx(f,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-5 w-5 text-purple-600"}),e.jsx(b,{className:"text-lg",children:"Research Question"})]})}),e.jsxs(r,{children:[e.jsxs("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-2",children:["Topic: ",s.research_question_topic]}),s.research_question_text&&e.jsx("p",{className:"text-gray-900 dark:text-white",children:s.research_question_text})]})]}),s.tags.length>0&&e.jsx("div",{className:"flex gap-2",children:s.tags.map((a,c)=>e.jsx(u,{variant:"secondary",children:a},c))}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsx(t,{children:e.jsx(r,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(p,{className:"h-8 w-8 mx-auto mb-2 text-purple-600"}),e.jsx("div",{className:"text-3xl font-bold",children:s.evidence_count}),e.jsx("div",{className:"text-sm text-gray-500",children:"Evidence"})]})})}),e.jsx(t,{children:e.jsx(r,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(m,{className:"h-8 w-8 mx-auto mb-2 text-blue-600"}),e.jsx("div",{className:"text-3xl font-bold",children:s.actor_count}),e.jsx("div",{className:"text-sm text-gray-500",children:"Actors"})]})})}),e.jsx(t,{children:e.jsx(r,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(w,{className:"h-8 w-8 mx-auto mb-2 text-green-600"}),e.jsx("div",{className:"text-3xl font-bold",children:s.source_count}),e.jsx("div",{className:"text-sm text-gray-500",children:"Sources"})]})})}),e.jsx(t,{children:e.jsx(r,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(M,{className:"h-8 w-8 mx-auto mb-2 text-orange-600"}),e.jsx("div",{className:"text-3xl font-bold",children:s.event_count||0}),e.jsx("div",{className:"text-sm text-gray-500",children:"Events"})]})})}),e.jsx(t,{children:e.jsx(r,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(v,{className:"h-8 w-8 mx-auto mb-2 text-red-600"}),e.jsx("div",{className:"text-3xl font-bold",children:s.framework_count}),e.jsx("div",{className:"text-sm text-gray-500",children:"Analyses"})]})})})]}),e.jsxs(P,{defaultValue:"overview",className:"w-full",children:[e.jsxs(R,{children:[e.jsx(x,{value:"overview",children:"Overview"}),e.jsxs(x,{value:"evidence",children:["Evidence (",s.evidence_count,")"]}),e.jsxs(x,{value:"entities",children:["Entities (",s.actor_count+s.source_count+(s.event_count||0),")"]}),e.jsxs(x,{value:"frameworks",children:["Frameworks (",s.framework_count,")"]})]}),e.jsx(o,{value:"overview",className:"mt-6",children:e.jsxs(t,{children:[e.jsxs(f,{children:[e.jsx(b,{children:"Investigation Overview"}),e.jsx(S,{children:"Manage your research components and apply analytical frameworks"})]}),e.jsx(r,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(l,{variant:"outline",onClick:()=>i("/dashboard/evidence"),className:"h-auto py-4",children:e.jsxs("div",{className:"text-left w-full",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(p,{className:"h-4 w-4"}),e.jsx("span",{className:"font-semibold",children:"Add Evidence"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Link evidence items to this investigation"})]})}),e.jsx(l,{variant:"outline",onClick:()=>i("/dashboard/entities/actors"),className:"h-auto py-4",children:e.jsxs("div",{className:"text-left w-full",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(m,{className:"h-4 w-4"}),e.jsx("span",{className:"font-semibold",children:"Add Actors"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Track people and organizations"})]})}),e.jsx(l,{variant:"outline",onClick:()=>i("/dashboard/entities/sources"),className:"h-auto py-4",children:e.jsxs("div",{className:"text-left w-full",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(w,{className:"h-4 w-4"}),e.jsx("span",{className:"font-semibold",children:"Add Sources"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Document information sources"})]})}),e.jsx(l,{variant:"outline",onClick:()=>i("/dashboard/analysis-frameworks"),className:"h-auto py-4",children:e.jsxs("div",{className:"text-left w-full",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(v,{className:"h-4 w-4"}),e.jsx("span",{className:"font-semibold",children:"Apply Framework"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Run analytical frameworks"})]})})]})})]})}),e.jsx(o,{value:"evidence",className:"mt-6",children:e.jsx(t,{children:e.jsx(r,{className:"py-12",children:e.jsxs("div",{className:"text-center text-gray-500",children:[e.jsx(p,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"mb-4",children:"Evidence linking will be available soon"}),e.jsx(l,{variant:"outline",onClick:()=>i("/dashboard/evidence"),children:"Go to Evidence Page"})]})})})}),e.jsx(o,{value:"entities",className:"mt-6",children:e.jsx(t,{children:e.jsx(r,{className:"py-12",children:e.jsxs("div",{className:"text-center text-gray-500",children:[e.jsx(m,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"mb-4",children:"Entity management will be available soon"}),e.jsx(l,{variant:"outline",onClick:()=>i("/dashboard/entities/actors"),children:"Go to Actors Page"})]})})})}),e.jsx(o,{value:"frameworks",className:"mt-6",children:e.jsx(t,{children:e.jsx(r,{className:"py-12",children:e.jsxs("div",{className:"text-center text-gray-500",children:[e.jsx(v,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"mb-4",children:"Framework results will be displayed here"}),e.jsx(l,{variant:"outline",onClick:()=>i("/dashboard/analysis-frameworks"),children:"Browse Frameworks"})]})})})})]})]})}export{ee as InvestigationDetailPage,ee as default};
