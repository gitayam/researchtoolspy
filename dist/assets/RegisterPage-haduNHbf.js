import{j as e}from"./ui-vendor-DBphXmDA.js";import{f as C,r as d,L as S}from"./react-vendor-CfYLSWvh.js";import{u as H,d as T,B as x}from"./index-QqleixXe.js";import{C as F,a as _,b as D,c as R,d as E}from"./card-BGAig-Dv.js";import{g as y,f as I}from"./hash-auth-C-5ASbCe.js";import{O as u,C as b,h as f,P as A,Q as O,c as B,R as J}from"./icons-x9tcvtYN.js";import"./state-vendor-BXB5jEEt.js";function M(){const{t:s}=H(),m=C(),{toast:o}=T(),[r,h]=d.useState(""),[n,l]=d.useState(!1),[j,g]=d.useState(!1),[p,W]=d.useState(""),[i,G]=d.useState(!1);d.useEffect(()=>{const t=y();h(t);try{const a=localStorage.getItem("omnicore_valid_hashes"),c=a?JSON.parse(a):[];c.includes(t)||(c.push(t),localStorage.setItem("omnicore_valid_hashes",JSON.stringify(c)),console.log("[Register] Hash added to valid hashes:",t.substring(0,8)+"..."))}catch(a){console.error("[Register] Failed to store hash in valid hashes:",a)}},[]);const N=async()=>{try{await navigator.clipboard.writeText(r),l(!0),o({title:s("pages.register.copied"),description:s("pages.register.copiedDesc")}),setTimeout(()=>l(!1),3e3)}catch{try{const a=document.createElement("textarea");a.value=r,a.style.position="fixed",a.style.left="-999999px",a.style.top="-999999px",document.body.appendChild(a),a.focus(),a.select();const c=document.execCommand("copy");if(document.body.removeChild(a),c)l(!0),o({title:s("pages.register.copied"),description:s("pages.register.copiedDesc")}),setTimeout(()=>l(!1),3e3);else throw new Error("Copy command failed")}catch(a){console.error("Failed to copy:",a),o({title:s("pages.register.copyFailed"),description:s("pages.register.copyFailedDesc"),variant:"destructive"})}}},v=()=>{l(!1),g(!1);const t=y();h(t)},k=()=>{try{const t=JSON.parse(localStorage.getItem("omnicore_valid_hashes")||"[]");t.includes(r)||(t.push(r),localStorage.setItem("omnicore_valid_hashes",JSON.stringify(t))),localStorage.setItem("omnicore_user_hash",r),g(!0),setTimeout(()=>{m(`/login?hash=${r}`)},1500)}catch{g(!0),setTimeout(()=>{m("/login")},1500)}},w=I(r);return e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center p-4",children:e.jsxs(F,{className:"w-full max-w-md bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:[e.jsxs(_,{className:"text-center space-y-2",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-blue-600 rounded-lg flex items-center justify-center mb-4",children:e.jsx(u,{className:"h-6 w-6 text-white"})}),e.jsx(D,{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:s("pages.register.title")}),e.jsx(R,{className:"text-gray-600 dark:text-gray-400",children:s("pages.register.subtitle")})]}),e.jsxs(E,{className:"space-y-6",children:[j?e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-green-100 dark:bg-green-900/20 rounded-full flex items-center justify-center",children:e.jsx(f,{className:"h-6 w-6 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-gray-100 mb-1",children:s("pages.register.hashSaved")}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:s("pages.register.redirecting")})]})]}):e.jsxs(e.Fragment,{children:[p&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 p-3 rounded-md",children:[e.jsx(b,{className:"h-4 w-4"}),p]}),e.jsx("div",{className:"bg-red-100 dark:bg-red-900/30 border-2 border-red-500 dark:border-red-600 rounded-lg p-5 animate-pulse",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"animate-bounce",children:e.jsx(b,{className:"h-8 w-8 text-red-600 dark:text-red-400 flex-shrink-0"})}),e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsxs("h3",{className:"text-lg font-bold text-red-900 dark:text-red-100",children:["‚ö†Ô∏è ",s("pages.register.criticalWarning")]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"text-base text-red-800 dark:text-red-200 font-semibold",children:s("pages.register.onlyWay")}),e.jsxs("p",{className:"text-base text-red-800 dark:text-red-200",children:[e.jsx("strong",{className:"text-red-900 dark:text-red-100",children:s("pages.register.noRecovery")})," ",s("pages.register.noRecoveryDesc")]})]})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:s("pages.register.yourBookmarkCode")}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:i?s("pages.register.generating"):r?s("pages.register.clickCopy")+" ‚Üí":s("pages.register.readyToGenerate")})]}),e.jsx("div",{className:"relative",children:e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 border-2 border-gray-300 dark:border-gray-600 rounded-md p-4 font-mono text-base break-all text-gray-900 dark:text-gray-100 min-h-[60px] flex items-center",children:i?s("pages.register.generatingFromServer"):r?w:s("pages.register.failedToGenerate")})}),r&&e.jsx(x,{type:"button",onClick:N,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 text-base",size:"lg",children:n?e.jsxs(e.Fragment,{children:[e.jsx(f,{className:"h-5 w-5 mr-2 text-green-300"}),s("pages.register.copiedToClipboard")]}):e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"h-5 w-5 mr-2"}),s("pages.register.copyHash")]})}),n&&e.jsxs("p",{className:"text-sm text-green-600 dark:text-green-400 font-semibold text-center",children:["‚úì"," ",s("pages.register.hashCopied")]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-gray-100",children:s("pages.register.whatIsThis")}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(u,{className:"h-4 w-4 mt-0.5 text-blue-500"}),e.jsx("span",{children:s("pages.register.bookmarkDesc")})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(O,{className:"h-4 w-4 mt-0.5 text-green-500"}),e.jsx("span",{children:s("pages.register.collaborationDesc")})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(B,{className:"h-4 w-4 mt-0.5 text-purple-500"}),e.jsx("span",{children:s("pages.register.noPersonalData")})]})]})]}),e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 rounded-md p-3",children:e.jsxs("p",{className:"text-sm text-red-700 dark:text-red-300 font-medium text-center",children:["üö´"," ",s("pages.register.finalWarning")]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(x,{onClick:v,variant:"outline",disabled:i,className:"w-full border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50",children:[e.jsx(J,{className:`h-4 w-4 mr-2 ${i?"animate-spin":""}`}),s(i?"pages.register.generating":"pages.register.generateNew")]}),e.jsx(x,{onClick:k,className:"w-full bg-blue-600 hover:bg-blue-700 text-white disabled:opacity-50 disabled:cursor-not-allowed",disabled:!n||i||!r,children:s(n&&r?"pages.register.iveSavedContinue":i?"pages.register.generatingHash":"pages.register.copyHashFirst")})]})]}),e.jsxs("div",{className:"text-center text-sm text-gray-600 dark:text-gray-400",children:[s("pages.register.alreadyHaveHash")," ",e.jsx(S,{to:"/login",className:"text-blue-600 dark:text-blue-400 hover:underline",children:s("pages.register.accessWork")})]})]})]})})}export{M as RegisterPage};
