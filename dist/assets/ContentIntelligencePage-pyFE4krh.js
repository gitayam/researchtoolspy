import{j as e}from"./ui-vendor-DBphXmDA.js";import{r as o,f as xa}from"./react-vendor-CfYLSWvh.js";import{h as ha}from"./viz-libs-B9RIjOsc.js";import{C as j,a as X,b as ie,c as ua,d as Z}from"./card-BQo7RV_Z.js";import{l as gs,H as Et,B as c,m as fs,n as js,o as ys,p as Ts,e as $,I as We,S as At,z as $t,C as Tt,E as zt,F as Qe,q as pe,d as Lt,A as xs,r as hs,t as Ws,G as pa,D as Me,g as Ue,h as qe,i as ga,j as ls,k as Q,w as fa}from"./index-DGGXJgUa.js";import{P as ee}from"./progress-D6O6TLpv.js";import{T as ja,a as ya,b as ba,c as Na}from"./tooltip-BPVdgY_7.js";import{a as va,l as wa,b as ka}from"./citation-library-DsFrzEV3.js";import{S as be}from"./slider-oUJ8z5Zt.js";import{T as bt,a as Nt,b as os,c as cs}from"./tabs-Dznm0vhG.js";import{ah as us,L as q,E as Ce,q as Rt,a as Ae,d as Ne,aj as zs,az as ts,v as Ge,U as Be,b1 as Qs,aI as vt,am as wt,V as Ks,aa as _a,aB as Ca,T as De,R as Sa,c as $e,$ as Bs,l as ps,x as Gs,Y as Ls,r as Ve,X as Ea,a1 as Ys,Q as Ft,h as ss,P as Se,ad as Aa,ai as $a,w as It,b2 as Ta,S as Ee,aK as Te,b0 as Ot,M as za,b3 as kt,b4 as He,aP as Js,b5 as ds,aR as La,C as ms,a0 as Ra,A as Fa,a2 as Ia,ay as _t,I as Oa,b6 as Pa,b7 as Ma,a9 as es,aO as Ua,b8 as qa,b9 as Da,ba as Ha}from"./icons-x9tcvtYN.js";import{S as Va}from"./separator-C04pRlKv.js";import"./state-vendor-BXB5jEEt.js";function Ct(i,f){const x=Wa(i),D=Qa(i.author),{year:P,month:I,day:C}=Ba(i.publish_date),z={authors:D,title:i.title||"Untitled",year:P,month:I,day:C,url:f||i.url,siteName:i.domain,accessDate:new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})};return x==="news"&&(z.publication=i.domain),{sourceType:x,fields:z}}function Wa(i){if(i.is_social_media)return"website";const f=["news","times","post","guardian","reuters","cnn","bbc","npr"],x=i.domain.toLowerCase();return f.some(I=>x.includes(I))?"news":["journal","academic",".edu","research","pubmed","scholar"].some(I=>x.includes(I))?"journal":[".gov",".org","report","whitepaper"].some(I=>x.includes(I))?"report":"website"}function Qa(i){if(!i||i.trim()==="")return[{firstName:"",lastName:"",middleName:""}];if(i.includes(",")){const x=i.split(",").map(D=>D.trim());return[{firstName:x[1]||"",lastName:x[0]||"",middleName:""}]}const f=i.trim().split(/\s+/);return f.length===1?[{firstName:"",lastName:f[0],middleName:""}]:f.length===2?[{firstName:f[0],lastName:f[1],middleName:""}]:[{firstName:f[0],middleName:f.slice(1,-1).join(" "),lastName:f[f.length-1]}]}function Ba(i){if(!i)return{};try{const f=new Date(i);if(isNaN(f.getTime())){const x=i.match(/\b(19|20)\d{2}\b/);return x?{year:x[0]}:{}}return{year:f.getFullYear().toString(),month:(f.getMonth()+1).toString().padStart(2,"0"),day:f.getDate().toString().padStart(2,"0")}}catch{return{}}}function Ga(i){const f=new URLSearchParams;if(f.set("sourceType",i.sourceType),f.set("title",i.fields.title),i.fields.url&&f.set("url",i.fields.url),i.fields.siteName&&f.set("siteName",i.fields.siteName),i.fields.year&&f.set("year",i.fields.year),i.fields.month&&f.set("month",i.fields.month),i.fields.day&&f.set("day",i.fields.day),i.fields.accessDate&&f.set("accessDate",i.fields.accessDate),i.fields.authors&&i.fields.authors.length>0){const x=i.fields.authors[0];x.firstName&&f.set("firstName",x.firstName),x.lastName&&f.set("lastName",x.lastName),x.middleName&&f.set("middleName",x.middleName)}return i.fields.publication&&f.set("publication",i.fields.publication),i.fields.publisher&&f.set("publisher",i.fields.publisher),f}function Ja({claimAdjustmentId:i,onLinked:f}){const[x,D]=o.useState(!1),[P,I]=o.useState(""),[C,z]=o.useState(!1),[T,H]=o.useState([]),[S,ne]=o.useState([]),[oe,W]=o.useState(!1),[t,B]=o.useState(null),[O,G]=o.useState("supports"),[p,M]=o.useState(75),[le,ce]=o.useState(75),[se,ge]=o.useState(""),[fe,je]=o.useState(!1);o.useEffect(()=>{x&&me()},[x]);const me=async()=>{try{W(!0);const h=await fetch(`/api/claims/get-evidence-links/${i}`,{credentials:"include"});if(!h.ok)throw new Error("Failed to load linked evidence");const J=await h.json();J.success&&ne(J.links||[])}catch(h){console.error("Error loading linked evidence:",h)}finally{W(!1)}},te=async()=>{try{z(!0);const h=new URLSearchParams({q:P,limit:"20",claim_id:i}),J=await fetch(`/api/claims/search-evidence?${h}`,{credentials:"include"});if(!J.ok)throw new Error("Failed to search evidence");const ye=await J.json();ye.success&&H(ye.evidence||[])}catch(h){console.error("Error searching evidence:",h)}finally{z(!1)}},de=async()=>{if(t)try{je(!0);const h=await fetch("/api/claims/link-evidence",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({claim_adjustment_id:i,evidence_id:t.id,relationship:O,relevance_score:p,confidence:le,notes:se||void 0})});if(!h.ok){const J=await h.json();throw new Error(J.error||"Failed to link evidence")}B(null),ge(""),M(75),ce(75),G("supports"),await me(),P&&await te(),f?.()}catch(h){console.error("Error linking evidence:",h),alert(h instanceof Error?h.message:"Failed to link evidence")}finally{je(!1)}},ve=async h=>{if(confirm("Remove this evidence link?"))try{if(!(await fetch(`/api/claims/remove-evidence-link/${h}`,{method:"DELETE",credentials:"include"})).ok)throw new Error("Failed to remove link");await me(),P&&await te(),f?.()}catch(J){console.error("Error removing link:",J),alert("Failed to remove evidence link")}},ae=h=>{switch(h){case"supports":return"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400";case"contradicts":return"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400";case"provides_context":return"bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-400";default:return"bg-gray-100 text-gray-700 dark:bg-gray-900/20 dark:text-gray-400"}},we=h=>{switch(h){case"supports":return e.jsx(zs,{className:"h-3 w-3"});case"contradicts":return e.jsx(ts,{className:"h-3 w-3"});case"provides_context":return e.jsx(Ge,{className:"h-3 w-3"});default:return null}};return e.jsxs(gs,{open:x,onOpenChange:D,children:[e.jsx(Et,{asChild:!0,children:e.jsxs(c,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(us,{className:"h-4 w-4"}),"Link Evidence (",S.length,")"]})}),e.jsxs(fs,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(js,{children:[e.jsx(ys,{children:"Link Evidence to Claim"}),e.jsx(Ts,{children:"Connect evidence from your library to support, contradict, or provide context for this claim"})]}),e.jsxs("div",{className:"space-y-6",children:[oe?e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(q,{className:"h-4 w-4 animate-spin"}),"Loading linked evidence..."]}):S.length>0?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h4",{className:"font-semibold text-sm",children:["Linked Evidence (",S.length,")"]}),e.jsx("div",{className:"space-y-2",children:S.map(h=>e.jsx(j,{className:"p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs($,{className:ae(h.relationship),children:[we(h.relationship),e.jsx("span",{className:"ml-1",children:h.relationship.replace("_"," ").toUpperCase()})]}),e.jsx("span",{className:"text-sm font-medium",children:h.title})]}),h.content_snippet&&e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2",children:h.content_snippet}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Relevance: ",h.relevance_score,"%"]}),e.jsxs("span",{children:["Confidence: ",h.confidence,"%"]}),h.credibility_score&&e.jsxs("span",{children:["Credibility: ",h.credibility_score,"/100"]})]}),h.notes&&e.jsxs("p",{className:"text-xs italic text-muted-foreground",children:["Note: ",h.notes]})]}),e.jsxs("div",{className:"flex gap-1",children:[h.source_url&&e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>window.open(h.source_url,"_blank"),children:e.jsx(Ce,{className:"h-3 w-3"})}),e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>ve(h.link_id),children:e.jsx(Rt,{className:"h-3 w-3"})})]})]})},h.link_id))})]}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No evidence linked yet"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-semibold text-sm",children:"Add New Evidence Link"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(We,{placeholder:"Search your evidence library...",value:P,onChange:h=>I(h.target.value),onKeyDown:h=>h.key==="Enter"&&te()}),e.jsx(c,{onClick:te,disabled:C,children:C?e.jsx(q,{className:"h-4 w-4 animate-spin"}):e.jsx(Ae,{className:"h-4 w-4"})})]}),T.length>0&&e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:T.map(h=>e.jsx(j,{className:`p-3 cursor-pointer transition-colors ${t?.id===h.id?"ring-2 ring-primary":"hover:bg-accent"}`,onClick:()=>B(h),children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:h.title})]}),h.content_snippet&&e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2 ml-6",children:h.content_snippet}),e.jsxs("div",{className:"flex items-center gap-2 ml-6",children:[e.jsx($,{variant:"outline",className:"text-xs",children:h.source_type}),h.credibility_score&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Credibility: ",h.credibility_score,"/100"]})]})]})},h.id))}),t&&e.jsxs("div",{className:"space-y-4 p-4 bg-accent rounded-lg",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Relationship Type"}),e.jsxs(At,{value:O,onValueChange:h=>G(h),children:[e.jsx($t,{children:e.jsx(Tt,{})}),e.jsxs(zt,{children:[e.jsx(Qe,{value:"supports",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(zs,{className:"h-4 w-4 text-green-600"}),"Supports - Evidence confirms the claim"]})}),e.jsx(Qe,{value:"contradicts",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ts,{className:"h-4 w-4 text-red-600"}),"Contradicts - Evidence refutes the claim"]})}),e.jsx(Qe,{value:"provides_context",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"h-4 w-4 text-blue-600"}),"Provides Context - Evidence adds background"]})})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium",children:["Relevance Score: ",p,"%"]}),e.jsx(be,{value:[p],onValueChange:h=>M(h[0]),min:0,max:100,step:5})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium",children:["Confidence: ",le,"%"]}),e.jsx(be,{value:[le],onValueChange:h=>ce(h[0]),min:0,max:100,step:5})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Notes (optional)"}),e.jsx(pe,{value:se,onChange:h=>ge(h.target.value),placeholder:"Why is this evidence relevant to the claim?",rows:2})]}),e.jsx(c,{onClick:de,disabled:fe,className:"w-full",children:fe?e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"h-4 w-4 mr-2 animate-spin"}),"Linking..."]}):e.jsxs(e.Fragment,{children:[e.jsx(us,{className:"h-4 w-4 mr-2"}),"Link Evidence"]})})]})]})]})]})]})}function Ka({claimAdjustmentId:i,onLinked:f}){const[x,D]=o.useState(!1),[P,I]=o.useState(""),[C,z]=o.useState(!1),[T,H]=o.useState([]),[S,ne]=o.useState([]),[oe,W]=o.useState(null),[t,B]=o.useState(!1),[O,G]=o.useState(null),[p,M]=o.useState("claim_maker"),[le,ce]=o.useState(0),[se,ge]=o.useState(""),[fe,je]=o.useState(!1);o.useEffect(()=>{x&&me()},[x]);const me=async()=>{try{B(!0);const u=await fetch(`/api/claims/get-claim-entities/${i}`,{credentials:"include"});if(!u.ok)throw new Error("Failed to load linked entities");const v=await u.json();v.success&&(ne(v.entities||[]),W(v.grouped_by_role||null))}catch(u){console.error("Error loading linked entities:",u)}finally{B(!1)}},te=async()=>{try{z(!0);const u=new URLSearchParams({q:P,limit:"20",claim_id:i}),v=await fetch(`/api/claims/search-actors?${u}`,{credentials:"include"});if(!v.ok)throw new Error("Failed to search actors");const K=await v.json();K.success&&H(K.actors||[])}catch(u){console.error("Error searching actors:",u)}finally{z(!1)}},de=async()=>{if(O)try{je(!0);const u=await fetch("/api/claims/link-entity",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({claim_adjustment_id:i,entity_id:O.id,entity_name:O.name,entity_type:O.type||"other",role:p,context:se||void 0,credibility_impact:le})});if(!u.ok){const v=await u.json();throw new Error(v.error||"Failed to link entity")}G(null),ge(""),ce(0),M("claim_maker"),await me(),P&&await te(),f?.()}catch(u){console.error("Error linking entity:",u),alert(u instanceof Error?u.message:"Failed to link entity")}finally{je(!1)}},ve=async u=>{if(confirm("Remove this entity mention?"))try{if(!(await fetch(`/api/claims/remove-entity-mention/${u}`,{method:"DELETE",credentials:"include"})).ok)throw new Error("Failed to remove mention");await me(),P&&await te(),f?.()}catch(v){console.error("Error removing mention:",v),alert("Failed to remove entity mention")}},ae=u=>{switch(u){case"claim_maker":return"bg-purple-100 text-purple-700 dark:bg-purple-900/20 dark:text-purple-400";case"subject":return"bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-400";case"mentioned":return"bg-gray-100 text-gray-700 dark:bg-gray-900/20 dark:text-gray-400";case"affected":return"bg-orange-100 text-orange-700 dark:bg-orange-900/20 dark:text-orange-400";default:return"bg-gray-100 text-gray-700 dark:bg-gray-900/20 dark:text-gray-400"}},we=u=>{switch(u){case"claim_maker":return e.jsx(Qs,{className:"h-3 w-3"});case"subject":return e.jsx(Be,{className:"h-3 w-3"});case"mentioned":return e.jsx(vt,{className:"h-3 w-3"});case"affected":return e.jsx(wt,{className:"h-3 w-3"});default:return null}},h=u=>u>10?e.jsx(Ks,{className:"h-3 w-3 text-green-600"}):u<-10?e.jsx(_a,{className:"h-3 w-3 text-red-600"}):e.jsx(Ca,{className:"h-3 w-3 text-gray-600"}),J=u=>u>10?"text-green-700 dark:text-green-400":u<-10?"text-red-700 dark:text-red-400":"text-gray-700 dark:text-gray-400",ye=S.length;return e.jsxs(gs,{open:x,onOpenChange:D,children:[e.jsx(Et,{asChild:!0,children:e.jsxs(c,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(Be,{className:"h-4 w-4"}),"Link Entities (",ye,")"]})}),e.jsxs(fs,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(js,{children:[e.jsx(ys,{children:"Link Entities to Claim"}),e.jsx(Ts,{children:"Track who made the claim, who/what it's about, and assess credibility impact"})]}),e.jsxs("div",{className:"space-y-6",children:[t?e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(q,{className:"h-4 w-4 animate-spin"}),"Loading linked entities..."]}):S.length>0?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-semibold text-sm",children:["Linked Entities (",ye,")"]}),oe&&Object.entries(oe).map(([u,v])=>v.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs($,{className:ae(u),children:[we(u),e.jsx("span",{className:"ml-1",children:u.replace("_"," ").toUpperCase()})]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",v.length,")"]})]}),e.jsx("div",{className:"space-y-2 ml-4",children:v.map(K=>e.jsx(j,{className:"p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:K.entity_name}),e.jsx($,{variant:"outline",className:"text-xs",children:K.entity_type})]}),e.jsx("div",{className:"flex items-center gap-3 text-xs",children:e.jsxs("span",{className:`flex items-center gap-1 ${J(K.credibility_impact)}`,children:[h(K.credibility_impact),"Impact: ",K.credibility_impact>0?"+":"",K.credibility_impact]})}),K.context&&e.jsx("p",{className:"text-xs text-muted-foreground italic",children:K.context})]}),e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>ve(K.id),children:e.jsx(Rt,{className:"h-3 w-3"})})]})},K.id))})]},u))]}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No entities linked yet"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-semibold text-sm",children:"Add Entity"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(We,{placeholder:"Search actors in your library...",value:P,onChange:u=>I(u.target.value),onKeyDown:u=>u.key==="Enter"&&te()}),e.jsx(c,{onClick:te,disabled:C,children:C?e.jsx(q,{className:"h-4 w-4 animate-spin"}):e.jsx(Ae,{className:"h-4 w-4"})})]}),T.length>0&&e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:T.map(u=>e.jsx(j,{className:`p-3 cursor-pointer transition-colors ${O?.id===u.id?"ring-2 ring-primary":"hover:bg-accent"}`,onClick:()=>G(u),children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qs,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:u.name})]}),u.description&&e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-1 ml-6",children:u.description}),e.jsxs("div",{className:"flex items-center gap-2 ml-6",children:[e.jsx($,{variant:"outline",className:"text-xs",children:u.type}),u.credibility_rating&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Credibility: ",u.credibility_rating,"/100"]}),u.bias_rating&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Bias: ",u.bias_rating]})]})]})},u.id))}),O&&e.jsxs("div",{className:"space-y-4 p-4 bg-accent rounded-lg",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Entity Role in Claim"}),e.jsxs(At,{value:p,onValueChange:u=>M(u),children:[e.jsx($t,{children:e.jsx(Tt,{})}),e.jsxs(zt,{children:[e.jsx(Qe,{value:"claim_maker",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qs,{className:"h-4 w-4"}),"Claim Maker - Who made this statement"]})}),e.jsx(Qe,{value:"subject",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Be,{className:"h-4 w-4"}),"Subject - Who/what the claim is about"]})}),e.jsx(Qe,{value:"mentioned",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(vt,{className:"h-4 w-4"}),"Mentioned - Referenced in the claim"]})}),e.jsx(Qe,{value:"affected",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(wt,{className:"h-4 w-4"}),"Affected - Impacted by the claim"]})})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium",children:["Credibility Impact: ",le>0?"+":"",le]}),e.jsx(be,{value:[le],onValueChange:u=>ce(u[0]),min:-50,max:50,step:5}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:"Decreases (-50)"}),e.jsx("span",{children:"Neutral (0)"}),e.jsx("span",{children:"Increases (+50)"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"How does this entity's involvement affect claim credibility?"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Context (optional)"}),e.jsx(pe,{value:se,onChange:u=>ge(u.target.value),placeholder:"Additional context about this entity's role...",rows:2})]}),e.jsx(c,{onClick:de,disabled:fe,className:"w-full",children:fe?e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"h-4 w-4 mr-2 animate-spin"}),"Linking..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Be,{className:"h-4 w-4 mr-2"}),"Link Entity"]})})]})]})]})]})]})}function Ya({contentAnalysisId:i,claimAnalysis:f}){const{toast:x}=Lt();if(!f||!f.claims||f.claims.length===0)return null;const[D,P]=o.useState(f),{claims:I,summary:C}=D,z=I.some(l=>l.deception_analysis.risk_score===null||l.deception_analysis.methods.internal_consistency.score===null),[T,H]=o.useState(null),[S,ne]=o.useState({}),[oe,W]=o.useState(50),[t,B]=o.useState(""),[O,G]=o.useState(""),[p,M]=o.useState({internal_consistency:{score:50,reasoning:""},source_credibility:{score:50,reasoning:""},evidence_quality:{score:50,reasoning:""},logical_coherence:{score:50,reasoning:""},temporal_consistency:{score:50,reasoning:""},specificity:{score:50,reasoning:""}}),[le,ce]=o.useState(!0),[se,ge]=o.useState(!1),[fe,je]=o.useState(null),[me,te]=o.useState(!1),[de,ve]=o.useState({}),[ae,we]=o.useState({}),[h,J]=o.useState({});o.useEffect(()=>{(async()=>{try{ce(!0),je(null);const m=await fetch(`/api/claims/get-adjustments/${i}`,{credentials:"include"});if(!m.ok){if(m.status===404){console.log("No saved adjustments found for this content"),ce(!1);return}throw new Error(`Failed to load adjustments: ${m.statusText}`)}const y=m.headers.get("content-type");if(!y||!y.includes("application/json")){console.warn("Non-JSON response received for claim adjustments"),ce(!1);return}const L=await m.json();if(L.success&&L.adjustments){const Y={};L.adjustments.forEach(k=>{Y[k.claim_index]={id:k.id,adjustedRiskScore:k.adjusted_risk_score,userComment:k.user_comment||"",adjustedAt:k.updated_at}}),ne(Y)}}catch(m){console.error("Error loading claim adjustments:",m),je(m instanceof Error?m.message:"Unknown error")}finally{ce(!1)}})()},[i]);const ye=(l,m)=>{H(l);const y=I[l],L=S[l];W(L?.adjustedRiskScore??m),B(L?.userComment??""),G(y.claim),M({internal_consistency:{score:y.deception_analysis.methods.internal_consistency.score??50,reasoning:y.deception_analysis.methods.internal_consistency.reasoning??""},source_credibility:{score:y.deception_analysis.methods.source_credibility.score??50,reasoning:y.deception_analysis.methods.source_credibility.reasoning??""},evidence_quality:{score:y.deception_analysis.methods.evidence_quality.score??50,reasoning:y.deception_analysis.methods.evidence_quality.reasoning??""},logical_coherence:{score:y.deception_analysis.methods.logical_coherence.score??50,reasoning:y.deception_analysis.methods.logical_coherence.reasoning??""},temporal_consistency:{score:y.deception_analysis.methods.temporal_consistency.score??50,reasoning:y.deception_analysis.methods.temporal_consistency.reasoning??""},specificity:{score:y.deception_analysis.methods.specificity.score??50,reasoning:y.deception_analysis.methods.specificity.reasoning??""}})},u=()=>{H(null),W(50),B(""),G(""),M({internal_consistency:{score:50,reasoning:""},source_credibility:{score:50,reasoning:""},evidence_quality:{score:50,reasoning:""},logical_coherence:{score:50,reasoning:""},temporal_consistency:{score:50,reasoning:""},specificity:{score:50,reasoning:""}})},v=async l=>{try{ge(!0);const m=I[l],y={content_analysis_id:i,claim_index:l,claim_text:m.claim,claim_category:m.category,original_risk_score:m.deception_analysis.risk_score,original_overall_risk:m.deception_analysis.overall_risk,original_methods:m.deception_analysis.methods,adjusted_risk_score:oe,adjusted_claim_text:O!==m.claim?O:null,adjusted_methods:p,user_comment:t,verification_status:"pending"},L=await fetch("/api/claims/save-adjustment",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(y)});if(!L.ok)throw new Error(`Failed to save adjustment: ${L.statusText}`);const Y=await L.json();Y.success&&(ne({...S,[l]:{id:Y.id,adjustedRiskScore:oe,userComment:t,adjustedClaimText:O,adjustedMethods:p,adjustedAt:new Date().toISOString()}}),H(null),W(50),B(""),G(""),M({internal_consistency:{score:50,reasoning:""},source_credibility:{score:50,reasoning:""},evidence_quality:{score:50,reasoning:""},logical_coherence:{score:50,reasoning:""},temporal_consistency:{score:50,reasoning:""},specificity:{score:50,reasoning:""}}))}catch(m){console.error("Error saving adjustment:",m),alert("Failed to save adjustment. Please try again.")}finally{ge(!1)}},K=(l,m)=>S[l]?.adjustedRiskScore??m,Rs=l=>{switch(l){case"low":return"text-green-700 bg-green-100 dark:text-green-400 dark:bg-green-900/20";case"medium":return"text-yellow-700 bg-yellow-100 dark:text-yellow-400 dark:bg-yellow-900/20";case"high":return"text-red-700 bg-red-100 dark:text-red-400 dark:bg-red-900/20"}},bs=l=>{switch(l){case"low":return e.jsx(zs,{className:"h-4 w-4"});case"medium":return e.jsx(De,{className:"h-4 w-4"});case"high":return e.jsx(ts,{className:"h-4 w-4"})}},ze=l=>{switch(l){case"statement":return e.jsx(Ne,{className:"h-4 w-4"});case"quote":return e.jsx(Ta,{className:"h-4 w-4"});case"statistic":return e.jsx(It,{className:"h-4 w-4"});case"event":return e.jsx($a,{className:"h-4 w-4"});case"relationship":return e.jsx(Aa,{className:"h-4 w-4"});default:return e.jsx(Ge,{className:"h-4 w-4"})}},Fs=l=>{switch(l){case"statement":return"bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-400";case"quote":return"bg-purple-100 text-purple-700 dark:bg-purple-900/20 dark:text-purple-400";case"statistic":return"bg-orange-100 text-orange-700 dark:bg-orange-900/20 dark:text-orange-400";case"event":return"bg-teal-100 text-teal-700 dark:bg-teal-900/20 dark:text-teal-400";case"relationship":return"bg-pink-100 text-pink-700 dark:bg-pink-900/20 dark:text-pink-400";default:return"bg-gray-100 text-gray-700 dark:bg-gray-900/20 dark:text-gray-400"}},ke=l=>l==null?"text-gray-600 dark:text-gray-400":l>=80?"text-green-600 dark:text-green-400":l>=60?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400",Ns=async l=>{try{const m=await fetch(`/api/claims/export-markdown/${l}`,{credentials:"include"});if(!m.ok)throw new Error("Failed to export claim");const y=await m.blob(),L=window.URL.createObjectURL(y),Y=document.createElement("a");Y.href=L,Y.download=`claim-${l.substring(0,8)}-${Date.now()}.md`,document.body.appendChild(Y),Y.click(),window.URL.revokeObjectURL(L),document.body.removeChild(Y)}catch(m){console.error("Error exporting claim:",m),alert("Failed to export claim to Markdown")}},vs=async()=>{try{te(!0);const l=await fetch(`/api/claims/retry-analysis/${i}`,{method:"POST",credentials:"include"});if(!l.ok){const y=await l.json();throw new Error(y.error||"Failed to retry analysis")}const m=await l.json();m.success&&m.claim_analysis&&(P(m.claim_analysis),x({title:"Analysis Complete",description:"AI claim analysis has been successfully re-run",variant:"default"}))}catch(l){console.error("Error retrying analysis:",l),x({title:"Retry Failed",description:l instanceof Error?l.message:"Failed to retry AI analysis",variant:"destructive"})}finally{te(!1)}},ws=async l=>{try{ve({...de,[l]:!0});const m=await fetch(`/api/claims/share/${l}`,{method:"POST",credentials:"include"});if(!m.ok){const L=await m.json();throw new Error(L.error||"Failed to create share link")}const y=await m.json();y.success&&y.share_url&&(we({...ae,[l]:y.share_url}),x({title:"Share Link Created",description:"Public link has been generated for this claim",variant:"default"}))}catch(m){console.error("Error sharing claim:",m),x({title:"Share Failed",description:m instanceof Error?m.message:"Failed to create share link",variant:"destructive"})}finally{ve({...de,[l]:!1})}},Le=async(l,m)=>{try{await navigator.clipboard.writeText(m),J({...h,[l]:!0}),x({title:"Link Copied",description:"Share link has been copied to clipboard",variant:"default"}),setTimeout(()=>{J({...h,[l]:!1})},2e3)}catch(y){console.error("Error copying to clipboard:",y),x({title:"Copy Failed",description:"Failed to copy link to clipboard",variant:"destructive"})}},Is=(l,m)=>{localStorage.setItem("ach_hypothesis_from_claim",JSON.stringify({hypothesis:l,source:"Claims Analysis",contentAnalysisId:i,claimIndex:m,timestamp:new Date().toISOString()})),x({title:"Hypothesis Set",description:"Navigate to ACH Analysis to use this claim as a hypothesis",variant:"default"}),window.location.href="/dashboard/frameworks/ach"},_e=(l,m)=>{localStorage.setItem("research_plan_from_claim",JSON.stringify({question:l,source:"Claims Analysis",contentAnalysisId:i,claimIndex:m,timestamp:new Date().toISOString()})),x({title:"Research Plan Started",description:"Navigate to Research Question Generator to develop a plan for this claim",variant:"default"}),window.location.href="/dashboard/tools/research-questions"},as=async(l,m)=>{x({title:"Deep Analysis",description:"Deep deception analysis feature coming soon. This will perform enhanced multi-method analysis on this specific claim.",variant:"default"})};return e.jsxs("div",{className:"space-y-6",children:[le&&e.jsxs(xs,{children:[e.jsx(q,{className:"h-4 w-4 animate-spin"}),e.jsx(hs,{children:"Loading saved adjustments..."})]}),fe&&e.jsxs(xs,{variant:"destructive",children:[e.jsx(De,{className:"h-4 w-4"}),e.jsxs(hs,{children:["Failed to load saved adjustments: ",fe]})]}),z&&e.jsxs(xs,{variant:"destructive",className:"border-2",children:[e.jsx(De,{className:"h-5 w-5"}),e.jsxs(hs,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold mb-1",children:"AI Analysis Failed"}),e.jsx("p",{className:"text-sm",children:"Automated claim analysis could not be completed. You can retry the analysis or manually assess each claim below."})]}),e.jsx(c,{onClick:vs,disabled:me,className:"ml-4 shrink-0",variant:"outline",children:me?e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"h-4 w-4 mr-2 animate-spin"}),"Retrying..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Sa,{className:"h-4 w-4 mr-2"}),"Retry AI Analysis"]})})]})]}),e.jsxs(j,{className:"border-2",children:[e.jsx(X,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(ie,{className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-5 w-5"}),"Claim Analysis Summary"]}),e.jsxs(ua,{children:[C.total_claims," objective claims extracted and analyzed"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold",children:C.overall_content_credibility!==null&&C.overall_content_credibility!==void 0?C.overall_content_credibility:e.jsx("span",{className:"text-gray-400",children:"N/A"})}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Overall Credibility"})]})]})}),e.jsxs(Z,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-green-50 dark:bg-green-900/10",children:[e.jsx(zs,{className:"h-8 w-8 text-green-600 dark:text-green-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-green-700 dark:text-green-400",children:C.low_risk_claims}),e.jsx("div",{className:"text-sm text-green-600 dark:text-green-500",children:"Low Risk Claims"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-yellow-50 dark:bg-yellow-900/10",children:[e.jsx(De,{className:"h-8 w-8 text-yellow-600 dark:text-yellow-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-700 dark:text-yellow-400",children:C.medium_risk_claims}),e.jsx("div",{className:"text-sm text-yellow-600 dark:text-yellow-500",children:"Medium Risk Claims"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-red-50 dark:bg-red-900/10",children:[e.jsx(ts,{className:"h-8 w-8 text-red-600 dark:text-red-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-red-700 dark:text-red-400",children:C.high_risk_claims}),e.jsx("div",{className:"text-sm text-red-600 dark:text-red-500",children:"High Risk Claims"})]})]})]}),C.most_concerning_claim&&C.high_risk_claims>0&&e.jsxs(xs,{className:"mt-4 border-red-200 dark:border-red-800",children:[e.jsx(De,{className:"h-4 w-4 text-red-600"}),e.jsxs(hs,{children:[e.jsx("strong",{children:"Most Concerning Claim:"})," ",C.most_concerning_claim]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Extracted Claims (",I.length,")"]}),I.map((l,m)=>{const y=K(m,l.deception_analysis.risk_score),L=S[m]!==void 0,Y=T===m;return e.jsxs(j,{className:"border-l-4",style:{borderLeftColor:l.deception_analysis.overall_risk==="low"?"#10b981":l.deception_analysis.overall_risk==="medium"?"#f59e0b":"#ef4444"},children:[e.jsxs(X,{children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 flex-wrap",children:[e.jsxs($,{className:Fs(l.category),children:[ze(l.category),e.jsx("span",{className:"ml-1",children:l.category.toUpperCase()})]}),e.jsxs($,{className:Rs(l.deception_analysis.overall_risk),children:[bs(l.deception_analysis.overall_risk),e.jsxs("span",{className:"ml-1",children:[l.deception_analysis.overall_risk.toUpperCase()," RISK"]})]}),L&&e.jsxs($,{variant:"default",className:"bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-400",children:[e.jsx(Bs,{className:"h-3 w-3 mr-1"}),"User Adjusted"]}),l.source&&e.jsxs($,{variant:"outline",children:["Source: ",l.source]})]}),e.jsx("p",{className:"text-base font-medium leading-relaxed",children:l.claim})]}),e.jsxs("div",{className:"text-center min-w-[80px]",children:[e.jsxs("div",{className:`text-3xl font-bold ${y!==null?ke(100-y):"text-gray-400"}`,children:[y!==null?y:"N/A",L&&y!==l.deception_analysis.risk_score&&l.deception_analysis.risk_score!==null&&e.jsx("span",{className:"text-xs block text-gray-500 line-through",children:l.deception_analysis.risk_score})]}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Risk Score"}),!Y&&e.jsxs(c,{size:"sm",variant:"ghost",className:"mt-2 h-7 text-xs",onClick:()=>ye(m,y),children:[e.jsx(Bs,{className:"h-3 w-3 mr-1"}),L?"Edit":"Adjust"]})]})]}),Y&&e.jsxs("div",{className:"mt-4 p-4 bg-blue-50 dark:bg-blue-900/10 rounded-lg space-y-4",children:[e.jsxs(bt,{defaultValue:"overall",className:"w-full",children:[e.jsxs(Nt,{className:"grid w-full grid-cols-3",children:[e.jsx(os,{value:"overall",children:"Overall"}),e.jsx(os,{value:"claim",children:"Claim Text"}),e.jsx(os,{value:"methods",children:"Method Scores"})]}),e.jsxs(cs,{value:"overall",className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium",children:["Adjust Risk Score: ",oe]}),e.jsx(be,{value:[oe],onValueChange:k=>W(k[0]),min:0,max:100,step:1,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 dark:text-gray-400",children:[e.jsx("span",{children:"Low Risk (0)"}),e.jsx("span",{children:"Medium Risk (50)"}),e.jsx("span",{children:"High Risk (100)"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ps,{className:"h-4 w-4"}),"Your Assessment Comments"]}),e.jsx(pe,{value:t,onChange:k=>B(k.target.value),placeholder:"Explain your assessment... (optional)",rows:3,className:"w-full"})]})]}),e.jsx(cs,{value:"claim",className:"space-y-4 mt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Bs,{className:"h-4 w-4"}),"Edit Claim Wording"]}),e.jsx(pe,{value:O,onChange:k=>G(k.target.value),placeholder:"Edit the claim text...",rows:4,className:"w-full font-medium"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Refine the claim wording to be more precise or correct any errors."})]})}),e.jsxs(cs,{value:"methods",className:"space-y-6 mt-4 max-h-96 overflow-y-auto",children:[e.jsxs("div",{className:"space-y-2 pb-4 border-b",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Gs,{className:"h-4 w-4"}),"Internal Consistency"]}),e.jsx("span",{className:"text-sm font-bold",children:p.internal_consistency.score})]}),e.jsx(be,{value:[p.internal_consistency.score],onValueChange:k=>M({...p,internal_consistency:{...p.internal_consistency,score:k[0]}}),min:0,max:100,step:1,className:"w-full"}),e.jsx(pe,{value:p.internal_consistency.reasoning,onChange:k=>M({...p,internal_consistency:{...p.internal_consistency,reasoning:k.target.value}}),placeholder:"Reasoning...",rows:2,className:"text-xs"})]}),e.jsxs("div",{className:"space-y-2 pb-4 border-b",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx($e,{className:"h-4 w-4"}),"Source Credibility"]}),e.jsx("span",{className:"text-sm font-bold",children:p.source_credibility.score})]}),e.jsx(be,{value:[p.source_credibility.score],onValueChange:k=>M({...p,source_credibility:{...p.source_credibility,score:k[0]}}),min:0,max:100,step:1,className:"w-full"}),e.jsx(pe,{value:p.source_credibility.reasoning,onChange:k=>M({...p,source_credibility:{...p.source_credibility,reasoning:k.target.value}}),placeholder:"Reasoning...",rows:2,className:"text-xs"})]}),e.jsxs("div",{className:"space-y-2 pb-4 border-b",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ne,{className:"h-4 w-4"}),"Evidence Quality"]}),e.jsx("span",{className:"text-sm font-bold",children:p.evidence_quality.score})]}),e.jsx(be,{value:[p.evidence_quality.score],onValueChange:k=>M({...p,evidence_quality:{...p.evidence_quality,score:k[0]}}),min:0,max:100,step:1,className:"w-full"}),e.jsx(pe,{value:p.evidence_quality.reasoning,onChange:k=>M({...p,evidence_quality:{...p.evidence_quality,reasoning:k.target.value}}),placeholder:"Reasoning...",rows:2,className:"text-xs"})]}),e.jsxs("div",{className:"space-y-2 pb-4 border-b",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ks,{className:"h-4 w-4"}),"Logical Coherence"]}),e.jsx("span",{className:"text-sm font-bold",children:p.logical_coherence.score})]}),e.jsx(be,{value:[p.logical_coherence.score],onValueChange:k=>M({...p,logical_coherence:{...p.logical_coherence,score:k[0]}}),min:0,max:100,step:1,className:"w-full"}),e.jsx(pe,{value:p.logical_coherence.reasoning,onChange:k=>M({...p,logical_coherence:{...p.logical_coherence,reasoning:k.target.value}}),placeholder:"Reasoning...",rows:2,className:"text-xs"})]}),e.jsxs("div",{className:"space-y-2 pb-4 border-b",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ls,{className:"h-4 w-4"}),"Temporal Consistency"]}),e.jsx("span",{className:"text-sm font-bold",children:p.temporal_consistency.score})]}),e.jsx(be,{value:[p.temporal_consistency.score],onValueChange:k=>M({...p,temporal_consistency:{...p.temporal_consistency,score:k[0]}}),min:0,max:100,step:1,className:"w-full"}),e.jsx(pe,{value:p.temporal_consistency.reasoning,onChange:k=>M({...p,temporal_consistency:{...p.temporal_consistency,reasoning:k.target.value}}),placeholder:"Reasoning...",rows:2,className:"text-xs"})]}),e.jsxs("div",{className:"space-y-2 pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ge,{className:"h-4 w-4"}),"Specificity"]}),e.jsx("span",{className:"text-sm font-bold",children:p.specificity.score})]}),e.jsx(be,{value:[p.specificity.score],onValueChange:k=>M({...p,specificity:{...p.specificity,score:k[0]}}),min:0,max:100,step:1,className:"w-full"}),e.jsx(pe,{value:p.specificity.reasoning,onChange:k=>M({...p,specificity:{...p.specificity,reasoning:k.target.value}}),placeholder:"Reasoning...",rows:2,className:"text-xs"})]})]})]}),e.jsxs("div",{className:"flex gap-2 pt-2 border-t",children:[e.jsx(c,{size:"sm",onClick:()=>v(m),className:"flex-1",disabled:se,children:se?e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"h-4 w-4 mr-2 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ve,{className:"h-4 w-4 mr-2"}),"Save All Changes"]})}),e.jsxs(c,{size:"sm",variant:"outline",onClick:u,disabled:se,children:[e.jsx(Ea,{className:"h-4 w-4 mr-2"}),"Cancel"]})]})]}),!Y&&L&&S[m].userComment&&e.jsx("div",{className:"mt-4 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ps,{className:"h-4 w-4 mt-0.5 text-blue-600 dark:text-blue-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-blue-700 dark:text-blue-400 mb-1",children:"Your Assessment:"}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:S[m].userComment}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Adjusted ",new Date(S[m].adjustedAt).toLocaleString()]})]})]})}),L&&S[m].id&&e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(Ja,{claimAdjustmentId:S[m].id}),e.jsx(Ka,{claimAdjustmentId:S[m].id}),e.jsxs(c,{variant:"outline",size:"sm",className:"gap-2",onClick:()=>Ns(S[m].id),children:[e.jsx(Ys,{className:"h-4 w-4"}),"Export to Markdown"]}),e.jsx(c,{variant:"outline",size:"sm",className:"gap-2",onClick:()=>ws(S[m].id),disabled:de[S[m].id],children:de[S[m].id]?e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"h-4 w-4 animate-spin"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ft,{className:"h-4 w-4"}),"Share Claim"]})})]}),ae[S[m].id]&&e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-blue-50 dark:bg-blue-900/20 rounded",children:[e.jsx(We,{value:ae[S[m].id],readOnly:!0,className:"flex-1 text-sm font-mono"}),e.jsx(c,{size:"sm",variant:"ghost",onClick:()=>Le(S[m].id,ae[S[m].id]),children:h[S[m].id]?e.jsxs(e.Fragment,{children:[e.jsx(ss,{className:"h-4 w-4 mr-1"}),"Copied!"]}):e.jsxs(e.Fragment,{children:[e.jsx(Se,{className:"h-4 w-4 mr-1"}),"Copy Link"]})})]})]})]}),e.jsxs(Z,{children:[e.jsxs(bt,{defaultValue:"methods",className:"w-full",children:[e.jsxs(Nt,{className:"grid w-full grid-cols-2",children:[e.jsx(os,{value:"methods",children:"Detection Methods"}),e.jsx(os,{value:"assessment",children:"Assessment"})]}),e.jsxs(cs,{value:"methods",className:"space-y-3 mt-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"font-medium flex items-center gap-2",children:[e.jsx(Gs,{className:"h-4 w-4"}),"Internal Consistency"]}),e.jsx("span",{className:`font-bold ${l.deception_analysis.methods.internal_consistency.score!==null?ke(l.deception_analysis.methods.internal_consistency.score):"text-gray-400"}`,children:l.deception_analysis.methods.internal_consistency.score??"N/A"})]}),l.deception_analysis.methods.internal_consistency.score!==null?e.jsx(ee,{value:l.deception_analysis.methods.internal_consistency.score,className:"h-2"}):e.jsx("div",{className:"h-2 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:l.deception_analysis.methods.internal_consistency.reasoning})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"font-medium flex items-center gap-2",children:[e.jsx($e,{className:"h-4 w-4"}),"Source Credibility"]}),e.jsx("span",{className:`font-bold ${l.deception_analysis.methods.source_credibility.score!==null?ke(l.deception_analysis.methods.source_credibility.score):"text-gray-400"}`,children:l.deception_analysis.methods.source_credibility.score??"N/A"})]}),l.deception_analysis.methods.source_credibility.score!==null?e.jsx(ee,{value:l.deception_analysis.methods.source_credibility.score,className:"h-2"}):e.jsx("div",{className:"h-2 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:l.deception_analysis.methods.source_credibility.reasoning})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"font-medium flex items-center gap-2",children:[e.jsx(Ne,{className:"h-4 w-4"}),"Evidence Quality"]}),e.jsx("span",{className:`font-bold ${l.deception_analysis.methods.evidence_quality.score!==null?ke(l.deception_analysis.methods.evidence_quality.score):"text-gray-400"}`,children:l.deception_analysis.methods.evidence_quality.score??"N/A"})]}),l.deception_analysis.methods.evidence_quality.score!==null?e.jsx(ee,{value:l.deception_analysis.methods.evidence_quality.score,className:"h-2"}):e.jsx("div",{className:"h-2 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:l.deception_analysis.methods.evidence_quality.reasoning})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"font-medium flex items-center gap-2",children:[e.jsx(Ks,{className:"h-4 w-4"}),"Logical Coherence"]}),e.jsx("span",{className:`font-bold ${l.deception_analysis.methods.logical_coherence.score!==null?ke(l.deception_analysis.methods.logical_coherence.score):"text-gray-400"}`,children:l.deception_analysis.methods.logical_coherence.score??"N/A"})]}),l.deception_analysis.methods.logical_coherence.score!==null?e.jsx(ee,{value:l.deception_analysis.methods.logical_coherence.score,className:"h-2"}):e.jsx("div",{className:"h-2 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:l.deception_analysis.methods.logical_coherence.reasoning})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"font-medium flex items-center gap-2",children:[e.jsx(Ls,{className:"h-4 w-4"}),"Temporal Consistency"]}),e.jsx("span",{className:`font-bold ${l.deception_analysis.methods.temporal_consistency.score!==null?ke(l.deception_analysis.methods.temporal_consistency.score):"text-gray-400"}`,children:l.deception_analysis.methods.temporal_consistency.score??"N/A"})]}),l.deception_analysis.methods.temporal_consistency.score!==null?e.jsx(ee,{value:l.deception_analysis.methods.temporal_consistency.score,className:"h-2"}):e.jsx("div",{className:"h-2 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:l.deception_analysis.methods.temporal_consistency.reasoning})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"font-medium flex items-center gap-2",children:[e.jsx(Ge,{className:"h-4 w-4"}),"Specificity"]}),e.jsx("span",{className:`font-bold ${l.deception_analysis.methods.specificity.score!==null?ke(l.deception_analysis.methods.specificity.score):"text-gray-400"}`,children:l.deception_analysis.methods.specificity.score??"N/A"})]}),l.deception_analysis.methods.specificity.score!==null?e.jsx(ee,{value:l.deception_analysis.methods.specificity.score,className:"h-2"}):e.jsx("div",{className:"h-2 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:l.deception_analysis.methods.specificity.reasoning})]})]}),e.jsxs(cs,{value:"assessment",className:"space-y-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm mb-2",children:"Confidence Assessment"}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:l.deception_analysis.confidence_assessment})]}),l.deception_analysis.red_flags.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-sm mb-2 flex items-center gap-2 text-red-700 dark:text-red-400",children:[e.jsx(De,{className:"h-4 w-4"}),"Red Flags (",l.deception_analysis.red_flags.length,")"]}),e.jsx("ul",{className:"space-y-1",children:l.deception_analysis.red_flags.map((k,g)=>e.jsxs("li",{className:"text-sm text-red-600 dark:text-red-400 flex items-start gap-2",children:[e.jsx(ts,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:k})]},g))})]})]})]}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(Gs,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"}),e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Further Analysis Options"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(c,{size:"sm",variant:"outline",onClick:()=>Is(l.claim,m),className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-4 w-4"}),"Use as ACH Hypothesis"]}),e.jsxs(c,{size:"sm",variant:"outline",onClick:()=>_e(l.claim,m),className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"h-4 w-4"}),"Create Research Plan"]}),e.jsxs(c,{size:"sm",variant:"outline",onClick:()=>as(l.claim),className:"flex items-center gap-2",children:[e.jsx(De,{className:"h-4 w-4"}),"Deep Deception Analysis"]})]})]})]})]},m)})]})]})}const Xa=({status:i})=>{if(!i||i==="ready")return null;switch(i){case"processing":return e.jsx($,{variant:"secondary",className:"ml-auto bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300",children:e.jsx(q,{className:"h-3 w-3 animate-spin"})});case"complete":return e.jsx($,{variant:"default",className:"ml-auto bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300",children:e.jsx(ss,{className:"h-3 w-3"})});case"error":return e.jsx($,{variant:"destructive",className:"ml-auto",children:"Error"});case"idle":return e.jsx($,{variant:"outline",className:"ml-auto text-xs",children:"Not Run"});default:return null}},St=({activeTab:i,onTabChange:f,sections:x,onRunFramework:D,className:P})=>{const I=x.filter(T=>T.isAutomatic),C=x.filter(T=>!T.isAutomatic),z=T=>{const H=T.icon,S=i===T.id,ne=T.status==="idle"&&D&&!T.isAutomatic;return e.jsxs("div",{className:"relative",children:[e.jsx(c,{variant:S?"secondary":"ghost",className:Ws("w-full justify-start text-left h-auto py-3 px-3 group",S&&"bg-accent font-medium"),onClick:()=>f(T.id),children:e.jsxs("div",{className:"flex items-start gap-3 w-full",children:[e.jsx(H,{className:Ws("h-4 w-4 mt-0.5 shrink-0",S&&"text-primary")}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm truncate",children:T.label}),e.jsx(Xa,{status:T.status})]}),T.description&&e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5 line-clamp-2",children:T.description})]})]})}),ne&&e.jsx(c,{variant:"ghost",size:"sm",className:"absolute right-2 top-2 h-7 w-7 p-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:oe=>{oe.stopPropagation(),D(T.id)},title:`Run ${T.label} Analysis`,children:e.jsx(Ot,{className:"h-3 w-3"})})]},T.id)};return e.jsxs("div",{className:Ws("flex flex-col h-full border-r bg-muted/30",P),children:[e.jsx("div",{className:"p-4 border-b",children:e.jsx("h3",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide",children:"Analysis Sections"})}),e.jsx(pa,{className:"flex-1",children:e.jsxs("div",{className:"p-2 space-y-1",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"px-3 py-2 flex items-center gap-2",children:[e.jsx(Ee,{className:"h-3.5 w-3.5 text-muted-foreground"}),e.jsx("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Automatic"})]}),e.jsx("div",{className:"space-y-0.5",children:I.map(z)})]}),C.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Va,{className:"my-2"}),e.jsxs("div",{children:[e.jsxs("div",{className:"px-3 py-2 flex items-center gap-2",children:[e.jsx(Te,{className:"h-3.5 w-3.5 text-muted-foreground"}),e.jsx("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Frameworks"})]}),e.jsx("div",{className:"space-y-0.5",children:C.map(z)})]})]})]})})]})},Za=({activeTab:i,onTabChange:f,sections:x,onRunFramework:D,children:P})=>{const[I,C]=o.useState(!1),z=x.find(H=>H.id===i),T=H=>{f(H),C(!1)};return e.jsxs("div",{className:"flex flex-col lg:flex-row h-full gap-4 lg:gap-0",children:[e.jsx("div",{className:"lg:hidden border-b pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-lg font-semibold",children:z?.label||"Analysis"}),z?.description&&e.jsx("p",{className:"text-sm text-muted-foreground",children:z.description})]}),e.jsx(c,{variant:"outline",size:"icon",className:"shrink-0",onClick:()=>C(!0),children:e.jsx(za,{className:"h-5 w-5"})})]})}),e.jsx(gs,{open:I,onOpenChange:C,children:e.jsxs(fs,{className:"w-[90vw] max-w-sm h-[80vh] p-0",children:[e.jsx(js,{className:"p-4 border-b",children:e.jsx(ys,{children:"Analysis Sections"})}),e.jsx("div",{className:"overflow-y-auto",children:e.jsx(St,{activeTab:i,onTabChange:T,sections:x,onRunFramework:D,className:"border-none"})})]})}),e.jsx("div",{className:"hidden lg:block lg:w-64 xl:w-72 shrink-0",children:e.jsx(St,{activeTab:i,onTabChange:f,sections:x,onRunFramework:D})}),e.jsx("div",{className:"flex-1 min-w-0 lg:overflow-auto",children:P})]})},re=fa("ContentIntelligence");function gr(){const{toast:i}=Lt(),f=xa(),[x,D]=o.useState(""),[P,I]=o.useState("normal"),[C,z]=o.useState(!1),[T,H]=o.useState("idle"),[S,ne]=o.useState(0),[oe,W]=o.useState(""),[t,B]=o.useState(null),[O,G]=o.useState("overview"),[p,M]=o.useState({}),[le,ce]=o.useState(""),[se,ge]=o.useState(""),[fe,je]=o.useState([]),[me,te]=o.useState(!1),[de,ve]=o.useState(""),[ae,we]=o.useState([]),[h,J]=o.useState(!1),[ye,u]=o.useState(!1),[v,K]=o.useState(null),[Rs,bs]=o.useState(!1),[ze,Fs]=o.useState(""),[ke,Ns]=o.useState(!1),[vs,ws]=o.useState(!1),[Le,Is]=o.useState(null),[_e,as]=o.useState("all"),[l,m]=o.useState("references"),[y,L]=o.useState(null),[Y,k]=o.useState(!1),[g,Xs]=o.useState(null),[Je,Zs]=o.useState(!1),[w,et]=o.useState(null),[st,tt]=o.useState(!1),[er,Pt]=o.useState({}),[sr,Os]=o.useState(!1),[V,at]=o.useState(null),[Ke,Ps]=o.useState("idle"),[Mt,rt]=o.useState(null),[it,nt]=o.useState(!1),[xe,Ms]=o.useState("words"),[rs,Us]=o.useState("summary"),[Re,lt]=o.useState(!1),[U,Ut]=o.useState(null),[qs,ot]=o.useState(!1),[Ds,qt]=o.useState(null),[ks,Fe]=o.useState(!1),[_s,Hs]=o.useState(null),[tr,Dt]=o.useState(!1),[Ye,ct]=o.useState(null),[dt,Ht]=o.useState({}),[he,mt]=o.useState(null),[Vt,Cs]=o.useState(!1),[Ie,xt]=o.useState(null),Wt=t?[{id:"overview",label:"Overview",icon:Ne,description:"Summary, metadata, and key information",isAutomatic:!0,status:"complete"},{id:"entities",label:"Entities",icon:Be,description:"People, organizations, locations, and more",isAutomatic:!0,status:"complete"},{id:"sentiment",label:"Sentiment",icon:kt,description:"Emotional tone and sentiment analysis",isAutomatic:!0,status:t?.sentiment_analysis?"complete":"idle"},{id:"links",label:"Links",icon:us,description:"External and internal link analysis",isAutomatic:!0,status:"complete"},{id:"word-analysis",label:"Word Analysis",icon:It,description:"Word frequency and phrase analysis",isAutomatic:!0,status:"complete"},{id:"claims",label:"Claims Analysis",icon:$e,description:"6-method deception detection framework",isAutomatic:!1,status:qs?"processing":t?.claim_analysis||Ds?"complete":"idle"},{id:"dime",label:"DIME Framework",icon:Te,description:"Diplomatic, Information, Military, Economic",isAutomatic:!1,status:Re?"processing":t?.dime_analysis||U?"complete":"idle"},{id:"starbursting",label:"Starbursting",icon:He,description:"5W1H critical question generation",isAutomatic:!1,status:Ke},{id:"qa",label:"Q&A",icon:ps,description:"Ask questions about the content",isAutomatic:!1,status:"ready"}]:[],ht=s=>s?s.replace(/\s+/g," ").replace(/\. ([A-Z])/g,`.

$1`).replace(/\n{3,}/g,`

`).trim():"",Oe=s=>{t&&(ct(s),G("overview"),Us("fulltext"),setTimeout(()=>{const a=document.getElementById("full-text-content");a&&a.scrollIntoView({behavior:"smooth",block:"start"}),i({title:"Entity Highlighted",description:`All occurrences of "${s}" are now highlighted in yellow`})},100))},Qt=()=>{ct(null),i({title:"Highlighting Cleared",description:"Entity highlighting has been removed"})},Xe=async(s,a)=>{if(!t)return;const r=`${a}:${s}`;if(dt[r]){xt({entity:s,type:a,summary:dt[r]}),Cs(!0);return}mt(s);try{const n=await fetch("/api/content-intelligence/summarize-entity",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:t.extracted_text,entity_name:s,entity_type:a,content_title:t.title})});if(!n.ok)throw new Error("Failed to generate summary");const N=(await n.json()).summary;Ht(_=>({..._,[r]:N})),xt({entity:s,type:a,summary:N}),Cs(!0),i({title:"Summary Generated",description:`AI summary for "${s}" is ready`})}catch(n){console.error("Error summarizing entity:",n),i({title:"Error",description:"Failed to generate entity summary. Please try again.",variant:"destructive"})}finally{mt(null)}},Bt=(s,a)=>{if(!a||!Ye||Ye!==a)return s;const r=new RegExp(`(${a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return s.split(r).map((d,N)=>d.toLowerCase()===a.toLowerCase()?e.jsx("mark",{className:"bg-yellow-300 dark:bg-yellow-600 px-0.5 rounded",children:d},N):d)},Gt=()=>{if(!t)return;const s=window.open("","_blank");if(!s){i({title:"Error",description:"Please allow popups to export the report",variant:"destructive"});return}const a=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>${t.title||"Content Intelligence Report"}</title>
        <style>
          body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; line-height: 1.6; max-width: 900px; margin: 0 auto; padding: 40px 20px; color: #333; }
          h1 { color: #1a1a1a; border-bottom: 3px solid #3b82f6; padding-bottom: 10px; margin-bottom: 30px; }
          h2 { color: #2563eb; margin-top: 40px; margin-bottom: 20px; border-bottom: 2px solid #ddd; padding-bottom: 8px; }
          h3 { color: #4b5563; margin-top: 30px; margin-bottom: 15px; }
          .metadata { background: #f3f4f6; padding: 20px; border-radius: 8px; margin-bottom: 30px; }
          .metadata p { margin: 8px 0; }
          .metadata strong { color: #1f2937; }
          .citation { background: #eff6ff; border-left: 4px solid #3b82f6; padding: 15px; margin: 20px 0; font-family: 'Georgia', serif; }
          .summary { background: #f9fafb; padding: 20px; border-radius: 8px; margin: 20px 0; }
          .qa-item { background: #ffffff; border: 1px solid #e5e7eb; padding: 15px; margin: 10px 0; border-radius: 6px; }
          .qa-question { font-weight: 600; color: #1f2937; margin-bottom: 8px; }
          .qa-answer { color: #4b5563; margin-left: 20px; }
          .entity-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 10px; margin: 15px 0; }
          .entity-item { background: #f3f4f6; padding: 10px; border-radius: 4px; }
          .stat-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0; }
          .stat-card { background: #fefce8; padding: 15px; border-radius: 8px; border-left: 4px solid #eab308; }
          .stat-label { font-size: 0.875rem; color: #78350f; font-weight: 500; }
          .stat-value { font-size: 1.875rem; font-weight: bold; color: #713f12; margin-top: 5px; }
          .link-button { background: #3b82f6; color: white; padding: 10px 20px; border-radius: 6px; text-decoration: none; display: inline-block; margin: 20px 0; }
          .link-button:hover { background: #2563eb; }
          @media print { .no-print { display: none; } }
          @page { margin: 2cm; }
        </style>
      </head>
      <body>
        <h1>Content Intelligence Report</h1>

        <!-- Metadata -->
        <div class="metadata">
          <p><strong>Title:</strong> ${t.title||"Untitled"}</p>
          <p><strong>URL:</strong> <a href="${t.url}" target="_blank">${t.url}</a></p>
          ${t.author?`<p><strong>Author:</strong> ${t.author}</p>`:""}
          ${t.publish_date?`<p><strong>Published:</strong> ${t.publish_date}</p>`:""}
          <p><strong>Domain:</strong> ${t.domain}</p>
          <p><strong>Analysis Date:</strong> ${new Date().toLocaleString()}</p>
          <p><strong>Word Count:</strong> ${t.word_count.toLocaleString()}</p>
          ${t.is_social_media?`<p><strong>Platform:</strong> ${t.social_platform?.toUpperCase()}</p>`:""}
        </div>

        <!-- Citation -->
        ${ze?`
          <h2>Citation (APA)</h2>
          <div class="citation">${ze}</div>
        `:""}

        <!-- Summary -->
        ${t.summary?`
          <h2>Summary</h2>
          <div class="summary">${t.summary}</div>
        `:""}

        <!-- Quick Stats -->
        <h2>Analysis Overview</h2>
        <div class="stat-grid">
          <div class="stat-card">
            <div class="stat-label">Total Words</div>
            <div class="stat-value">${t.word_count.toLocaleString()}</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Unique Words</div>
            <div class="stat-value">${Object.keys(t.word_frequency||{}).length.toLocaleString()}</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">People Identified</div>
            <div class="stat-value">${t.entities?.people?.length||0}</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Organizations</div>
            <div class="stat-value">${t.entities?.organizations?.length||0}</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Locations</div>
            <div class="stat-value">${t.entities?.locations?.length||0}</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Top Phrases</div>
            <div class="stat-value">${t.top_phrases?.length||0}</div>
          </div>
        </div>

        <!-- Entities -->
        ${t.entities?`
          <h2>Extracted Entities</h2>

          ${t.entities.people&&t.entities.people.length>0?`
            <h3>People (${t.entities.people.length})</h3>
            <div class="entity-list">
              ${t.entities.people.slice(0,20).map(r=>`<div class="entity-item">${r.name} ${r.count>1?`(${r.count})`:""}</div>`).join("")}
            </div>
          `:""}

          ${t.entities.organizations&&t.entities.organizations.length>0?`
            <h3>Organizations (${t.entities.organizations.length})</h3>
            <div class="entity-list">
              ${t.entities.organizations.slice(0,20).map(r=>`<div class="entity-item">${r.name} ${r.count>1?`(${r.count})`:""}</div>`).join("")}
            </div>
          `:""}

          ${t.entities.locations&&t.entities.locations.length>0?`
            <h3>Locations (${t.entities.locations.length})</h3>
            <div class="entity-list">
              ${t.entities.locations.slice(0,20).map(r=>`<div class="entity-item">${r.name} ${r.count>1?`(${r.count})`:""}</div>`).join("")}
            </div>
          `:""}

          ${t.entities.emails&&t.entities.emails.length>0?`
            <h3>Emails (${t.entities.emails.length})</h3>
            <div class="entity-list">
              ${t.entities.emails.slice(0,20).map(r=>`<div class="entity-item"><a href="mailto:${r.email}">${r.email}</a> ${r.count>1?`(${r.count})`:""}</div>`).join("")}
            </div>
          `:""}
        `:""}

        <!-- Q&A History -->
        ${ae&&ae.length>0?`
          <h2>Questions & Answers</h2>
          ${ae.map((r,n)=>`
            <div class="qa-item">
              <div class="qa-question">Q${n+1}: ${r.question}</div>
              <div class="qa-answer">A: ${r.answer}</div>
            </div>
          `).join("")}
        `:""}

        <!-- DIME Framework Analysis -->
        ${t.dime_analysis||U?`
          <h2>DIME Framework Analysis</h2>
          <p style="color: #6b7280; font-style: italic; margin-bottom: 20px;">
            Diplomatic, Information, Military, Economic strategic analysis framework
          </p>

          ${t.dime_analysis?.diplomatic||U?.diplomatic?`
            <h3 style="color: #2563eb;"> Diplomatic</h3>
            ${(t.dime_analysis?.diplomatic||U?.diplomatic).map((r,n)=>`
              <div class="qa-item">
                <div class="qa-question">Q${n+1}: ${r.question}</div>
                <div class="qa-answer">A: ${r.answer}</div>
              </div>
            `).join("")}
          `:""}

          ${t.dime_analysis?.information||U?.information?`
            <h3 style="color: #10b981;"> Information</h3>
            ${(t.dime_analysis?.information||U?.information).map((r,n)=>`
              <div class="qa-item">
                <div class="qa-question">Q${n+1}: ${r.question}</div>
                <div class="qa-answer">A: ${r.answer}</div>
              </div>
            `).join("")}
          `:""}

          ${t.dime_analysis?.military||U?.military?`
            <h3 style="color: #ef4444;"> Military</h3>
            ${(t.dime_analysis?.military||U?.military).map((r,n)=>`
              <div class="qa-item">
                <div class="qa-question">Q${n+1}: ${r.question}</div>
                <div class="qa-answer">A: ${r.answer}</div>
              </div>
            `).join("")}
          `:""}

          ${t.dime_analysis?.economic||U?.economic?`
            <h3 style="color: #f59e0b;"> Economic</h3>
            ${(t.dime_analysis?.economic||U?.economic).map((r,n)=>`
              <div class="qa-item">
                <div class="qa-question">Q${n+1}: ${r.question}</div>
                <div class="qa-answer">A: ${r.answer}</div>
              </div>
            `).join("")}
          `:""}

          ${t.dime_analysis?.summary||U?.summary?`
            <div class="summary" style="margin-top: 20px;">
              <strong>DIME Summary:</strong> ${t.dime_analysis?.summary||U?.summary}
            </div>
          `:""}
        `:""}

        <!-- Top Phrases -->
        ${t.top_phrases&&t.top_phrases.length>0?`
          <h2>Top Phrases</h2>
          <div class="entity-list">
            ${t.top_phrases.slice(0,20).map(r=>`<div class="entity-item">${r.phrase} (${r.count})</div>`).join("")}
          </div>
        `:""}

        <!-- Starbursting Link -->
        ${V&&Ke==="complete"?`
          <h2>Starbursting Analysis</h2>
          <p>A comprehensive 5W1H (Who, What, When, Where, Why, How) analysis has been generated for this content.</p>
          <a href="/dashboard/analysis-frameworks/starbursting/${V.session_id}/view" class="link-button no-print">
            View Starbursting Analysis 
          </a>
          <p class="no-print" style="font-size: 0.875rem; color: #6b7280; margin-top: 10px;">
            Direct link: ${window.location.origin}/dashboard/analysis-frameworks/starbursting/${V.session_id}/view
          </p>
        `:""}

        <!-- Print Instructions -->
        <div class="no-print" style="margin-top: 40px; padding: 20px; background: #f3f4f6; border-radius: 8px;">
          <p><strong>To save this report:</strong></p>
          <ul>
            <li>Press Ctrl+P (Windows) or Cmd+P (Mac) to print</li>
            <li>Select "Save as PDF" as the destination</li>
            <li>Click Save</li>
          </ul>
          <button onclick="window.print()" style="background: #3b82f6; color: white; padding: 10px 20px; border: none; border-radius: 6px; cursor: pointer; margin-top: 10px;">
            Print / Save as PDF
          </button>
        </div>

        <div style="margin-top: 60px; padding-top: 20px; border-top: 2px solid #e5e7eb; font-size: 0.75rem; color: #9ca3af; text-align: center;">
          Generated by Content Intelligence Tool  ${new Date().toLocaleString()}
        </div>
      </body>
      </html>
    `;s.document.write(a),s.document.close(),i({title:"Report Generated",description:"Report opened in new window. You can print or save as PDF."})},Jt=async()=>{if(t?.id)try{Fe(!0);const s=await fetch("/api/content-intelligence/share",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({analysisId:t.id})});if(!s.ok)throw new Error("Failed to create share link");const a=await s.json();Hs(a.shareUrl),i({title:"Analysis Shared!",description:'Public link created successfully. Click "Copy Link" to share.'})}catch(s){console.error("Share error:",s),i({title:"Share Failed",description:s instanceof Error?s.message:"Failed to create share link",variant:"destructive"})}finally{Fe(!1)}},ut=s=>{const a=document.createElement("textarea");return a.innerHTML=s,a.value},pt=s=>s.replace(/\*\*(.+?)\*\*/g,"$1").replace(/\*(.+?)\*/g,"$1").replace(/__(.+?)__/g,"$1").replace(/_(.+?)_/g,"$1").replace(/~~(.+?)~~/g,"$1").replace(/`(.+?)`/g,"$1").replace(/^#+\s+/gm,"").replace(/^\s*[-*+]\s+/gm,"").replace(/^\s*\d+\.\s+/gm,"").replace(/\[(.+?)\]\(.+?\)/g,"$1").replace(/\n{3,}/g,`

`).trim(),Kt=async()=>{if(t){Fe(!0);try{const s=t.title||"Content Analysis",a=pt(ut(s)),r=t.summary||"No summary available",n=pt(ut(r)),d=n.length>280?n.substring(0,277)+"...":n,N=t.archive_urls||{};let _=` ${a}

${d}`;N.wayback&&(_+=`

 Archive:
 Wayback Machine: ${N.wayback}`);let b=_s||(t.share_token?`${window.location.origin}/public/content/${t.share_token}`:null);b&&(_=_.replace(d,`${d}

 View Full Analysis:
${b}`));let E=!1,R="";try{await navigator.clipboard.writeText(_),E=!0,R="Modern Clipboard API"}catch(A){re.warn("Modern clipboard failed, trying fallback:",A);try{const F=document.createElement("textarea");F.value=_,F.style.position="fixed",F.style.left="-999999px",F.style.top="-999999px",document.body.appendChild(F),F.focus(),F.select();const ue=document.execCommand("copy");document.body.removeChild(F),ue&&(E=!0,R="execCommand fallback")}catch(F){re.warn("Fallback clipboard also failed:",F)}}if(!E){const A=document.createElement("div");A.style.cssText="position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:white;dark:bg-gray-800;padding:20px;border-radius:8px;box-shadow:0 4px 6px rgba(0,0,0,0.1);z-index:9999;max-width:90%;max-height:80%;overflow:auto;";const F=document.createElement("h3");F.textContent="Copy this text manually:",F.style.cssText="margin:0 0 10px 0;font-size:16px;font-weight:600;";const ue=document.createElement("textarea");ue.value=_,ue.style.cssText="width:100%;min-height:200px;padding:10px;border:1px solid #ccc;border-radius:4px;font-family:monospace;font-size:12px;",ue.readOnly=!0;const Ze=document.createElement("div");Ze.style.cssText="margin-top:10px;display:flex;gap:10px;";const Pe=document.createElement("button");Pe.textContent="Select All",Pe.style.cssText="padding:8px 16px;background:#3b82f6;color:white;border:none;border-radius:4px;cursor:pointer;",Pe.onclick=()=>ue.select();const $s=document.createElement("button");$s.textContent="Close",$s.style.cssText="padding:8px 16px;background:#6b7280;color:white;border:none;border-radius:4px;cursor:pointer;",$s.onclick=()=>document.body.removeChild(A),Ze.appendChild(Pe),Ze.appendChild($s),A.appendChild(F),A.appendChild(ue),A.appendChild(Ze),document.body.appendChild(A),ue.select(),i({title:"Manual Copy Required",description:"Browser blocked auto-copy. Please copy from the dialog."}),Fe(!1);return}re.debug(`Copy successful using: ${R}`),i({title:"Summary Copied! ",description:b?"Summary with full analysis link copied to clipboard!":"Summary copied! Creating share link in background..."}),!b&&t.id&&E&&(re.info("Creating share link in background for next copy"),fetch("/api/content-intelligence/share",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({analysisId:t.id})}).then(A=>A.ok?A.json():null).then(A=>{A?.shareUrl&&(Hs(A.shareUrl),re.info("Share link created for future use:",A.shareUrl))}).catch(A=>re.warn("Background share link creation failed:",A)))}catch(s){console.error("Copy summary error:",s),i({title:"Copy Failed",description:s instanceof Error?s.message:"Failed to copy summary",variant:"destructive"})}finally{Fe(!1)}}},Ss=async(s,a)=>{const r=document.getElementById("word-cloud-container");if(!r||!t){i({title:"Error",description:"Word cloud not found",variant:"destructive"});return}try{re.info("Starting word cloud export...");const n=document.createElement("div");if(n.style.padding="40px",n.style.background="white",n.style.width="fit-content",n.style.maxWidth="1200px",a){const b=document.createElement("div");b.style.marginBottom="20px",b.style.color="#000",b.innerHTML=`
          <h2 style="font-size: 24px; font-weight: bold; margin-bottom: 8px;">${xe.charAt(0).toUpperCase()+xe.slice(1)} Word Cloud</h2>
          <p style="font-size: 14px; color: #666; margin-bottom: 4px;"><strong>Source:</strong> ${t.title||"Untitled"}</p>
          <p style="font-size: 14px; color: #666;"><strong>URL:</strong> ${t.url}</p>
        `,n.appendChild(b)}const d=r.cloneNode(!0);d.removeAttribute("id"),n.appendChild(d),n.style.position="absolute",n.style.left="-9999px",n.style.top="-9999px",document.body.appendChild(n);const N=b=>{const E=window.getComputedStyle(b),R=E.color,A=E.backgroundColor,F=E.fontSize,ue=E.fontWeight,Ze=E.opacity;b.className="",R&&!R.includes("oklch")?b.style.color=R:R&&(b.style.color="rgb(0, 0, 0)"),A&&!A.includes("oklch")&&A!=="rgba(0, 0, 0, 0)"&&(b.style.backgroundColor=A),b.style.fontSize=F,b.style.fontWeight=ue,b.style.opacity=Ze,Array.from(b.children).forEach(Pe=>{Pe instanceof HTMLElement&&N(Pe)})};N(d),d.style.background="linear-gradient(135deg, rgb(239, 246, 255) 0%, rgb(250, 245, 255) 100%)",d.style.borderRadius="8px",d.style.padding="32px",d.style.minHeight="300px",d.style.display="flex",d.style.flexWrap="wrap",d.style.alignItems="center",d.style.justifyContent="center",d.style.gap="16px",n.style.setProperty("background-color","#ffffff","important"),re.debug("Rendering canvas...");const _=await ha(n,{backgroundColor:"#ffffff",scale:2,logging:!1,useCORS:!0,allowTaint:!0});document.body.removeChild(n),re.debug("Canvas rendered, creating download..."),_.toBlob(b=>{if(!b){i({title:"Error",description:"Failed to create image blob",variant:"destructive"});return}const E=URL.createObjectURL(b),R=document.createElement("a"),A=xe.charAt(0).toUpperCase()+xe.slice(1);R.download=`wordcloud-${A}-${new Date().getTime()}.${s}`,R.href=E,R.click(),URL.revokeObjectURL(E),re.info("Download triggered successfully"),i({title:"Success",description:`Word cloud exported as ${s.toUpperCase()}`})},`image/${s}`,.95)}catch(n){re.error("Export failed:",n),i({title:"Error",description:`Failed to export: ${n instanceof Error?n.message:"Unknown error"}`,variant:"destructive"})}};o.useEffect(()=>{Yt();const s=localStorage.getItem("pending_url_analysis");s&&(D(s),localStorage.removeItem("pending_url_analysis"),setTimeout(()=>{const a=document.querySelector("[data-analyze-button]");a&&a.click()},800))},[]);const Yt=async()=>{te(!0);try{const s=await fetch("/api/content-intelligence/saved-links?limit=5");if(s.ok){const a=await s.json();je(a.links||[])}}catch(s){console.error("Failed to load saved links:",s)}finally{te(!1)}},is=async()=>{if(!t){i({title:"Error",description:"No analysis available",variant:"destructive"});return}lt(!0);try{const s=await fetch("/api/content-intelligence/dime-analyze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({analysis_id:t.id.toString(),content_text:t.extracted_text,title:t.title||"Untitled",url:t.url})});if(!s.ok)throw new Error("DIME analysis failed");const a=await s.json();Ut(a.dime_analysis),B({...t,dime_analysis:a.dime_analysis}),i({title:"DIME Analysis Complete",description:"Framework analysis has been generated successfully"})}catch(s){console.error("DIME analysis error:",s),i({title:"Error",description:"Failed to run DIME analysis",variant:"destructive"})}finally{lt(!1)}},gt=async()=>{if(!t){i({title:"Error",description:"No analysis available",variant:"destructive"});return}if(!t.id){i({title:"Error",description:"Analysis must be saved first",variant:"destructive"});return}ot(!0);try{const s=localStorage.getItem("omnicore_user_hash"),a=await fetch(`/api/claims/analyze/${t.id}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`}});if(!a.ok){const n=await a.json().catch(()=>({}));throw console.error("[Claims] API error:",n),new Error(n.details||n.error||"Claims analysis failed")}const r=await a.json();qt(r.claim_analysis),B({...t,claim_analysis:r.claim_analysis}),i({title:"Claims Analysis Complete",description:`${r.claim_analysis?.summary?.total_claims||0} claims analyzed successfully`})}catch(s){console.error("Claims analysis error:",s);const a=s instanceof Error?s.message:"Failed to run claims analysis";i({title:"Error",description:a,variant:"destructive"})}finally{ot(!1)}},Xt=async s=>{if(t)switch(s){case"claims":await gt(),G("claims");break;case"dime":await is(),G("dime");break;case"starbursting":t.id&&(await As(t.id),G("starbursting"));break;case"qa":G("qa");break;default:i({title:"Coming Soon",description:`${s} framework will be available soon.`})}},Zt=async()=>{if(!t){i({title:"Error",description:"No analysis to save",variant:"destructive"});return}const s=localStorage.getItem("omnicore_user_hash");if(!s){i({title:"Authentication Required",description:"Please ensure you have a user session",variant:"destructive"});return}Fe(!0);try{const a=await fetch("/api/content-intelligence/save",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`,"X-User-Hash":s},body:JSON.stringify({analysis_id:t.id.toString(),generate_share_link:!0,note:le||void 0,tags:se?se.split(",").map(n=>n.trim()):[]})});if(!a.ok)throw new Error("Failed to save analysis");const r=await a.json();Hs(r.share_url?`${window.location.origin}${r.share_url}`:null),Dt(!0),B({...t,is_saved:!0,share_token:r.share_token}),i({title:"Analysis Saved",description:"Your analysis has been saved permanently"})}catch(a){console.error("Save error:",a),i({title:"Error",description:"Failed to save analysis",variant:"destructive"})}finally{Fe(!1)}},Vs=async s=>{const a=s||x;if(!a){i({title:"Error",description:"Please enter a URL",variant:"destructive"});return}s&&D(s),B(null),we([]),z(!0),H("extracting"),ne(10);const r=/youtube\.com|youtu\.be|twitter\.com|x\.com|facebook\.com|instagram\.com|tiktok\.com|linkedin\.com|reddit\.com/i.test(a),n=r?a.match(/(youtube|twitter|x\.com|facebook|instagram|tiktok|linkedin|reddit)/i)?.[0]||"social media":null;W(r?`Extracting ${n} content (video/audio transcripts may take longer)...`:"Extracting content...");let d=null;try{const N=encodeURIComponent(a);M({"12ft":`https://12ft.io/proxy?q=${N}`,wayback:`https://web.archive.org/web/*/${a}`,archive_is:`https://archive.is/${a}`}),ne(30),H("analyzing_words"),W(r?`Analyzing ${n} content and engagement patterns...`:"Analyzing word frequency...");const _=[{progress:35,message:"Extracting entities..."},{progress:45,message:"Generating summary..."},{progress:55,message:"Analyzing topics..."},{progress:62,message:"Extracting key phrases..."},{progress:68,message:"Analyzing sentiment..."},{progress:75,message:"Detecting claims..."},{progress:85,message:"Analyzing claim credibility..."}];let b=0;d=setInterval(()=>{b<_.length&&(ne(_[b].progress),W(_[b].message),b++)},2e3);const E=await fetch("/api/content-intelligence/analyze-url",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:a,mode:P,save_link:!0,link_note:le||void 0,link_tags:se?se.split(",").map(A=>A.trim()):[]})});if(d&&clearInterval(d),!E.ok){if(E.status===524)throw new Error('Analysis timed out. The content may be too large or complex. Try using "quick" mode or a shorter article.');const A=E.headers.get("content-type");if(A&&A.includes("application/json")){const F=await E.json();console.error("[DEBUG] Backend error details:",{error:F.error,details:F.details,errorName:F.errorName,technical_error:F.technical_error,stack:F.stack});const ue=F.details||F.error||`Analysis failed with status ${E.status}`;throw new Error(`${ue}${F.errorName?` (${F.errorName})`:""}`)}else throw new Error(`Analysis failed with status ${E.status}. The server may be overloaded or the request timed out.`)}ne(70),H("extracting_entities"),W("Extracting entities...");const R=await E.json();ne(100),H("complete"),W("Complete!"),B(R),ft(R),R.entities&&jt(R.entities),P==="full"&&R.id?(i({title:"Analysis Complete!",description:"Starting DIME and Starbursting analysis (Full mode)..."}),R.extracted_text&&is().catch(A=>{console.error("[Full Mode] DIME analysis failed:",A)}),As(R.id).catch(A=>{console.error("[Full Mode] Starbursting failed:",A)})):i({title:"Success",description:"Analysis complete!"})}catch(N){d&&clearInterval(d),console.error("Analysis error:",N),H("error");let _="Unknown error",b="";if(N instanceof Error&&(N.message.includes("blocked access")?(_="Website Blocked Access",b="The website blocked automated access. Scroll down to see Bypass URLs that may help."):N.message.includes("timeout")||N.message.includes("took too long")?(_="Request Timeout",b="The website took too long to respond. Try a bypass URL or try again later."):N.message.includes("not found")?(_="Page Not Found",b="The URL may be incorrect or the page may have been removed."):(_="Analysis Failed",b=N.message)),i({title:_,description:b,variant:"destructive"}),!p||Object.keys(p).length===0){const E=encodeURIComponent(x);M({"12ft":`https://12ft.io/proxy?q=${E}`,wayback:`https://web.archive.org/web/*/${x}`,archive_is:`https://archive.is/${x}`})}}finally{z(!1)}};o.useEffect(()=>{t?.id&&ea()},[t?.id]);const ea=async()=>{if(t?.id)try{const s=await fetch(`/api/content-intelligence/answer-question?analysis_id=${t.id}`);if(s.ok){const a=await s.json();we(a.history||[])}}catch(s){console.error("Failed to load Q&A history:",s)}},ft=s=>{try{const a=Ct(s,x),{citation:r,inTextCitation:n}=va(a.fields,a.sourceType,"apa");Fs(r),Is({citationData:a,citation:r,inTextCitation:n}),ws(!1)}catch(a){console.error("Citation generation error:",a)}},sa=async s=>{try{z(!0),H("analyzing_words"),W("Creating ACH analysis...");let a=s.id;if(!a){W("Saving analysis first...");const d=await fetch("/api/content-intelligence/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({analysis_id:s.id?.toString()||"temp",generate_share_link:!1})});if(!d.ok)throw new Error("Failed to save analysis before creating ACH");const N=await d.json();a=N.analysis_id||N.id,B({...s,id:a,is_saved:!0})}if(!a)throw new Error("Could not obtain analysis ID");W("Generating ACH hypotheses...");const r=await fetch("/api/ach/from-content-intelligence",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({analysis_id:a})});if(!r.ok){const d=await r.json().catch(()=>({}));throw new Error(d.details||d.error||"Failed to create ACH")}const n=await r.json();i({title:"ACH Analysis Created",description:`Created with ${n.hypotheses_count} hypotheses and linked evidence`}),f(`/dashboard/analysis-frameworks/ach/${n.ach_id}`)}catch(a){console.error("ACH creation error:",a),i({title:"Failed to Create ACH",description:a instanceof Error?a.message:"Could not create ACH analysis from this content",variant:"destructive"})}finally{z(!1),H("complete"),W("")}},ta=()=>{if(Le)try{const s={id:wa(),citation:Le.citation,inTextCitation:Le.inTextCitation,citationStyle:"apa",sourceType:Le.citationData.sourceType,fields:Le.citationData.fields,addedAt:new Date().toISOString(),tags:["content-intelligence"]};ka(s),ws(!0),i({title:"Citation Saved!",description:"Added to your citation library. Open Citation Generator to view all saved citations."})}catch(s){console.error("Citation save error:",s),i({title:"Error",description:"Failed to save citation",variant:"destructive"})}},aa=async()=>{try{await navigator.clipboard.writeText(ze),Ns(!0),i({title:"Copied!",description:"Citation copied to clipboard"}),setTimeout(()=>Ns(!1),2e3)}catch{i({title:"Error",description:"Failed to copy citation",variant:"destructive"})}},Es=async(s,a)=>{try{const r=localStorage.getItem("omnicore_user_hash");if(!r){window.confirm(`You need to be logged in to save entities.

Would you like to login or create an account now?`)&&(localStorage.setItem("redirect_after_login",window.location.pathname+window.location.search),f("/login"));return}const n=a==="person"?"PERSON":a==="organization"?"ORGANIZATION":"OTHER",d=await fetch(`/api/actors/search?workspace_id=1&name=${encodeURIComponent(s)}&type=${n}`,{headers:{Authorization:`Bearer ${r}`}});if(!d.ok)console.warn(`Duplicate check failed for ${s}: ${d.status}`);else{const _=d.headers.get("content-type");if(!_||!_.includes("application/json"))console.warn(`Non-JSON response from duplicate check for ${s}`);else{const b=await d.json();if(b.exists)if(window.confirm(`"${s}" already exists in your entities.

Click OK to view the existing entity, or Cancel to update the name and save as a new entity.`)){f(`/dashboard/entities/actors/${b.actor.id}`);return}else{const R=window.prompt("Enter a different name for this entity:",s+" (2)");if(!R||R.trim()==="")return;s=R.trim()}}}const N=await fetch("/api/actors",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({name:s,type:n,workspace_id:"1",description:`Auto-extracted from: ${t?.title||x}`,tags:["content-intelligence",a],source_url:x})});if(N.ok)i({title:"Saved to Evidence",description:`${s} added to ${a==="person"?"Actors":a==="location"?"Places":"Evidence"}`}),t?.entities&&await jt(t.entities);else{const _=await N.json().catch(()=>({}));throw new Error(_.error||"Failed to save")}}catch(r){i({title:"Error",description:r instanceof Error?r.message:`Failed to save ${s}`,variant:"destructive"})}},ra=async()=>{if(!t?.entities)return;let s=0;const a=[...(t.entities.people||[]).map(r=>({name:r.name,type:"person"})),...(t.entities.organizations||[]).map(r=>({name:r.name,type:"organization"})),...(t.entities.locations||[]).map(r=>({name:r.name,type:"location"}))];for(const r of a)try{await Es(r.name,r.type),s++}catch(n){console.error(`Failed to save ${r.name}:`,n)}i({title:"Bulk Save Complete",description:`Saved ${s} of ${a.length} entities to evidence`})},ia=async()=>{if(!t?.id)return;z(!0);const s=localStorage.getItem("omnicore_user_hash");try{const a=await fetch("/api/content-intelligence/auto-extract-entities",{method:"POST",headers:{"Content-Type":"application/json",...s&&{Authorization:`Bearer ${s}`}},body:JSON.stringify({analysis_id:t.id,workspace_id:"1",user_id:1})});if(!a.ok)throw new Error("Failed to auto-extract entities");const r=await a.json();i({title:"Auto-Extraction Complete!",description:`Created ${r.summary.new_actors} actors, matched ${r.summary.matched_actors} existing, and created ${r.summary.new_relationships} relationships.`}),re.debug("Auto-extraction results:",r)}catch(a){re.error("Auto-extract error:",a),i({title:"Auto-Extraction Failed",description:a instanceof Error?a.message:"Unknown error",variant:"destructive"})}finally{z(!1)}},jt=async s=>{if(!s)return;Os(!0);const a=localStorage.getItem("omnicore_user_hash");if(!a){Os(!1);return}const r=[...(s.people||[]).map(d=>({name:d.name,type:"PERSON"})),...(s.organizations||[]).map(d=>({name:d.name,type:"ORGANIZATION"})),...(s.locations||[]).map(d=>({name:d.name,type:"LOCATION"}))],n={};for(const d of r)try{const N=await fetch(`/api/actors/search?workspace_id=1&name=${encodeURIComponent(d.name)}&type=${d.type}`,{headers:{Authorization:`Bearer ${a}`}});if(N.ok){const _=N.headers.get("content-type");if(_&&_.includes("application/json")){const b=await N.json();b.exists&&b.actor&&(n[d.name]={id:b.actor.id,name:b.actor.name})}else console.warn(`Non-JSON response for ${d.name}:`,await N.text())}else console.warn(`Failed to check duplicate for ${d.name}: ${N.status}`)}catch(N){console.error(`Failed to check duplicate for ${d.name}:`,N)}Pt(n),Os(!1)},As=async s=>{if(s){re.info("Starting Starbursting background analysis for content ID:",s),Ps("processing"),rt(null);try{const a=localStorage.getItem("omnicore_user_hash"),r=await fetch("/api/content-intelligence/starbursting",{method:"POST",headers:{"Content-Type":"application/json",...a&&{Authorization:`Bearer ${a}`}},body:JSON.stringify({analysis_ids:[s],use_ai_questions:!0})});if(!r.ok){const d=await r.json().catch(()=>({}));throw console.error("[Starbursting] API error:",d),new Error(d.details||d.error||"Failed to create Starbursting session")}const n=await r.json();if(console.log("[Starbursting] Full response:",n),console.log("[Starbursting] Response data:",{hasFrameworkData:!!n.framework_data,frameworkDataKeys:n.framework_data?Object.keys(n.framework_data):[],hasData:!!n.framework_data?.data,dataType:typeof n.framework_data?.data}),n.framework_data?.data&&console.log("[Starbursting] framework_data.data contents:",n.framework_data.data),n.framework_data?.data&&typeof n.framework_data.data=="string")try{n.framework_data.data=JSON.parse(n.framework_data.data),console.log("[Starbursting] Parsed framework data:",n.framework_data.data)}catch(d){console.error("[Starbursting] Failed to parse framework data:",d)}console.log("[Starbursting] Setting session state with data:",{hasFrameworkData:!!n.framework_data,hasFrameworkDataData:!!n.framework_data?.data,frameworkDataType:typeof n.framework_data,frameworkDataDataType:typeof n.framework_data?.data}),at(n),Ps("complete")}catch(a){console.error("[Starbursting] Background processing error:",a),rt(a instanceof Error?a.message:"Unknown error"),Ps("error")}}},na=async s=>{if(s){re.info("Generating more questions for Starbursting session:",s),nt(!0);try{const a=localStorage.getItem("omnicore_user_hash"),r=await fetch(`/api/content-intelligence/starbursting/${s}/generate-questions`,{method:"POST",headers:{"Content-Type":"application/json",...a&&{Authorization:`Bearer ${a}`}},body:JSON.stringify({existing_questions:V?.framework_data?.data||{}})});if(!r.ok){const d=await r.json().catch(()=>({}));throw new Error(d.details||d.error||"Failed to generate more questions")}const n=await r.json();if(n.framework_data?.data&&typeof n.framework_data.data=="string")try{n.framework_data.data=JSON.parse(n.framework_data.data)}catch(d){console.error("[Generate More Questions] Failed to parse framework data:",d)}at(n),i({title:"Questions Generated",description:"New questions have been added to your Starbursting analysis."})}catch(a){console.error("[Generate More Questions] Error:",a),i({title:"Failed to Generate Questions",description:a instanceof Error?a.message:"Unknown error",variant:"destructive"})}finally{nt(!1)}}},la=async s=>{if(s){k(!0);try{const r=await(await fetch("/api/content-intelligence/domain-country",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:s})})).json();r.success?L(r):L(null)}catch(a){console.error("Country lookup error:",a),L(null)}finally{k(!1)}}};o.useEffect(()=>{if(x&&x.startsWith("http")){const s=setTimeout(()=>{la(x)},500);return()=>clearTimeout(s)}else L(null)},[x]);const oa=async()=>{if(!x){i({title:"Error",description:"Please enter a URL first",variant:"destructive"});return}u(!0);try{const s=await fetch("/api/content-intelligence/virustotal-lookup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:x})}),a=await s.json();if(!s.ok&&!a.directLink)throw new Error(a.error||"VirusTotal lookup failed");a.stats||a.reputation!==void 0?(K(a),bs(!0)):(window.open(a.directLink,"_blank","noopener,noreferrer"),i({title:"Opening VirusTotal",description:a.message||"View domain security report on VirusTotal"}))}catch(s){console.error("VirusTotal lookup error:",s);try{const a=new URL(x).hostname;window.open(`https://www.virustotal.com/gui/domain/${a}`,"_blank","noopener,noreferrer"),i({title:"Opening VirusTotal",description:"API unavailable, opening direct link"})}catch{i({title:"Error",description:"Invalid URL or VirusTotal unavailable",variant:"destructive"})}}finally{u(!1)}},yt=async()=>{if(!de.trim()||!t?.id){i({title:"Error",description:"Please enter a question",variant:"destructive"});return}J(!0);try{const s=await fetch("/api/content-intelligence/answer-question",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({analysis_id:t.id,question:de.trim()})});if(!s.ok){const r=await s.json();throw new Error(r.error||"Failed to answer question")}const a=await s.json();we(r=>[a,...r]),ve(""),i({title:"Question answered",description:a.has_complete_answer?"Answer found with high confidence":"Partial answer found - some information may be missing"})}catch(s){console.error("Q&A error:",s),i({title:"Error",description:s instanceof Error?s.message:"Failed to answer question",variant:"destructive"})}finally{J(!1)}},ns=async s=>{if(!x){i({title:"Error",description:"Please enter a URL",variant:"destructive"});return}Zs(!0),Xs(null);try{i({title:`Extracting ${s==="full"?"complete data":s}...`,description:"This may take a moment"});const a=await fetch("/api/content-intelligence/social-media-extract",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:x,platform:t?.social_platform,mode:s})});if(!a.ok){const n=await a.json();throw new Error(n.error||"Social media extraction failed")}const r=await a.json();if(!r.success)throw new Error(r.error||"Extraction failed");Xs(r),i({title:"Extraction Complete!",description:`Successfully extracted ${r.platform} content`}),setTimeout(()=>{document.getElementById("social-media-results")?.scrollIntoView({behavior:"smooth"})},100)}catch(a){console.error("Social media extraction error:",a),i({title:"Extraction Failed",description:a instanceof Error?a.message:"Failed to extract social media content",variant:"destructive"})}finally{Zs(!1)}},ca=async()=>{if(!x){i({title:"Error",description:"Please enter a URL",variant:"destructive"});return}tt(!0),et(null);try{i({title:"Extracting repository information...",description:"Fetching metadata, README, commits, and releases"});const s=await fetch("/api/content-intelligence/git-repository-extract",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:x})});if(!s.ok){const r=await s.json();throw new Error(r.error||"Git repository extraction failed")}const a=await s.json();if(!a.success)throw new Error(a.error||"Repository extraction failed");et(a),i({title:"Repository Extraction Complete!",description:`Successfully extracted ${a.platform.toUpperCase()} repository information`}),setTimeout(()=>{document.getElementById("git-repo-results")?.scrollIntoView({behavior:"smooth"})},100)}catch(s){console.error("Git repository extraction error:",s),i({title:"Extraction Failed",description:s instanceof Error?s.message:"Failed to extract repository information",variant:"destructive"})}finally{tt(!1)}},da=async(s,a)=>{try{i({title:"Starting download...",description:"Please wait"});const r=document.createElement("a");if(r.href=s,r.download=a||`download_${Date.now()}`,r.target="_blank",r.rel="noopener noreferrer",s.startsWith("http")&&!s.includes(window.location.host))try{const n=await fetch(s,{mode:"cors"});if(n.ok){const d=await n.blob(),N=URL.createObjectURL(d);r.href=N,document.body.appendChild(r),r.click(),document.body.removeChild(r),setTimeout(()=>URL.revokeObjectURL(N),100),i({title:"Download started!",description:"Check your downloads folder"});return}}catch(n){console.warn("CORS fetch failed, falling back to direct link:",n)}document.body.appendChild(r),r.click(),document.body.removeChild(r),i({title:"Download initiated",description:"If download doesn't start, check popup blocker settings"})}catch(r){console.error("Download error:",r),i({title:"Download failed",description:r instanceof Error?r.message:"Could not download file",variant:"destructive"})}},ma=s=>({youtube:"Video downloads (multiple qualities), transcripts, engagement metrics, thumbnails",instagram:"Post media (images/videos), captions, likes/comments, carousel support",tiktok:"Video downloads, metadata extraction, engagement metrics",twitter:"Tweet text, media URLs, embed codes, author information",facebook:"Post data, media links, engagement metrics",reddit:"Post content, comments, upvotes, media links"})[s.toLowerCase()]||"Basic metadata extraction";return e.jsxs("div",{className:"container mx-auto py-8 space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-2",children:[e.jsx(Ne,{className:"h-8 w-8"}),"Content Research & Link Analysis"]}),e.jsx("p",{className:"text-muted-foreground",children:"Analyze URLs, extract insights, preserve evidence, and ask questions"})]}),e.jsx(j,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex gap-2",children:e.jsx(We,{placeholder:"Enter URL to analyze...",value:x,onChange:s=>D(s.target.value),onKeyDown:s=>s.key==="Enter"&&Vs(),className:"flex-1"})}),e.jsxs("div",{className:"flex gap-2 items-center justify-between",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{variant:P==="quick"?"default":"outline",onClick:()=>I("quick"),size:"sm",children:"Quick"}),e.jsx(c,{variant:P==="normal"?"default":"outline",onClick:()=>I("normal"),size:"sm",children:"Normal"}),e.jsx(c,{variant:P==="full"?"default":"outline",onClick:()=>I("full"),size:"sm",children:"Full"})]}),e.jsx(c,{onClick:()=>Vs(),disabled:C,"data-analyze-button":!0,children:C?e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"h-4 w-4 mr-2 animate-spin"}),"Analyzing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"Analyze Content"]})})]})]})}),C&&e.jsx(j,{className:"p-6 bg-gradient-to-r from-blue-50 via-indigo-50 to-purple-50 dark:from-blue-950/40 dark:via-indigo-950/40 dark:to-purple-950/40 border-2 border-blue-400 dark:border-blue-600",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(q,{className:"h-6 w-6 animate-spin text-blue-600 dark:text-blue-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg text-blue-900 dark:text-blue-100",children:oe}),e.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300 mt-1",children:"This may take 10-30 seconds depending on content size"})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-2xl font-bold text-blue-900 dark:text-blue-100",children:[S,"%"]})})]}),e.jsx(ee,{value:S,className:"h-2"})]})}),!C&&y&&e.jsx(j,{className:"p-4 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-950/20 dark:to-indigo-950/20 border-blue-300",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-3xl",children:y.flag}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"font-semibold text-blue-900 dark:text-blue-100",children:["Hosted in ",y.country]}),e.jsxs("div",{className:"text-sm text-blue-700 dark:text-blue-300 space-y-0.5",children:[e.jsxs("p",{children:["Domain: ",y.domain]}),y.ip&&e.jsxs("p",{children:["IP: ",y.ip]}),y.city&&y.region&&e.jsxs("p",{children:["Location: ",y.city,", ",y.region]}),y.org&&e.jsxs("p",{children:["Organization: ",y.org]})]})]})]})}),!C&&Y&&e.jsx(j,{className:"p-4 bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(q,{className:"h-4 w-4 animate-spin"}),"Looking up domain country..."]})}),x&&t?.is_social_media&&t.social_platform&&e.jsx(j,{className:"p-6 bg-gradient-to-br from-purple-50 via-pink-50 to-orange-50 dark:from-purple-950/30 dark:via-pink-950/30 dark:to-orange-950/30 border-2 border-purple-300",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-purple-600 rounded-full shrink-0",children:e.jsx(Js,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"text-xl font-bold text-purple-900 dark:text-purple-100 mb-1",children:[t.social_platform.toUpperCase()," Content Detected"]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mb-4",children:"Use specialized extraction tools for videos, images, transcripts, and more."}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[e.jsxs(c,{onClick:()=>ns("metadata"),disabled:Je,size:"sm",variant:"default",className:"bg-purple-600 hover:bg-purple-700",children:[Je?e.jsx(q,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(Ge,{className:"h-4 w-4 mr-2"}),"Quick Info"]}),e.jsxs(c,{onClick:()=>ns("download"),disabled:Je,size:"sm",variant:"outline",children:[e.jsx(Ys,{className:"h-4 w-4 mr-2"}),"Download Media"]}),e.jsxs(c,{onClick:()=>ns("stream"),disabled:Je,size:"sm",variant:"outline",children:[e.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Stream/Embed"]}),t.social_platform==="youtube"&&e.jsxs(c,{onClick:()=>ns("transcript"),disabled:Je,size:"sm",variant:"outline",children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"Get Transcript"]}),e.jsxs(c,{onClick:()=>ns("full"),disabled:Je,size:"sm",variant:"outline",children:[e.jsx(Js,{className:"h-4 w-4 mr-2"}),"Full Extract"]})]}),e.jsx("div",{className:"p-3 bg-white/50 dark:bg-gray-800/50 rounded-lg",children:e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:[e.jsx("strong",{children:"Available:"})," ",ma(t.social_platform)]})})]})]})}),x&&/github\.com|gitlab\.com|bitbucket\.org/i.test(x)&&e.jsx(j,{className:"p-6 bg-gradient-to-br from-blue-50 via-indigo-50 to-cyan-50 dark:from-blue-950/30 dark:via-indigo-950/30 dark:to-cyan-950/30 border-2 border-blue-300",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-blue-600 rounded-full shrink-0",children:e.jsx(ds,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"text-xl font-bold text-blue-900 dark:text-blue-100 mb-1",children:[x.match(/github\.com/i)?"GitHub":x.match(/gitlab\.com/i)?"GitLab":"Bitbucket"," Repository Detected"]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mb-4",children:"Extract repository metadata, README, commit history, releases, and language statistics."}),e.jsxs(c,{onClick:ca,disabled:st,size:"sm",variant:"default",className:"bg-blue-600 hover:bg-blue-700",children:[st?e.jsx(q,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(ds,{className:"h-4 w-4 mr-2"}),"Extract Repository Info"]}),e.jsx("div",{className:"p-3 bg-white/50 dark:bg-gray-800/50 rounded-lg mt-4",children:e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:[e.jsx("strong",{children:"Extracting:"})," Stars, forks, languages, README, latest commits, releases, contributors"]})})]})]})}),g&&e.jsxs(j,{id:"social-media-results",className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-bold mb-4 flex items-center gap-2",children:[e.jsx(Js,{className:"h-5 w-5 text-purple-600"}),g.platform.toUpperCase()," Extraction Results"]}),g.mediaUrls?.video&&e.jsx("div",{className:"mb-4",children:e.jsxs("video",{controls:!0,className:"w-full max-h-96 rounded-lg bg-black",children:[e.jsx("source",{src:g.mediaUrls.video}),"Your browser does not support the video tag."]})}),g.mediaUrls?.images&&g.mediaUrls.images.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("h4",{className:"font-semibold mb-2",children:["Media (",g.mediaUrls.images.length," ",g.mediaUrls.images.length===1?"image":"images",")"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:g.mediaUrls.images.map((s,a)=>{const r=g.platform==="twitter"?`/api/content-intelligence/twitter-image-proxy?url=${encodeURIComponent(s)}`:s;return e.jsxs("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"group relative block overflow-hidden rounded-lg border border-gray-200 dark:border-gray-700 hover:border-blue-500 dark:hover:border-blue-400 transition-colors",children:[e.jsx("img",{src:r,alt:`Media ${a+1}`,className:"w-full h-48 object-cover transition-transform group-hover:scale-105",loading:"lazy"}),e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors flex items-center justify-center",children:e.jsx(Ce,{className:"h-6 w-6 text-white opacity-0 group-hover:opacity-100 transition-opacity"})})]},a)})})]}),g.downloadOptions&&g.downloadOptions.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Download Options"}),e.jsx("div",{className:"grid md:grid-cols-2 gap-2",children:g.downloadOptions.map((s,a)=>e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>da(s.url,`${g.platform}_${s.quality}.${s.format}`),className:"justify-start",children:[e.jsx(Ys,{className:"h-4 w-4 mr-2"}),s.quality," (",s.format,")",s.size&&` - ${(s.size/1024/1024).toFixed(1)}MB`]},a))})]}),g.streamUrl&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Stream URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(We,{value:g.streamUrl,readOnly:!0}),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>window.open(g.streamUrl,"_blank"),children:e.jsx(Ce,{className:"h-4 w-4"})})]})]}),g.embedCode&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Embed Code"}),e.jsx(pe,{value:g.embedCode,readOnly:!0,rows:3,className:"font-mono text-xs"})]}),g.metadata&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Metadata"}),g.platform==="twitter"&&g.metadata.text&&e.jsxs("div",{className:"mb-4 p-4 bg-blue-50 dark:bg-blue-950 rounded-lg border border-blue-200 dark:border-blue-800",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h5",{className:"font-semibold text-blue-900 dark:text-blue-100",children:"Tweet Text"}),e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>{navigator.clipboard.writeText(g.metadata.text),i({title:"Copied!",description:"Tweet text copied to clipboard"})},children:e.jsx(Se,{className:"h-3 w-3"})})]}),e.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-wrap text-gray-800 dark:text-gray-200",children:g.metadata.text})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4 text-sm",children:[g.metadata.authorName&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Author"}),e.jsx("p",{className:"font-semibold",children:g.metadata.authorName}),g.metadata.authorHandle&&e.jsx("p",{className:"text-xs text-blue-600",children:g.metadata.authorHandle})]}),g.metadata.tweetId&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Tweet ID"}),e.jsx("p",{className:"font-mono text-xs",children:g.metadata.tweetId})]}),g.metadata.hasMedia!==void 0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Has Media"}),e.jsx("p",{className:"font-semibold",children:g.metadata.hasMedia?`Yes (${g.metadata.mediaCount||1} item${g.metadata.mediaCount>1?"s":""})`:"No"})]}),g.metadata.title&&!g.metadata.tweetId&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Title"}),e.jsx("p",{className:"font-semibold",children:g.metadata.title})]}),g.metadata.author&&!g.metadata.authorName&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Author"}),e.jsx("p",{className:"font-semibold",children:g.metadata.author})]}),g.metadata.viewCount!==void 0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Views"}),e.jsx("p",{className:"font-semibold",children:g.metadata.viewCount.toLocaleString()})]}),g.metadata.likeCount!==void 0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Likes"}),e.jsx("p",{className:"font-semibold",children:g.metadata.likeCount.toLocaleString()})]}),g.metadata.replyCount!==void 0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Replies"}),e.jsx("p",{className:"font-semibold",children:g.metadata.replyCount.toLocaleString()})]}),g.metadata.repostCount!==void 0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Reposts"}),e.jsx("p",{className:"font-semibold",children:g.metadata.repostCount.toLocaleString()})]}),g.metadata.commentCount!==void 0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Comments"}),e.jsx("p",{className:"font-semibold",children:g.metadata.commentCount.toLocaleString()})]}),g.metadata.extractedVia&&e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:"Extracted via"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:g.metadata.extractedVia})]})]})]}),g.transcript&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-semibold",children:"Transcript"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs($,{variant:"secondary",className:"text-xs",children:[g.transcript.split(" ").length," words"]}),e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>{navigator.clipboard.writeText(g.transcript||""),i({title:"Copied!",description:"Transcript copied to clipboard"})},children:e.jsx(Se,{className:"h-3 w-3"})})]})]}),e.jsx("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg max-h-96 overflow-y-auto border",children:e.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:g.transcript})})]}),t?.extracted_text&&e.jsx("div",{className:"mt-4",children:e.jsxs("details",{className:"group",children:[e.jsxs("summary",{className:"cursor-pointer font-semibold p-3 bg-blue-50 dark:bg-blue-950 rounded-lg hover:bg-blue-100 dark:hover:bg-blue-900 flex items-center justify-between",children:[e.jsx("span",{children:" View Full Analyzed Content"}),e.jsxs($,{variant:"outline",className:"text-xs",children:[t.word_count.toLocaleString()," words"]})]}),e.jsxs("div",{className:"mt-2 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg max-h-96 overflow-y-auto border",children:[e.jsx("div",{className:"flex justify-end mb-2",children:e.jsxs(c,{variant:"ghost",size:"sm",onClick:()=>{navigator.clipboard.writeText(t.extracted_text),i({title:"Copied!",description:"Full content copied to clipboard"})},children:[e.jsx(Se,{className:"h-3 w-3 mr-1"}),"Copy"]})}),e.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:t.extracted_text})]})]})})]}),w&&w.repository&&e.jsxs(j,{id:"git-repo-results",className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-bold mb-4 flex items-center gap-2",children:[e.jsx(ds,{className:"h-5 w-5 text-blue-600"}),w.platform.toUpperCase()," Repository Information"]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"font-semibold text-base mb-3 flex items-center gap-2",children:[e.jsx(La,{className:"h-4 w-4"}),w.repository.fullName]}),w.repository.description&&e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mb-4 italic",children:w.repository.description}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm mb-4",children:[w.repository.stars!==void 0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(He,{className:"h-4 w-4 text-yellow-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:"Stars"}),e.jsx("p",{className:"font-semibold",children:w.repository.stars.toLocaleString()})]})]}),w.repository.forks!==void 0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ds,{className:"h-4 w-4 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:"Forks"}),e.jsx("p",{className:"font-semibold",children:w.repository.forks.toLocaleString()})]})]}),w.repository.watchers!==void 0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Be,{className:"h-4 w-4 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:"Watchers"}),e.jsx("p",{className:"font-semibold",children:w.repository.watchers.toLocaleString()})]})]}),w.repository.openIssues!==void 0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ms,{className:"h-4 w-4 text-orange-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:"Open Issues"}),e.jsx("p",{className:"font-semibold",children:w.repository.openIssues.toLocaleString()})]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4 text-sm",children:[w.repository.language&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:"Primary Language"}),e.jsx("p",{className:"font-semibold",children:w.repository.language})]}),w.repository.license&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:"License"}),e.jsx("p",{className:"font-semibold",children:w.repository.license})]}),w.contributors!==void 0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:"Contributors"}),e.jsx("p",{className:"font-semibold",children:w.contributors.toLocaleString()})]})]})]}),w.repository.languages&&Object.keys(w.repository.languages).length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"font-semibold mb-2 text-sm",children:"Languages Used"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(w.repository.languages).sort(([,s],[,a])=>a-s).slice(0,10).map(([s,a])=>e.jsx($,{variant:"secondary",className:"text-xs",children:s},s))})]}),w.latestCommit&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"font-semibold mb-2 text-sm flex items-center gap-2",children:[e.jsx(ds,{className:"h-4 w-4"}),"Latest Commit"]}),e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:w.latestCommit.message}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["by ",w.latestCommit.author,"  ",new Date(w.latestCommit.date).toLocaleDateString()]})]}),e.jsx($,{variant:"outline",className:"font-mono text-xs ml-2",children:w.latestCommit.sha})]}),e.jsxs("a",{href:w.latestCommit.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:underline flex items-center gap-1",children:["View commit ",e.jsx(Ce,{className:"h-3 w-3"})]})]})]}),w.latestRelease&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"font-semibold mb-2 text-sm flex items-center gap-2",children:[e.jsx(Ra,{className:"h-4 w-4"}),"Latest Release"]}),e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border",children:[e.jsx("div",{className:"flex items-start justify-between mb-2",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:w.latestRelease.name}),e.jsx($,{variant:"secondary",className:"text-xs mt-1",children:w.latestRelease.tag}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Released ",new Date(w.latestRelease.publishedAt).toLocaleDateString()]})]})}),w.latestRelease.description&&e.jsxs("p",{className:"text-xs text-gray-700 dark:text-gray-300 mt-2 mb-2",children:[w.latestRelease.description.substring(0,200),w.latestRelease.description.length>200?"...":""]}),e.jsxs("a",{href:w.latestRelease.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:underline flex items-center gap-1",children:["View release ",e.jsx(Ce,{className:"h-3 w-3"})]})]})]}),w.recentCommits&&w.recentCommits.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"font-semibold mb-2 text-sm",children:"Recent Commits"}),e.jsx("div",{className:"space-y-2",children:w.recentCommits.map((s,a)=>e.jsxs("div",{className:"p-2 bg-gray-50 dark:bg-gray-800 rounded border text-xs",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("p",{className:"font-medium flex-1",children:s.message}),e.jsx($,{variant:"outline",className:"font-mono text-xs ml-2",children:s.sha})]}),e.jsxs("p",{className:"text-muted-foreground text-xs mt-1",children:[s.author,"  ",new Date(s.date).toLocaleDateString()]})]},a))})]}),w.readme&&e.jsx("div",{className:"mt-4",children:e.jsxs("details",{className:"group",children:[e.jsxs("summary",{className:"cursor-pointer font-semibold p-3 bg-blue-50 dark:bg-blue-950 rounded-lg hover:bg-blue-100 dark:hover:bg-blue-900 flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"h-4 w-4"}),"README Preview"]}),e.jsx($,{variant:"outline",className:"text-xs",children:w.readme.truncated?`${w.readme.content.length} chars (truncated)`:"Full"})]}),e.jsxs("div",{className:"mt-2 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg max-h-96 overflow-y-auto border",children:[e.jsx("div",{className:"flex justify-end mb-2",children:e.jsxs(c,{variant:"ghost",size:"sm",onClick:()=>{navigator.clipboard.writeText(w.readme.content),i({title:"Copied!",description:"README content copied to clipboard"})},children:[e.jsx(Se,{className:"h-3 w-3 mr-1"}),"Copy"]})}),e.jsx("pre",{className:"text-xs leading-relaxed whitespace-pre-wrap font-mono",children:w.readme.content})]})]})})]}),x&&p["12ft"]&&e.jsxs(j,{className:"p-4",children:[e.jsx("h3",{className:"text-sm font-semibold mb-3",children:"Quick Actions (Click while processing)"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:oa,disabled:ye,className:"bg-blue-50 dark:bg-blue-950 border-blue-300 hover:bg-blue-100",children:[ye?e.jsx(q,{className:"h-3 w-3 mr-1 animate-spin"}):e.jsx($e,{className:"h-3 w-3 mr-1"}),"VirusTotal Security"]}),e.jsx(c,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs("a",{href:p["12ft"],target:"_blank",rel:"noopener noreferrer",children:[e.jsx(Ce,{className:"h-3 w-3 mr-1"}),"12ft.io Bypass"]})}),e.jsx(c,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs("a",{href:p.archive_is,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(Fa,{className:"h-3 w-3 mr-1"}),"Archive.is"]})}),e.jsx(c,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs("a",{href:p.wayback,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(Ls,{className:"h-3 w-3 mr-1"}),"Wayback Machine"]})})]})]}),t&&e.jsxs(Za,{activeTab:O,onTabChange:G,sections:Wt,onRunFramework:Xt,children:[O==="overview"&&e.jsxs(j,{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold break-words",children:t.title||"Untitled"}),t.author&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["By ",t.author]}),t.publish_date&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Published: ",t.publish_date]})]}),!t.is_saved&&e.jsxs("div",{className:"space-y-3 pb-2",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Add metadata before saving (optional)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(We,{placeholder:"Add note (optional)...",value:le,onChange:s=>ce(s.target.value),className:"flex-1"}),e.jsx(We,{placeholder:"Tags (comma-separated)...",value:se,onChange:s=>ge(s.target.value),className:"flex-1"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 pt-2 border-t",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>sa(t),disabled:C,children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),"Create ACH"]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:is,disabled:Re||!t.extracted_text,children:[Re?e.jsx(q,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(Te,{className:"h-4 w-4 mr-2"}),"DIME Analysis"]}),e.jsx(ja,{children:e.jsxs(ya,{children:[e.jsx(ba,{asChild:!0,children:e.jsxs(c,{variant:t.is_saved?"outline":"default",size:"sm",onClick:Zt,disabled:ks||t.is_saved,className:t.is_saved?"":"bg-green-600 hover:bg-green-700 text-white",children:[ks?e.jsx(q,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(Ve,{className:"h-4 w-4 mr-2"}),t.is_saved?"Saved":"Save Permanently"]})}),e.jsx(Na,{side:"bottom",className:"max-w-xs",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-semibold",children:"Save this analysis to:"}),e.jsxs("ul",{className:"text-sm space-y-0.5 ml-4 list-disc",children:[e.jsx("li",{children:"Keep it forever (no auto-deletion)"}),e.jsx("li",{children:"Access it anytime from your dashboard"}),e.jsx("li",{children:"Share with others via link"}),e.jsx("li",{children:"Build upon it in future investigations"})]}),!t.is_saved&&t.expires_at&&e.jsxs("p",{className:"text-xs text-amber-600 dark:text-amber-400 mt-2",children:[" Will be deleted in ",Math.ceil((new Date(t.expires_at).getTime()-Date.now())/(1e3*60*60*24))," days if not saved!"]})]})})]})}),e.jsxs(c,{variant:"default",size:"sm",onClick:Gt,children:[e.jsx(Ia,{className:"h-4 w-4 mr-2"}),"Export Report"]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:Kt,disabled:ks,className:"bg-gradient-to-r from-blue-50 to-indigo-50 hover:from-blue-100 hover:to-indigo-100 dark:from-blue-950 dark:to-indigo-950 border-blue-200 dark:border-blue-800",children:[e.jsx(Se,{className:"h-4 w-4 mr-2"}),"Copy Summary"]}),!_s&&e.jsxs(c,{variant:"outline",size:"sm",onClick:Jt,disabled:ks,children:[e.jsx(Ft,{className:"h-4 w-4 mr-2"}),"Share Analysis"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[t.expires_at&&!t.is_saved&&e.jsxs(xs,{className:"bg-amber-50 border-amber-200 dark:bg-amber-950 dark:border-amber-800",children:[e.jsx(ms,{className:"h-4 w-4 text-amber-600"}),e.jsx(hs,{className:"text-amber-800 dark:text-amber-200",children:e.jsx("div",{className:"flex items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("strong",{children:"Temporary Analysis:"})," This will be automatically deleted in"," ",e.jsxs("strong",{children:[Math.ceil((new Date(t.expires_at).getTime()-Date.now())/(1e3*60*60*24))," days"]}),'. Click "Save Permanently" to keep it forever.']})})})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[t.is_saved&&e.jsxs($,{variant:"secondary",className:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:[e.jsx(ss,{className:"h-3 w-3 mr-1"}),"Saved Permanently - Never Expires"]}),_s&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs($,{variant:"outline",className:"bg-blue-50 text-blue-700",children:[e.jsx(us,{className:"h-3 w-3 mr-1"}),"Shareable"]}),e.jsxs(c,{variant:"ghost",size:"sm",onClick:()=>{navigator.clipboard.writeText(_s),i({title:"Link Copied",description:"Share URL copied to clipboard"})},children:[e.jsx(Se,{className:"h-4 w-4 mr-1"}),"Copy Link"]})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold",children:"Content"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{size:"sm",variant:rs==="summary"?"default":"outline",onClick:()=>Us("summary"),children:"Summary"}),e.jsx(c,{size:"sm",variant:rs==="fulltext"?"default":"outline",onClick:()=>Us("fulltext"),children:"Full Text"})]})]}),rs==="summary"&&t.summary&&e.jsx("div",{className:"text-sm leading-relaxed",children:t.summary}),rs==="fulltext"&&t.extracted_text&&e.jsxs("div",{children:[Ye&&e.jsxs("div",{className:"mb-3 flex items-center gap-2 p-2 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg",children:[e.jsxs("div",{className:"flex-1 text-sm",children:["Highlighting: ",e.jsx("span",{className:"font-medium",children:Ye})]}),e.jsxs(c,{size:"sm",variant:"ghost",onClick:Qt,className:"h-7",children:[e.jsx(ts,{className:"h-4 w-4 mr-1"}),"Clear"]})]}),e.jsxs("div",{id:"full-text-content",className:"max-h-[600px] overflow-y-auto",children:[e.jsx("div",{className:"text-sm leading-relaxed whitespace-pre-line bg-gray-50 dark:bg-gray-900 rounded-lg p-4",children:Ye?Bt(ht(t.extracted_text),Ye):ht(t.extracted_text)}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:[t.extracted_text.length.toLocaleString()," characters  ",t.word_count.toLocaleString()," words"]})]})]}),rs==="fulltext"&&!t.extracted_text&&e.jsx("div",{className:"text-sm text-muted-foreground italic",children:"No full text available for this analysis."})]}),e.jsxs("div",{id:"citation-section",className:"border-t pt-4",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Citation"}),ze?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:e.jsx("p",{className:"text-sm font-serif",children:ze})}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[e.jsx(c,{variant:"outline",size:"sm",onClick:aa,children:ke?e.jsxs(e.Fragment,{children:[e.jsx(ss,{className:"h-4 w-4 mr-2"}),"Copied!"]}):e.jsxs(e.Fragment,{children:[e.jsx(Se,{className:"h-4 w-4 mr-2"}),"Copy Citation"]})}),e.jsx(c,{variant:"outline",size:"sm",onClick:ta,disabled:vs,children:vs?e.jsxs(e.Fragment,{children:[e.jsx(ss,{className:"h-4 w-4 mr-2"}),"Saved!"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ve,{className:"h-4 w-4 mr-2"}),"Save to Library"]})}),e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>{const s=Ct(t,x),a=Ga(s);f(`/dashboard/tools/citations-generator?${a.toString()}`)},children:[e.jsx(_t,{className:"h-4 w-4 mr-2"}),"Open in Citation Library"]})]})]}):e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Citation will be generated automatically after analysis completes"})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Quick Stats"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Word Count"}),e.jsx("p",{className:"font-semibold",children:t.word_count.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"People"}),e.jsx("p",{className:"font-semibold",children:t.entities?.people?.length||0})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Organizations"}),e.jsx("p",{className:"font-semibold",children:t.entities?.organizations?.length||0})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Locations"}),e.jsx("p",{className:"font-semibold",children:t.entities?.locations?.length||0})]})]})]})]}),O==="word-analysis"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs(j,{className:"p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Total Words"}),e.jsx("p",{className:"text-2xl font-bold",children:t.word_count.toLocaleString()})]}),e.jsxs(j,{className:"p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Unique Words"}),e.jsx("p",{className:"text-2xl font-bold",children:Object.keys(t.word_frequency||{}).length.toLocaleString()})]}),e.jsxs(j,{className:"p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Top Phrases"}),e.jsx("p",{className:"text-2xl font-bold",children:t.top_phrases?.length||0})]}),e.jsxs(j,{className:"p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Avg. Word Length"}),e.jsx("p",{className:"text-2xl font-bold",children:t.word_frequency?Math.round(Object.keys(t.word_frequency).reduce((s,a)=>s+a.length,0)/Object.keys(t.word_frequency).length):0})]})]}),e.jsxs(j,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 flex-wrap gap-2",children:[e.jsx("h3",{className:"font-semibold",children:"Word Cloud"}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{size:"sm",variant:xe==="words"?"default":"outline",onClick:()=>Ms("words"),children:"Words"}),e.jsx(c,{size:"sm",variant:xe==="phrases"?"default":"outline",onClick:()=>Ms("phrases"),children:"Phrases"}),e.jsx(c,{size:"sm",variant:xe==="entities"?"default":"outline",onClick:()=>Ms("entities"),children:"Entities"})]}),e.jsxs(Me,{children:[e.jsx(Ue,{asChild:!0,children:e.jsxs(c,{size:"sm",variant:"outline",children:[e.jsx(Oa,{className:"h-4 w-4 mr-2"}),"Export"]})}),e.jsxs(qe,{align:"end",children:[e.jsx(ga,{children:"Export Word Cloud"}),e.jsx(ls,{}),e.jsx(Q,{onClick:()=>Ss("png",!1),children:"PNG (Image only)"}),e.jsx(Q,{onClick:()=>Ss("png",!0),children:"PNG (With title & URL)"}),e.jsx(ls,{}),e.jsx(Q,{onClick:()=>Ss("jpeg",!1),children:"JPEG (Image only)"}),e.jsx(Q,{onClick:()=>Ss("jpeg",!0),children:"JPEG (With title & URL)"})]})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 dark:from-blue-950/20 dark:to-purple-950/20 rounded-lg p-8 min-h-[300px] flex flex-wrap items-center justify-center gap-4",id:"word-cloud-container",children:[xe==="words"&&(()=>{const s=Object.entries(t.word_frequency||{}).filter(([r])=>!r.includes(" ")).sort(([,r],[,n])=>n-r).slice(0,10);if(s.length===0)return e.jsx("p",{className:"text-muted-foreground italic",children:"No single words found in analysis"});const a=Math.max(...s.map(([,r])=>r));return s.map(([r,n],d)=>{const b=20+n/a*36,E=["text-blue-600 dark:text-blue-400","text-purple-600 dark:text-purple-400","text-green-600 dark:text-green-400","text-orange-600 dark:text-orange-400","text-pink-600 dark:text-pink-400","text-indigo-600 dark:text-indigo-400"],R=E[d%E.length];return e.jsx("span",{className:`font-bold ${R} hover:scale-110 transition-transform cursor-default select-none`,style:{fontSize:`${b}px`,lineHeight:1.3},title:`${r}: ${n} times`,children:r},r)})})(),xe==="phrases"&&t.top_phrases.filter(s=>s.phrase.includes(" ")).slice(0,10).map((s,a)=>{const r=Math.max(...t.top_phrases.filter(E=>E.phrase.includes(" ")).map(E=>E.count)),n=16,N=n+s.count/r*(48-n),_=["text-blue-600 dark:text-blue-400","text-purple-600 dark:text-purple-400","text-green-600 dark:text-green-400","text-orange-600 dark:text-orange-400","text-pink-600 dark:text-pink-400","text-indigo-600 dark:text-indigo-400"],b=_[a%_.length];return e.jsx("span",{className:`font-bold ${b} hover:scale-110 transition-transform cursor-default select-none text-center`,style:{fontSize:`${N}px`,lineHeight:1.3},title:`${s.phrase}: ${s.count} times`,children:s.phrase},a)}),xe==="entities"&&(()=>{const a=[...(t.entities?.people||[]).map(n=>({...n,type:"person"})),...(t.entities?.organizations||[]).map(n=>({...n,type:"organization"})),...(t.entities?.locations||[]).map(n=>({...n,type:"location"}))].sort((n,d)=>d.count-n.count).slice(0,10),r=Math.max(...a.map(n=>n.count),1);return a.map(n=>{const _=18+n.count/r*34,b=n.type==="person"?"text-blue-600 dark:text-blue-400":n.type==="organization"?"text-green-600 dark:text-green-400":"text-orange-600 dark:text-orange-400",E=n.type==="person"?"Person":n.type==="organization"?"Organization":"Location";return e.jsx("span",{className:`font-bold ${b} hover:scale-110 transition-transform cursor-default select-none`,style:{fontSize:`${_}px`,lineHeight:1.3},title:`${n.name} (${E}): ${n.count} mentions`,children:n.name},`${n.type}-${n.name}`)})})()]}),xe==="entities"?e.jsxs("div",{className:"flex items-center justify-center gap-4 mt-4 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-600 dark:bg-blue-400"}),e.jsx("span",{className:"text-muted-foreground",children:"People"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-600 dark:bg-green-400"}),e.jsx("span",{className:"text-muted-foreground",children:"Organizations"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-orange-600 dark:bg-orange-400"}),e.jsx("span",{className:"text-muted-foreground",children:"Locations"})]})]}):xe==="phrases"?e.jsxs("div",{className:"space-y-2 mt-4",children:[e.jsxs("div",{className:"flex items-center justify-center flex-wrap gap-3 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-600 dark:bg-blue-400"}),e.jsx("span",{className:"text-muted-foreground",children:"Rank 1-2"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-purple-600 dark:bg-purple-400"}),e.jsx("span",{className:"text-muted-foreground",children:"Rank 3-4"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-600 dark:bg-green-400"}),e.jsx("span",{className:"text-muted-foreground",children:"Rank 5-6"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-orange-600 dark:bg-orange-400"}),e.jsx("span",{className:"text-muted-foreground",children:"Rank 7-8"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-pink-600 dark:bg-pink-400"}),e.jsx("span",{className:"text-muted-foreground",children:"Rank 9-10"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"Top 10 most common phrases (size = frequency)"})]}):e.jsx("p",{className:"text-xs text-muted-foreground mt-2 text-center",children:"Top 10 most frequent single words (size = frequency)"})]}),e.jsxs(j,{className:"p-6",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Top Phrases (2-10 words)"}),e.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:t.top_phrases.filter(s=>s.phrase.includes(" ")).slice(0,20).map((s,a)=>e.jsx("div",{className:"p-3 rounded-lg bg-gray-50 dark:bg-gray-800/50 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("span",{className:"text-lg font-bold text-muted-foreground/50 min-w-[32px]",children:["#",a+1]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[e.jsx("span",{className:"text-sm font-medium break-words",children:s.phrase}),e.jsxs("span",{className:"text-sm font-bold text-primary shrink-0",children:[s.count,""]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(ee,{value:s.count/t.top_phrases[0].count*100,className:"h-1.5"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[s.count," ",s.count===1?"occurrence":"occurrences"]})]})]})]})},a))}),t.top_phrases.filter(s=>s.phrase.includes(" ")).length>20&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-4 text-center",children:["Showing top 20 of ",t.top_phrases.filter(s=>s.phrase.includes(" ")).length," phrases"]})]}),t.keyphrases&&t.keyphrases.length>0&&e.jsxs(j,{className:"p-6",children:[e.jsxs(X,{className:"pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ie,{children:"Key Concepts & Terminology"}),e.jsxs($,{variant:"secondary",children:[t.keyphrases.length," keyphrases"]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Important concepts extracted using TextRank-style analysis (centrality, domain relevance, importance)"})]}),e.jsx(Z,{children:e.jsx("div",{className:"grid md:grid-cols-2 gap-3",children:t.keyphrases.sort((s,a)=>a.score-s.score).map((s,a)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg border bg-card hover:bg-accent/50 transition-colors",children:[e.jsx("div",{className:"shrink-0 w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center text-sm font-semibold text-primary",children:a+1}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-medium text-sm",children:s.phrase}),e.jsx($,{variant:"outline",className:`text-xs ${s.category==="technology"?"border-blue-300 text-blue-700":s.category==="concept"?"border-purple-300 text-purple-700":s.category==="event"?"border-orange-300 text-orange-700":s.category==="location"?"border-green-300 text-green-700":"border-gray-300 text-gray-700"}`,children:s.category})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{value:s.score*100,className:"h-1.5 flex-1"}),e.jsxs("span",{className:"text-xs text-muted-foreground shrink-0",children:[(s.score*100).toFixed(0),"%"]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Relevance: ",s.relevance]})]})]},a))})})]}),t.topics&&t.topics.length>0&&e.jsxs(j,{className:"p-6",children:[e.jsxs(X,{className:"pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ie,{children:"Topic Analysis (LDA)"}),e.jsxs($,{variant:"secondary",children:[t.topics.length," topics"]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Main themes identified using Latent Dirichlet Allocation (coherence, coverage, keywords)"})]}),e.jsx(Z,{className:"space-y-4",children:t.topics.sort((s,a)=>a.coverage-s.coverage).map((s,a)=>e.jsxs("div",{className:"p-4 rounded-lg border bg-gradient-to-r from-card to-accent/20",children:[e.jsx("div",{className:"flex items-start justify-between gap-4 mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-semibold text-base",children:s.name}),e.jsxs($,{className:"bg-primary/10 text-primary border-primary/20",children:["Topic ",a+1]})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description})]})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Coherence"}),e.jsxs("span",{className:"text-xs font-semibold",children:[(s.coherence*100).toFixed(0),"%"]})]}),e.jsx(ee,{value:s.coherence*100,className:"h-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Coverage"}),e.jsxs("span",{className:"text-xs font-semibold",children:[(s.coverage*100).toFixed(0),"%"]})]}),e.jsx(ee,{value:s.coverage*100,className:"h-2 bg-green-100"})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-muted-foreground block mb-2",children:"Keywords:"}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:s.keywords.map((r,n)=>e.jsx($,{variant:"secondary",className:"text-xs bg-primary/5 hover:bg-primary/10",children:r},n))})]})]},a))})]})]}),O==="sentiment"&&(t.sentiment_analysis?e.jsxs("div",{className:"space-y-6",children:[e.jsxs(j,{className:"p-6",children:[e.jsx(X,{className:"pb-4",children:e.jsxs(ie,{className:"flex items-center gap-2",children:[t.sentiment_analysis.overall==="positive"&&e.jsx(kt,{className:"h-6 w-6 text-green-600"}),t.sentiment_analysis.overall==="negative"&&e.jsx(Pa,{className:"h-6 w-6 text-red-600"}),(t.sentiment_analysis.overall==="neutral"||t.sentiment_analysis.overall==="mixed")&&e.jsx(Ma,{className:"h-6 w-6 text-yellow-600"}),"Overall Sentiment: ",t.sentiment_analysis.overall.charAt(0).toUpperCase()+t.sentiment_analysis.overall.slice(1)]})}),e.jsxs(Z,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Sentiment Score"}),e.jsx("span",{className:"font-semibold",children:t.sentiment_analysis.score.toFixed(2)})]}),e.jsx(ee,{value:(t.sentiment_analysis.score+1)*50,className:`h-3 ${t.sentiment_analysis.score>.3?"bg-green-200":t.sentiment_analysis.score<-.3?"bg-red-200":"bg-yellow-200"}`}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground mt-1",children:[e.jsx("span",{children:"Very Negative (-1.0)"}),e.jsx("span",{children:"Neutral (0)"}),e.jsx("span",{children:"Very Positive (+1.0)"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Confidence"}),e.jsxs("span",{className:"font-semibold",children:[(t.sentiment_analysis.confidence*100).toFixed(0),"%"]})]}),e.jsx(ee,{value:t.sentiment_analysis.confidence*100,className:"h-2 mt-2"})]})]})]}),t.sentiment_analysis.emotions&&e.jsxs(j,{className:"p-6",children:[e.jsx(X,{className:"pb-4",children:e.jsx(ie,{children:"Emotion Analysis"})}),e.jsx(Z,{className:"space-y-3",children:Object.entries(t.sentiment_analysis.emotions).map(([s,a])=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-sm capitalize",children:s}),e.jsxs("span",{className:"text-sm font-semibold",children:[a,"%"]})]}),e.jsx(ee,{value:a,className:`h-2 ${s==="joy"?"bg-green-200":s==="anger"?"bg-red-200":s==="fear"?"bg-purple-200":s==="sadness"?"bg-blue-200":"bg-orange-200"}`})]},s))})]}),t.sentiment_analysis.keyInsights&&t.sentiment_analysis.keyInsights.length>0&&e.jsxs(j,{className:"p-6",children:[e.jsx(X,{className:"pb-4",children:e.jsx(ie,{children:"Key Insights"})}),e.jsx(Z,{children:e.jsx("ul",{className:"space-y-2",children:t.sentiment_analysis.keyInsights.map((s,a)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(Ge,{className:"h-4 w-4 mt-0.5 text-blue-600 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:s})]},a))})})]}),t.sentiment_analysis.controversialClaims&&t.sentiment_analysis.controversialClaims.length>0&&e.jsxs(j,{className:"p-6 border-red-200",children:[e.jsx(X,{className:"pb-4",children:e.jsxs(ie,{className:"flex items-center gap-2 text-red-700",children:[e.jsx(ms,{className:"h-5 w-5"}),"Controversial Claims Detected"]})}),e.jsx(Z,{className:"space-y-4",children:t.sentiment_analysis.controversialClaims.map((s,a)=>e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border border-red-200",children:[e.jsx("p",{className:"text-sm font-semibold mb-2 text-red-900",children:s.text}),e.jsxs("div",{className:"flex gap-4 text-xs text-red-700",children:[e.jsxs("span",{children:["Sentiment: ",s.sentiment]}),e.jsx("span",{children:""}),e.jsx("span",{children:s.reason})]})]},a))})]})]}):e.jsx(j,{className:"p-6",children:e.jsx("p",{className:"text-center text-muted-foreground",children:"Sentiment analysis not available for this content"})})),O==="entities"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-semibold",children:"Extracted Entities"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(c,{onClick:ia,variant:"default",size:"sm",disabled:C,children:[e.jsx(Be,{className:"h-4 w-4 mr-2"}),C?"Processing...":"Auto-Create Actors & Relationships"]}),e.jsxs(c,{onClick:ra,variant:"outline",size:"sm",children:[e.jsx(Ve,{className:"h-4 w-4 mr-2"}),"Save All to Evidence"]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(j,{className:"p-4",children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx("span",{children:""}),e.jsxs("span",{children:["People (",t.entities?.people?.length||0,")"]})]}),e.jsxs("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:[(t.entities?.people||[]).slice(0,10).map((s,a)=>e.jsxs("div",{className:"text-sm flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsxs("span",{className:"text-muted-foreground ml-2",children:["(",s.count,")"]})]}),e.jsxs(Me,{children:[e.jsx(Ue,{asChild:!0,children:e.jsx(c,{size:"sm",variant:"ghost",className:"h-7 px-2",title:"Entity actions",children:e.jsx(es,{className:"h-3 w-3"})})}),e.jsxs(qe,{align:"end",children:[e.jsxs(Q,{onClick:()=>Oe(s.name),children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),"Find in Text"]}),e.jsxs(Q,{onClick:()=>Xe(s.name,"person"),disabled:he===s.name,children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),he===s.name?"Summarizing...":"Summarize"]}),e.jsx(ls,{}),e.jsxs(Q,{onClick:()=>Es(s.name,"person"),children:[e.jsx(Ve,{className:"h-4 w-4 mr-2"}),"Save to Actors"]})]})]})]},a)),(!t.entities?.people||t.entities.people.length===0)&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"None found"})]})]}),e.jsxs(j,{className:"p-4",children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx("span",{children:""}),e.jsxs("span",{children:["Organizations (",t.entities?.organizations?.length||0,")"]})]}),e.jsxs("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:[(t.entities?.organizations||[]).slice(0,10).map((s,a)=>e.jsxs("div",{className:"text-sm flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsxs("span",{className:"text-muted-foreground ml-2",children:["(",s.count,")"]})]}),e.jsxs(Me,{children:[e.jsx(Ue,{asChild:!0,children:e.jsx(c,{size:"sm",variant:"ghost",className:"h-7 px-2",title:"Entity actions",children:e.jsx(es,{className:"h-3 w-3"})})}),e.jsxs(qe,{align:"end",children:[e.jsxs(Q,{onClick:()=>Oe(s.name),children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),"Find in Text"]}),e.jsxs(Q,{onClick:()=>Xe(s.name,"organization"),disabled:he===s.name,children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),he===s.name?"Summarizing...":"Summarize"]}),e.jsx(ls,{}),e.jsxs(Q,{onClick:()=>Es(s.name,"organization"),children:[e.jsx(Ve,{className:"h-4 w-4 mr-2"}),"Save to Actors"]})]})]})]},a)),(!t.entities?.organizations||t.entities.organizations.length===0)&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"None found"})]})]}),e.jsxs(j,{className:"p-4",children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx("span",{children:""}),e.jsxs("span",{children:["Locations (",t.entities?.locations?.length||0,")"]})]}),e.jsxs("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:[(t.entities?.locations||[]).slice(0,10).map((s,a)=>e.jsxs("div",{className:"text-sm flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsxs("span",{className:"text-muted-foreground ml-2",children:["(",s.count,")"]})]}),e.jsxs(Me,{children:[e.jsx(Ue,{asChild:!0,children:e.jsx(c,{size:"sm",variant:"ghost",className:"h-7 px-2",title:"Entity actions",children:e.jsx(es,{className:"h-3 w-3"})})}),e.jsxs(qe,{align:"end",children:[e.jsxs(Q,{onClick:()=>Oe(s.name),children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),"Find in Text"]}),e.jsxs(Q,{onClick:()=>Xe(s.name,"location"),disabled:he===s.name,children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),he===s.name?"Summarizing...":"Summarize"]}),e.jsx(ls,{}),e.jsxs(Q,{onClick:()=>Es(s.name,"location"),children:[e.jsx(Ve,{className:"h-4 w-4 mr-2"}),"Save to Places"]})]})]})]},a)),(!t.entities?.locations||t.entities.locations.length===0)&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"None found"})]})]}),e.jsxs(j,{className:"p-4",children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(Ls,{className:"h-4 w-4"}),e.jsxs("span",{children:["Dates (",t.entities?.dates?.length||0,")"]})]}),e.jsxs("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:[(t.entities?.dates||[]).slice(0,10).map((s,a)=>e.jsxs("div",{className:"text-sm flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsxs("span",{className:"text-muted-foreground ml-2",children:["(",s.count,")"]})]}),e.jsxs(Me,{children:[e.jsx(Ue,{asChild:!0,children:e.jsx(c,{size:"sm",variant:"ghost",className:"h-7 px-2",title:"Entity actions",children:e.jsx(es,{className:"h-3 w-3"})})}),e.jsxs(qe,{align:"end",children:[e.jsxs(Q,{onClick:()=>Oe(s.name),children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),"Find in Text"]}),e.jsxs(Q,{onClick:()=>Xe(s.name,"date"),disabled:he===s.name,children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),he===s.name?"Summarizing...":"Summarize"]})]})]})]},a)),(!t.entities?.dates||t.entities.dates.length===0)&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"None found"})]})]}),e.jsxs(j,{className:"p-4",children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx("span",{children:""}),e.jsxs("span",{children:["Money (",t.entities?.money?.length||0,")"]})]}),e.jsxs("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:[(t.entities?.money||[]).slice(0,10).map((s,a)=>e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsxs("span",{className:"text-muted-foreground ml-2",children:["(",s.count,")"]})]},a)),(!t.entities?.money||t.entities.money.length===0)&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"None found"})]})]}),e.jsxs(j,{className:"p-4",children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(He,{className:"h-4 w-4"}),e.jsxs("span",{children:["Events (",t.entities?.events?.length||0,")"]})]}),e.jsxs("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:[(t.entities?.events||[]).slice(0,10).map((s,a)=>e.jsxs("div",{className:"text-sm flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsxs("span",{className:"text-muted-foreground ml-2",children:["(",s.count,")"]})]}),e.jsxs(Me,{children:[e.jsx(Ue,{asChild:!0,children:e.jsx(c,{size:"sm",variant:"ghost",className:"h-7 px-2",title:"Entity actions",children:e.jsx(es,{className:"h-3 w-3"})})}),e.jsxs(qe,{align:"end",children:[e.jsxs(Q,{onClick:()=>Oe(s.name),children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),"Find in Text"]}),e.jsxs(Q,{onClick:()=>Xe(s.name,"event"),disabled:he===s.name,children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),he===s.name?"Summarizing...":"Summarize"]})]})]})]},a)),(!t.entities?.events||t.entities.events.length===0)&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"None found"})]})]}),e.jsxs(j,{className:"p-4",children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx("span",{children:""}),e.jsxs("span",{children:["Products (",t.entities?.products?.length||0,")"]})]}),e.jsxs("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:[(t.entities?.products||[]).slice(0,10).map((s,a)=>e.jsxs("div",{className:"text-sm flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsxs("span",{className:"text-muted-foreground ml-2",children:["(",s.count,")"]})]}),e.jsxs(Me,{children:[e.jsx(Ue,{asChild:!0,children:e.jsx(c,{size:"sm",variant:"ghost",className:"h-7 px-2",title:"Entity actions",children:e.jsx(es,{className:"h-3 w-3"})})}),e.jsxs(qe,{align:"end",children:[e.jsxs(Q,{onClick:()=>Oe(s.name),children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),"Find in Text"]}),e.jsxs(Q,{onClick:()=>Xe(s.name,"product"),disabled:he===s.name,children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),he===s.name?"Summarizing...":"Summarize"]})]})]})]},a)),(!t.entities?.products||t.entities.products.length===0)&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"None found"})]})]}),e.jsxs(j,{className:"p-4",children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx("span",{children:""}),e.jsxs("span",{children:["Percentages (",t.entities?.percentages?.length||0,")"]})]}),e.jsxs("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:[(t.entities?.percentages||[]).slice(0,10).map((s,a)=>e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsxs("span",{className:"text-muted-foreground ml-2",children:["(",s.count,")"]})]},a)),(!t.entities?.percentages||t.entities.percentages.length===0)&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"None found"})]})]}),e.jsxs(j,{className:"p-4",children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(Ua,{className:"h-4 w-4"}),e.jsxs("span",{children:["Emails (",t.entities?.emails?.length||0,")"]})]}),e.jsxs("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:[(t.entities?.emails||[]).slice(0,10).map((s,a)=>e.jsxs("div",{className:"text-sm",children:[e.jsx("a",{href:`mailto:${s.email}`,className:"font-medium text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:s.email}),e.jsxs("span",{className:"text-muted-foreground ml-2",children:["(",s.count,")"]})]},a)),(!t.entities?.emails||t.entities.emails.length===0)&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"None found"})]})]})]})]}),O==="links"&&(()=>{const s=Array.isArray(t.links_analysis)?t.links_analysis:[];return s.length>0?e.jsx("div",{className:"space-y-4",children:e.jsxs(j,{children:[e.jsxs(X,{children:[e.jsxs(ie,{className:"flex items-center gap-2",children:[e.jsx(us,{className:"h-5 w-5"}),"Link Analysis (",s.length," unique links)"]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"All links found in the article body (excluding navigation, headers, and footers). Helps identify sources, references, and related content."})]}),e.jsx(Z,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Links"}),e.jsx("p",{className:"text-2xl font-bold",children:s.length})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"External Links"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:s.filter(a=>a.is_external).length})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Internal Links"}),e.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:s.filter(a=>!a.is_external).length})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Unique Domains"}),e.jsx("p",{className:"text-2xl font-bold",children:new Set(s.map(a=>a.domain)).size})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6 p-4 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 block",children:"Filter by Type"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(c,{variant:_e==="all"?"default":"outline",size:"sm",onClick:()=>as("all"),className:"flex-1",children:["All (",s.length,")"]}),e.jsxs(c,{variant:_e==="external"?"default":"outline",size:"sm",onClick:()=>as("external"),className:"flex-1",children:["External (",s.filter(a=>a.is_external).length,")"]}),e.jsxs(c,{variant:_e==="internal"?"default":"outline",size:"sm",onClick:()=>as("internal"),className:"flex-1",children:["Internal (",s.filter(a=>!a.is_external).length,")"]})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 block",children:"Sort by"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{variant:l==="references"?"default":"outline",size:"sm",onClick:()=>m("references"),className:"flex-1",children:"Most Referenced"}),e.jsx(c,{variant:l==="chronological"?"default":"outline",size:"sm",onClick:()=>m("chronological"),className:"flex-1",children:"Chronological"})]})]})]}),e.jsx("div",{className:"space-y-3",children:(()=>{let a=s;_e==="external"?a=a.filter(n=>n.is_external):_e==="internal"&&(a=a.filter(n=>!n.is_external));const r=[...a].sort((n,d)=>l==="chronological"?(n.first_occurrence_index||0)-(d.first_occurrence_index||0):d.count-n.count);return r.length>0?r.map((n,d)=>e.jsx("div",{className:"border-l-4 border-blue-500 dark:border-blue-400 pl-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:e.jsx("div",{className:"flex items-start justify-between gap-2",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsxs("a",{href:n.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium break-all flex items-center gap-1",children:[e.jsx(Ce,{className:"h-3 w-3 flex-shrink-0"}),n.url]})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-2",children:[e.jsx($,{variant:"outline",className:"text-xs",children:n.domain}),e.jsx($,{variant:n.is_external?"default":"secondary",className:"text-xs",children:n.is_external?"External":"Internal"}),e.jsxs("span",{className:"text-xs font-medium text-gray-700 dark:text-gray-300",children:["Referenced ",n.count," in article"]}),l==="chronological"&&e.jsxs($,{variant:"outline",className:"text-xs",children:["Position #",(n.first_occurrence_index||0)+1]})]}),n.anchor_text.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("span",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400",children:["Anchor text:"," "]}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:n.anchor_text.map((N,_)=>e.jsxs($,{variant:"outline",className:"text-xs bg-white dark:bg-gray-900",children:['"',N,'"']},_))})]})]})})},d)):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:["No ",_e==="all"?"":_e," links found"]})})()})]})})]})}):e.jsx(j,{className:"p-6",children:e.jsx("p",{className:"text-center text-muted-foreground",children:"No links were found in the article body"})})})(),O==="claims"&&(t?.claim_analysis||Ds?e.jsx(Ya,{contentAnalysisId:t.id,claimAnalysis:t.claim_analysis||Ds}):e.jsx(j,{className:"p-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx($e,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground opacity-50"}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Claims Deception Analysis"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:"Extract factual claims and analyze them for potential deception using multiple detection methods: internal consistency, source credibility, evidence quality, logical coherence, temporal consistency, and specificity."}),e.jsxs(c,{onClick:gt,disabled:qs||!t,size:"lg",children:[e.jsx($e,{className:"h-4 w-4 mr-2"}),qs?"Analyzing Claims...":"Run Claims Analysis"]}),!t&&e.jsx("p",{className:"text-sm text-muted-foreground mt-4",children:"Analyze content first before running claims analysis"})]})})),O==="qa"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs(j,{className:"p-6",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Ask Questions About This Content"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Ask questions and get AI-powered answers with source citations from the analyzed content"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(pe,{placeholder:"What would you like to know about this content?",value:de,onChange:s=>ve(s.target.value),className:"min-h-[60px]",onKeyDown:s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),yt())}}),e.jsx(c,{onClick:yt,disabled:h||!de.trim(),className:"shrink-0",children:h?e.jsx(q,{className:"h-4 w-4 animate-spin"}):e.jsx(qa,{className:"h-4 w-4"})})]})]}),ae.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold",children:"Q&A History"}),ae.map(s=>e.jsxs(j,{className:"p-6",children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ps,{className:"h-5 w-5 text-blue-600 shrink-0 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-lg",children:s.question}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[new Date(s.created_at).toLocaleString(),"  ",s.search_method," search"]})]})]})}),s.answer&&e.jsxs("div",{className:"ml-7 mb-4 p-4 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:s.answer}),s.confidence_score!==void 0&&e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Confidence:"}),e.jsx(ee,{value:s.confidence_score*100,className:"w-24 h-2"}),e.jsxs("span",{className:"text-xs font-medium",children:[Math.round(s.confidence_score*100),"%"]})]})]}),s.source_excerpts&&s.source_excerpts.length>0&&e.jsxs("div",{className:"ml-7 space-y-2",children:[e.jsx("p",{className:"text-xs font-semibold text-muted-foreground uppercase",children:"Source Excerpts:"}),s.source_excerpts.map((a,r)=>e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded border-l-2 border-blue-500",children:[e.jsxs("p",{className:"text-sm italic",children:['"',a.text,'"']}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Paragraph ",a.paragraph]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:""}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Relevance: ",Math.round(a.relevance*100),"%"]})]})]},r))]}),!s.has_complete_answer&&s.missing_data_notes&&e.jsxs("div",{className:"ml-7 mt-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg flex items-start gap-2",children:[e.jsx(ms,{className:"h-4 w-4 text-yellow-600 shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-300",children:"Incomplete Answer"}),e.jsx("p",{className:"text-xs text-yellow-700 dark:text-yellow-400 mt-1",children:s.missing_data_notes})]})]})]},s.id))]}),ae.length===0&&!h&&e.jsxs(j,{className:"p-8 text-center text-muted-foreground",children:[e.jsx(ps,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No questions asked yet."}),e.jsx("p",{className:"text-sm mt-1",children:"Ask a question above to get started."})]})]}),O==="starbursting"&&e.jsxs(j,{className:"p-6",children:[e.jsx("h3",{className:"font-semibold mb-4",children:" Starbursting Analysis"}),Ke==="processing"&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(q,{className:"h-12 w-12 animate-spin text-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-lg font-medium",children:"Generating Starbursting Questions..."}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"This may take a moment. We're creating deep-dive 5W1H questions from your content."})]}),Ke==="complete"&&V&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-green-50 dark:bg-green-950 border border-green-200 dark:border-green-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ss,{className:"h-5 w-5 text-green-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-green-900 dark:text-green-100",children:"Starbursting Session Created!"}),e.jsx("p",{className:"text-sm text-green-700 dark:text-green-300 mt-1",children:V.central_topic}),e.jsxs("p",{className:"text-xs text-green-600 dark:text-green-400 mt-1",children:[V.sources_count," source",V.sources_count!==1?"s":""," analyzed"]})]})]})}),!V.framework_data?.data&&e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:["Debug: framework_data.data is ",V.framework_data?.data?"present":"missing",e.jsx("br",{}),"framework_data type: ",typeof V.framework_data,e.jsx("br",{}),"Has framework_data: ",V.framework_data?"yes":"no"]})}),V.framework_data?.data&&e.jsxs("div",{className:"space-y-4",children:[V.framework_data.data.who&&e.jsx(e.Fragment,{children:["who","what","when","where","why","how"].map(s=>{const a=V.framework_data.data[s]||[];if(a.length===0)return null;const r={who:{bg:"bg-purple-50 dark:bg-purple-900/20",badge:"bg-purple-100 text-purple-700 dark:bg-purple-900/50 dark:text-purple-300"},what:{bg:"bg-blue-50 dark:bg-blue-900/20",badge:"bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-300"},when:{bg:"bg-green-50 dark:bg-green-900/20",badge:"bg-green-100 text-green-700 dark:bg-green-900/50 dark:text-green-300"},where:{bg:"bg-yellow-50 dark:bg-yellow-900/20",badge:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/50 dark:text-yellow-300"},why:{bg:"bg-orange-50 dark:bg-orange-900/20",badge:"bg-orange-100 text-orange-700 dark:bg-orange-900/50 dark:text-orange-300"},how:{bg:"bg-pink-50 dark:bg-pink-900/20",badge:"bg-pink-100 text-pink-700 dark:bg-pink-900/50 dark:text-pink-300"}},n=r[s]||r.who;return e.jsxs(j,{className:`${n.bg} border-none`,children:[e.jsx(X,{className:"pb-3",children:e.jsxs(ie,{className:"flex items-center gap-2 text-lg",children:[e.jsx($,{variant:"secondary",className:n.badge,children:s.toUpperCase()}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[a.filter(d=>d.answer&&d.answer.trim()!=="").length," answered / ",a.length," total"]})]})}),e.jsx(Z,{children:e.jsx("ul",{className:"space-y-3",children:a.map((d,N)=>e.jsxs("li",{className:"space-y-1",children:[e.jsxs("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:[e.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[N+1,"."]})," Q: ",d.question]}),e.jsxs("div",{className:"text-gray-700 dark:text-gray-300 ml-5",children:["A: ",d.answer&&d.answer.trim()!==""?d.answer:e.jsx("span",{className:"italic text-gray-500 dark:text-gray-400",children:"No answer provided"})]})]},d.id||N))})})]},s)})}),V.framework_data.data.questions&&!V.framework_data.data.who&&e.jsxs(j,{children:[e.jsx(X,{children:e.jsx(ie,{className:"text-lg",children:"Generated Questions"})}),e.jsx(Z,{children:e.jsx("ul",{className:"space-y-3",children:V.framework_data.data.questions.map((s,a)=>e.jsx("li",{className:"space-y-1",children:e.jsxs("div",{className:"flex items-start gap-2",children:[s.category&&e.jsx($,{variant:"outline",className:"mt-0.5",children:s.category.toUpperCase()}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:[e.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[a+1,"."]})," Q: ",s.question]}),e.jsxs("div",{className:"text-gray-700 dark:text-gray-300 ml-5",children:["A: ",s.answer&&s.answer.trim()!==""?s.answer:e.jsx("span",{className:"italic text-gray-500 dark:text-gray-400",children:"No answer provided"})]})]})]})},s.id||a))})})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{variant:"outline",onClick:()=>na(V.session_id),className:"flex-1",disabled:it,children:it?e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"h-4 w-4 mr-2 animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Da,{className:"h-4 w-4 mr-2"}),"Generate More Questions"]})}),e.jsxs(c,{onClick:()=>f(`/dashboard/analysis-frameworks/starbursting/${V.session_id}/view`),className:"flex-1",children:[e.jsx(He,{className:"h-4 w-4 mr-2"}),"Open Full Analysis",e.jsx(Ce,{className:"h-4 w-4 ml-2"})]})]})]}),Ke==="error"&&e.jsx("div",{className:"bg-red-50 dark:bg-red-950 border border-red-200 dark:border-red-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ms,{className:"h-5 w-5 text-red-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-red-900 dark:text-red-100",children:"Failed to Create Starbursting Session"}),e.jsx("p",{className:"text-sm text-red-700 dark:text-red-300 mt-1",children:Mt}),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>t?.id&&As(t.id),className:"mt-3",children:"Retry"})]})]})}),Ke==="idle"&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(He,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground opacity-50"}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Starbursting Analysis"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:"Generate deep-dive 5W1H questions (Who, What, When, Where, Why, How) to explore all angles of this content."}),t?e.jsxs(c,{onClick:()=>t.id&&As(t.id),size:"lg",children:[e.jsx(He,{className:"h-4 w-4 mr-2"}),"Create Starbursting Session"]}):e.jsx("p",{className:"text-sm text-muted-foreground mt-4",children:"Analyze content first to generate Starbursting questions"})]})]}),O==="dime"&&(t?.dime_analysis||U?e.jsxs("div",{className:"space-y-6",children:[(t?.dime_analysis||U)?.summary&&e.jsxs(j,{className:"p-6 bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-950 dark:to-indigo-950 border-blue-200",children:[e.jsx(X,{className:"pb-4",children:e.jsxs(ie,{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"h-5 w-5 text-blue-600"}),"DIME Framework Summary"]})}),e.jsx(Z,{children:e.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed",children:(t?.dime_analysis||U).summary})})]}),(t?.dime_analysis||U)?.diplomatic&&e.jsxs(j,{className:"p-6 border-l-4 border-blue-500",children:[e.jsxs(X,{className:"pb-4",children:[e.jsx(ie,{className:"flex items-center gap-2 text-blue-700 dark:text-blue-400",children:" Diplomatic"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"International relations, negotiations, alliances, and diplomatic strategies"})]}),e.jsx(Z,{className:"space-y-4",children:(t?.dime_analysis||U).diplomatic.map((s,a)=>e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-950/30 p-4 rounded-lg",children:[e.jsxs("div",{className:"font-semibold text-blue-900 dark:text-blue-100 mb-2",children:["Q",a+1,": ",s.question]}),e.jsxs("div",{className:"text-gray-700 dark:text-gray-300 text-sm leading-relaxed",children:[e.jsx("strong",{children:"A:"})," ",s.answer]})]},a))})]}),(t?.dime_analysis||U)?.information&&e.jsxs(j,{className:"p-6 border-l-4 border-purple-500",children:[e.jsxs(X,{className:"pb-4",children:[e.jsx(ie,{className:"flex items-center gap-2 text-purple-700 dark:text-purple-400",children:" Information"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Media narratives, public messaging, information operations, and communication strategies"})]}),e.jsx(Z,{className:"space-y-4",children:(t?.dime_analysis||U).information.map((s,a)=>e.jsxs("div",{className:"bg-purple-50 dark:bg-purple-950/30 p-4 rounded-lg",children:[e.jsxs("div",{className:"font-semibold text-purple-900 dark:text-purple-100 mb-2",children:["Q",a+1,": ",s.question]}),e.jsxs("div",{className:"text-gray-700 dark:text-gray-300 text-sm leading-relaxed",children:[e.jsx("strong",{children:"A:"})," ",s.answer]})]},a))})]}),(t?.dime_analysis||U)?.military&&e.jsxs(j,{className:"p-6 border-l-4 border-red-500",children:[e.jsxs(X,{className:"pb-4",children:[e.jsx(ie,{className:"flex items-center gap-2 text-red-700 dark:text-red-400",children:" Military"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Defense capabilities, security concerns, armed forces, and military strategies"})]}),e.jsx(Z,{className:"space-y-4",children:(t?.dime_analysis||U).military.map((s,a)=>e.jsxs("div",{className:"bg-red-50 dark:bg-red-950/30 p-4 rounded-lg",children:[e.jsxs("div",{className:"font-semibold text-red-900 dark:text-red-100 mb-2",children:["Q",a+1,": ",s.question]}),e.jsxs("div",{className:"text-gray-700 dark:text-gray-300 text-sm leading-relaxed",children:[e.jsx("strong",{children:"A:"})," ",s.answer]})]},a))})]}),(t?.dime_analysis||U)?.economic&&e.jsxs(j,{className:"p-6 border-l-4 border-green-500",children:[e.jsxs(X,{className:"pb-4",children:[e.jsx(ie,{className:"flex items-center gap-2 text-green-700 dark:text-green-400",children:" Economic"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Trade, sanctions, financial systems, economic policies, and fiscal implications"})]}),e.jsx(Z,{className:"space-y-4",children:(t?.dime_analysis||U).economic.map((s,a)=>e.jsxs("div",{className:"bg-green-50 dark:bg-green-950/30 p-4 rounded-lg",children:[e.jsxs("div",{className:"font-semibold text-green-900 dark:text-green-100 mb-2",children:["Q",a+1,": ",s.question]}),e.jsxs("div",{className:"text-gray-700 dark:text-gray-300 text-sm leading-relaxed",children:[e.jsx("strong",{children:"A:"})," ",s.answer]})]},a))})]}),e.jsx(j,{className:"p-4 bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Need to refresh the analysis?"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Run DIME analysis again to update results"})]}),e.jsxs(c,{onClick:is,disabled:Re,variant:"outline",size:"sm",children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),Re?"Analyzing...":"Re-run Analysis"]})]})})]}):e.jsx(j,{className:"p-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Te,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground opacity-50"}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"DIME Framework Analysis"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:"Analyze this content through the DIME framework lens: Diplomatic, Information, Military, and Economic dimensions."}),e.jsxs(c,{onClick:is,disabled:Re||!t,size:"lg",children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),Re?"Analyzing...":"Run DIME Analysis"]}),!t&&e.jsx("p",{className:"text-sm text-muted-foreground mt-4",children:"Analyze content first before running DIME framework analysis"})]})}))]}),e.jsx("div",{id:"saved-links",className:"mt-8",children:e.jsxs(j,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx(Ha,{className:"h-5 w-5"}),"Recently Saved Links"]}),e.jsx(c,{variant:"outline",size:"sm",disabled:!0,title:"Full library view coming soon",children:"View All"})]}),me?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(q,{className:"h-6 w-6 animate-spin mx-auto mb-2"}),"Loading saved links..."]}):fe.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("p",{children:"No saved links yet."}),e.jsx("p",{className:"text-sm mt-1",children:'Analyze URLs to automatically save them, or add notes and tags before clicking "Save Permanently".'})]}):e.jsx("div",{className:"space-y-3",children:fe.map(s=>e.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-800 transition",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-medium truncate",children:s.title||"Untitled"}),e.jsx("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline truncate block",children:s.url}),s.note&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.note}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[s.tags&&s.tags.length>0&&e.jsx("div",{className:"flex gap-1 flex-wrap",children:s.tags.map((a,r)=>e.jsx("span",{className:"text-xs px-2 py-0.5 bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded",children:a},r))}),e.jsx("span",{className:"text-xs text-muted-foreground",children:new Date(s.created_at).toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{variant:"outline",size:"sm",onClick:async()=>{if(D(s.url),s.note&&ce(s.note),s.tags?.length&&ge(s.tags.join(", ")),s.is_processed&&s.analysis_id)try{z(!0);const a=await fetch("/api/content-intelligence/analyze-url",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:s.url,load_existing:!0,analysis_id:s.analysis_id})});if(a.ok){const r=await a.json();B(r.analysis),G("overview"),window.scrollTo({top:0,behavior:"smooth"}),i({title:"Success",description:"Loaded existing analysis"})}else throw new Error("Failed to load analysis")}catch(a){console.error("Load analysis error:",a),i({title:"Error",description:"Failed to load analysis. Click Analyze to create new one.",variant:"destructive"})}finally{z(!1)}else window.scrollTo({top:0,behavior:"smooth"}),Vs(s.url)},children:s.is_processed?"Load Analysis":"Analyze Now"}),s.is_processed&&s.analysis_id&&e.jsxs(e.Fragment,{children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:async()=>{try{i({title:"Creating Starbursting session...",variant:"default"});const a=await fetch("/api/content-intelligence/starbursting",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({analysis_ids:[s.analysis_id],title:s.title||"Content Analysis"})});if(!a.ok)throw new Error("Failed to create Starbursting session");const r=await a.json();i({title:"Success",description:"Launching Starbursting analysis..."}),f(`/dashboard/analysis-frameworks/starbursting/${r.session_id}/view`)}catch(a){console.error("Starbursting launch error:",a),i({title:"Error",description:"Failed to launch Starbursting analysis",variant:"destructive"})}},title:"Launch Starbursting deep-dive analysis",children:[e.jsx(He,{className:"h-3 w-3 mr-1"}),"Starbursting"]}),e.jsx(c,{variant:"outline",size:"sm",onClick:async()=>{try{const a=await fetch("/api/content-intelligence/analyze-url"),r={id:s.analysis_id,user_id:1,url:s.url,url_normalized:s.url,content_hash:"",title:s.title,domain:s.domain||new URL(s.url).hostname,is_social_media:s.is_social_media,social_platform:s.social_platform,extracted_text:"",word_count:0,word_frequency:{},top_phrases:[],entities:{people:[],organizations:[],locations:[]},archive_urls:{},bypass_urls:{"12ft":""},processing_mode:"full",processing_duration_ms:0,created_at:s.created_at,updated_at:s.updated_at};ft(r)}catch{i({title:"Error",description:"Failed to create citation",variant:"destructive"})}},title:"Create citation from this link",children:e.jsx(_t,{className:"h-4 w-4"})})]})]})]})},s.id))})]})}),e.jsx(gs,{open:Rs,onOpenChange:bs,children:e.jsxs(fs,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(js,{children:[e.jsxs(ys,{className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-5 w-5 text-blue-600"}),"VirusTotal Security Report"]}),e.jsx(Ts,{children:"Domain security analysis powered by VirusTotal"})]}),v&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:v.domain}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Last analyzed: ",new Date(v.lastAnalysisDate).toLocaleString()]})]}),e.jsx("div",{className:`p-4 rounded-lg ${v.riskLevel==="safe"?"bg-green-50 dark:bg-green-950 border border-green-300":v.riskLevel==="low"?"bg-blue-50 dark:bg-blue-950 border border-blue-300":v.riskLevel==="medium"?"bg-yellow-50 dark:bg-yellow-950 border border-yellow-300":v.riskLevel==="high"?"bg-orange-50 dark:bg-orange-950 border border-orange-300":"bg-red-50 dark:bg-red-950 border border-red-300"}`,children:e.jsx("p",{className:"text-sm font-medium",children:v.summary})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-semibold",children:"Safety Score"}),e.jsxs("span",{className:"text-2xl font-bold",children:[v.safetyScore,"/100"]})]}),e.jsx(ee,{value:v.safetyScore,className:"h-3"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Security Vendor Analysis"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-950 rounded-lg",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Harmless"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:v.stats.harmless})]}),e.jsxs("div",{className:"p-3 bg-red-50 dark:bg-red-950 rounded-lg",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Malicious"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:v.stats.malicious})]}),e.jsxs("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-950 rounded-lg",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Suspicious"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:v.stats.suspicious})]}),e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Undetected"}),e.jsx("p",{className:"text-2xl font-bold",children:v.stats.undetected})]})]})]}),v.votes&&(v.votes.harmless>0||v.votes.malicious>0)&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Community Votes"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),e.jsxs("span",{className:"text-sm",children:["Harmless: ",v.votes.harmless]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),e.jsxs("span",{className:"text-sm",children:["Malicious: ",v.votes.malicious]})]})]})]}),v.reputation!==0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Reputation Score"}),e.jsx("p",{className:"text-sm",children:v.reputation>0?e.jsxs("span",{className:"text-green-600 font-medium",children:["+",v.reputation," (Positive)"]}):e.jsxs("span",{className:"text-red-600 font-medium",children:[v.reputation," (Negative)"]})})]}),v.categories&&Object.keys(v.categories).length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Categories"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(v.categories).slice(0,5).map(([s,a])=>e.jsx("span",{className:"text-xs px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded",children:a},s))})]}),e.jsx("div",{className:"pt-4 border-t",children:e.jsxs(c,{variant:"outline",className:"w-full",onClick:()=>window.open(v.directLink,"_blank","noopener,noreferrer"),children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),"View Full Report on VirusTotal"]})})]})]})}),e.jsx(gs,{open:Vt,onOpenChange:Cs,children:e.jsxs(fs,{className:"max-w-2xl",children:[e.jsxs(js,{children:[e.jsxs(ys,{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"h-5 w-5"}),"Entity Summary: ",Ie?.entity]}),e.jsx(Ts,{children:"AI-generated summary based on the content"})]}),Ie&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-muted p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:e.jsx("div",{className:"h-8 w-8 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(Ee,{className:"h-4 w-4 text-primary"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:Ie.type.charAt(0).toUpperCase()+Ie.type.slice(1)}),e.jsx("p",{className:"text-sm leading-relaxed",children:Ie.summary})]})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>{Oe(Ie.entity),Cs(!1)},children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),"Find in Text"]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>{navigator.clipboard.writeText(Ie.summary),i({title:"Copied",description:"Summary copied to clipboard"})},children:[e.jsx(Se,{className:"h-4 w-4 mr-2"}),"Copy Summary"]})]})]})]})})]})}export{gr as default};
